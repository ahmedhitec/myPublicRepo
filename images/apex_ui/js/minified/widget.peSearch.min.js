!function(e,t,a,n){"use strict";var r="warning",i="a-Icon icon-search",p=null;function o(t,n){var p=t.component,o=t.getMetaData(),s=t.getDisplayValue();return s=(s=a.escapeHTML(s.replace(n,"~~peSearchHitBegin~~$&~~peSearchHitEnd~~"))).replace(/~~peSearchHitBegin~~/g,'<span class="a-Search-term">').replace(/~~peSearchHitEnd~~/g,"</span>"),'<li class="a-AlertMessages-item" data-typeid="#TYPEID#" data-componentid="#COMPONENTID#" data-propertyid="#PROPERTYID#">  <a href="#" class="a-MediaBlock a-AlertMessages-message">    <div class="a-MediaBlock-graphic">      <span class="#ICON_CLASS#"></span>    </div>    <div class="a-MediaBlock-content">      <h5 class="a-AlertMessages-propertyTitle">#COMPONENT_TYPE# &rarr; #COMPONENT# &rarr; #DISPLAY_GROUP# &rarr; #PROPERTY#</h5>      <p class="a-AlertMessages-messageDescription"><pre>#VALUE#</pre></p>    </div>  </a></li>'.replace(/#CSS_CLASS#/g,r).replace(/#ICON_CLASS#/g,i).replace("#TYPEID#",p.typeId).replace("#COMPONENTID#",p.id).replace("#PROPERTYID#",t.id).replace("#COMPONENT_TYPE#",a.escapeHTML(e.getComponentType(p.typeId).title.singular)).replace("#COMPONENT#",a.escapeHTML(p.getDisplayTitle())).replace("#DISPLAY_GROUP#",a.escapeHTML(e.getDisplayGroup(o.displayGroupId).title)).replace("#PROPERTY#",a.escapeHTML(o.prompt)).replace("#VALUE#",s)}t.widget("apex.peSearch",{options:{},_create:function(){var a,n=this;this.element.empty(),a=t("<div>",{class:"a-AlertMessages"}).appendTo(this.element),this._container$=t("<ul></ul>",{class:"a-AlertMessages-list"}).appendTo(a).on("click","a",this._goToComponent),t(document).on("modelReady",(function(){e.observer("search_"+this.uuid,{events:[e.EVENT.CHANGE,e.EVENT.DELETE,e.EVENT.REMOVE_PROP]},(function(e){n._update(e)})),t(document).one("modelCleared",(function(){n._container$.empty(),p=null}))}))},_init:function(){},_destroy:function(){this.element.empty(),t(document).off("modelReady"),t(document).off("modelCleared"),e.unobserver("search_"+this.uuid)},search:function(t){p=t instanceof RegExp?t:""!==t&&void 0!==t?new RegExp(a.escapeRegExp(t),"gi"):null,this._container$.empty(),null!==p&&this._container$.append(function t(a,n){var r,i,p,s,c="";for(p=0,s=(r=e.fullTextSearch(n,{typeId:a})).length;p<s;p++)c+=o(r[p],n);for(p=0,s=(i=e.getComponentType(a)).childComponentTypes.length;p<s;p++)c+=t(i.childComponentTypes[p],n);return c}(e.COMP_TYPE.PAGE,p))},clear:function(){p=null,this._container$.empty()},_update:function(a){var n,r,i=p,s=a.component,c="li[data-typeid='"+s.typeId+"'][data-componentid='"+s.id+"']";if(null!==i)if(t.inArray(e.EVENT.DELETE,a.events)>=0)this._container$.find(c).remove();else for(var l in a.properties)a.properties.hasOwnProperty(l)&&(n=this._container$.find(c+"[data-propertyid='"+l+"']"),t.inArray(e.EVENT.REMOVE_PROP,a.properties[l])>=0?n.remove():t.inArray(e.EVENT.CHANGE,a.properties[l])>=0&&n.length>0&&(r=[a.component.getProperty(l)],(r=e.fullTextSearch(i,{properties:r})).length>0?n.replaceWith(o(r[0],i)):n.remove()))},_goToComponent:function(a){var n=t(this).closest("li"),r=e.getComponents(n.data("typeid"),{id:n.data("componentid")})[0];window.pageDesigner.goToComponent(r.typeId,r.id,n.data("propertyid"))}})}(pe,apex.jQuery,apex.util);