!function(t){"use strict";apex.quickSql=function(e){var i,n=t.extend({markupItem:"P1100_RAW_SQL",inputEditor:"quicksql_input",outputEditor:"quicksql_output",data_nodeId:"formatted_sql_output"},e),o=function(){return $v(n.markupItem).trim()},r=o();this.getShorthandSQL=o,this.getOutputEditor=function(){return i},this.getOptions=function(){return n},this.clearOutput=function(){return t("#"+n.outputEditor).codeEditor("setValue",""),this},this.generate=function(e,u){var a=function(){u&&u()};if(void 0===e&&(e=!1),i&&r===o()&&!e)return a(),!1;var d="#"+n.outputEditor;apex.server.process("format_sql",{pageItems:[n.markupItem]},{dataType:"text",loadingIndicator:d,loadingIndicatorPosition:"centered",success:function(e){var o=t(e).find("#"+n.data_nodeId).text();if(i)t(d).codeEditor("setValue",o);else{var r=t(d).empty();i=r.codeEditor({value:o,language:"sql",theme:"automatic",readOnly:!0,toolbar:!1,ruler:!1,scrollBeyondLastLine:!1,minimap:!1}),r.trigger("apexafterrefresh")}a()}}),r=o()},this.inputEditor$=this.initInputEditor(n.onInputEditorInitialized)},apex.quickSql.prototype={initInputEditor:function(e){var i=this,n=i.getOptions(),o=t("#"+n.inputEditor);return o.codeEditor({language:"quicksql",theme:"automatic",tabSize:4,autofocus:!0,toolbar:!1,ruler:!1,scrollBeyondLastLine:!1,wordBasedSuggestions:!1,quickSuggestions:!0,minimap:!1,onInitialized:function(r){r.onKeyDown((function(t){t.keyCode==monaco.KeyCode.Enter&&(i.generate(),apex.message.hidePageSuccess())})),r.onDidChangeModelContent((function(){$s(n.markupItem,o.codeEditor("getValue"))})),e&&e(r),t.apex.codeEditor.performExtraQuicksqlHighlight(r)}})},hasContent:function(){return!!this.getOutputEditor()},download:function(){var t=this;this.generate(!1,(function(){var e=document.createElement("a"),i=t.getOutputEditor(),n=i?i.codeEditor("getValue"):" ",o=new Blob([n],{type:"text/plain"});e.download="quicksql-script.sql",e.innerHTML="Download File",null!==window.webkitURL?e.href=window.webkitURL.createObjectURL(o):(e.href=window.URL.createObjectURL(o),e.onclick=destroyClickedElement,e.style.display="none",document.body.appendChild(e)),e.click()}))}}}(apex.jQuery);