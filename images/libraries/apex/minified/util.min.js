apex.util=function(e,t){"use strict";const n=/&(([A-Z0-9_$#]+(?:%[A-Za-z0-9_]+)?)|"([^"&\r\n]+)")(!([A-Z]+))?\./g,r=/%([A-Za-z0-9_]+)$/;function i(e){return"string"==typeof e?e.replace(/([.$*+\-?(){}|^\[\]\\])/g,"\\$1"):""}function l(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}var o=function(e){return l(e=""+e)},a=o,u=new RegExp("(["+i(" !#$%&'()*+,./:;<=>?@[\\]^`{|}~\"")+"])","g"),s=null,p=null,c=null,d={},f=e.isArray,h=1,m={eq:function(e,t){var n;if(f(e)){for(n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}return e===t},neq:function(e,t){return!m.eq(e,t)},null:function(e){return null===e||""===e||f(e)&&0===e.length},notnull:function(e){return!m.null(e)},in:function(e,t){var n;if("string"!=typeof t)return!1;if(t=","+t+",",f(e)){for(n=0;n<e.length;n++)if(t.indexOf(","+e[n]+",")>=0)return!0;return!1}return t.indexOf(","+e+",")>=0},notin:function(e,t){return!m.in(e,t)}},g={markup:function(e){return this.html+=e,this},attr:function(e,t){return 1===arguments.length&&(t=e,e=null),e&&(this.html+=" "+e+"='"),this.html+=o(t),e&&(this.html+="'"),this},optionalAttr:function(e,t){return t&&"object"!=typeof t&&(this.html+=" "+e+"='"+o(t)+"'"),this},optionalBoolAttr:function(e,t){return!0===t&&(this.html+=" "+e),this},content:function(e){return this.html+=a(e),this},clear:function(){this.html=""},toString:function(){return this.html}},v={debounce:function(e,t){var n;return function(){var r=arguments,i=this;clearTimeout(n),n=setTimeout((function(){n=null,e.apply(i,r)}),t)}},toArray:function(t,n){var r,i=[];return"string"==typeof t?(r=void 0===n?":":n,i=t.split(r)):i=e.makeArray(t),i},arrayEqual:function(e,t){var n,r=e.length;if(r!==t.length)return!1;for(n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0},escapeHTML:l,escapeRegExp:i,escapeCSS:function(e){return e?e.replace(u,"\\$1"):""},htmlBuilder:function(){var e=Object.create(g);return e.clear(),e},makeApplicationUrl:function(e){var t,n="f?p=";if(n+=e.appId||$v("pFlowId"),n+=":",n+=e.pageId||$v("pFlowStepId"),n+=":",n+=e.session||$v("pInstance"),n+=":",n+=e.request||$v("pRequest"),n+=":",n+=e.debug||$v("pdebug")||"",n+=":",n+=e.clearCache||"",n+=":",e.itemNames&&(n+=e.itemNames.join(",")),n+=":",e.itemValues)for(t=0;t<e.itemValues.length;t++)t>0&&(n+=","),n+=encodeURIComponent(e.itemValues[t]);return n+=":",n+=e.printerFriendly||""},showSpinner:function(t,n){var r,i,l,o,a,u=v.htmlBuilder(),s=e.extend({alert:apex.lang.getMessage("APEX.PROCESSING"),spinnerClass:""},n),p=t&&!s.fixed?e(t):e("body"),c=e(window),d=p.offset(),f={top:c.scrollTop(),left:c.scrollLeft()};return u.markup("<span").attr("class","u-Processing"+(s.spinnerClass?" "+s.spinnerClass:"")).attr("role","alert").markup(">").markup("<span").attr("class","u-Processing-spinner").markup(">").markup("</span>").markup("<span").attr("class","u-VisuallyHidden").markup(">").content(s.alert).markup("</span>").markup("</span>"),(r=e(u.toString())).appendTo(p),s.fixed?(l=(c.height()-r.height())/2,i=(c.width()-r.width())/2,r.css({position:"fixed",top:l+"px",left:i+"px"})):(f.bottom=f.top+c.height(),f.right=f.left+c.width(),d.bottom=d.top+p.outerHeight(),d.right=d.left+p.outerWidth(),l=d.top>f.top?d.top:f.top,o=((d.bottom<f.bottom?d.bottom:f.bottom)-l)/2,(a=f.top-d.top)>0&&(o+=a),r.position({my:"center",at:"left+50% top+"+o+"px",of:p,collision:"fit"})),r},delayLinger:function(){var e={};function t(t){var n=e[t];return n||(n={count:0,timer:null},e[t]=n),n}function n(t){delete e[t]}return{start:function(e,n){var r=t(e);r.count+=1,1!==r.count||null!==r.timer||r.showing||(r.start=(new Date).getTime(),r.timer=setTimeout(()=>{r.timer=null,r.showing=!0,n()},200))},finish:function(e,r){var i,l=t(e);if(0===l.count)throw new Error("delayLinger.finish called before start for scope "+e);i=(new Date).getTime()-l.start,l.count-=1,0===l.count&&(null===l.timer?i<1e3?setTimeout(()=>{0===l.count&&(l.showing=!1,r(),n(e))},1e3-i):(l.showing=!1,r(),n(e)):(clearTimeout(l.timer),l.timer=null,n(e)))}}}(),setOuterHeight:function(t,n){e.each(["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom","marginTop","marginBottom"],(function(e,r){var i=parseInt(t.css(r),10);isNaN(i)||(n-=i)})),t.height(n)},setOuterWidth:function(t,n){e.each(["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight","marginLeft","marginRight"],(function(e,r){var i=parseInt(t.css(r),10);isNaN(i)||(n-=i)})),t.width(n)},getDateFromISO8601String:function(e){var t,n,r,i=0,l=0,o=0,a=0,u=/^(\d\d\d\d)-(\d\d)-(\d\d)(T(\d\d):(\d\d)(:(\d\d)(.(\d\d\d))?)?Z?)?$/.exec(e);if(!u)throw new Error("Invalid date format");return t=parseInt(u[1],10),n=parseInt(u[2],10)-1,r=parseInt(u[3],10),u[5]&&(i=parseInt(u[5],10),l=parseInt(u[6],10),u[8]&&(o=parseInt(u[8],10),u[10]&&(a=parseInt(u[10],10)))),new Date(Date.UTC(t,n,r,i,l,o,a))},getTopApex:function(){var e,t;function n(e){var t;try{t=e.apex||null}catch(e){t=null}return t}if(null!==p)return p;if(null!==(p=n(top)))return p;for(e=window;null!==(t=n(e))&&e.parent&&e.parent!==e;)p=t,e=e.parent;return p},getScrollbarSize:function(){var t;return null===s&&(t=e("<div>").css({width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}).appendTo("body"),s={width:t[0].offsetWidth-t[0].clientWidth,height:t[0].offsetHeight-t[0].clientHeight},t.remove()),s},invokeAfterPaint:(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,0)}).bind(window),cancelInvokeAfterPaint:(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||function(e){return window.clearTimeout(e)}).bind(window),stripHTML:function(e){for(var t=/<[^<>]+>/;t.exec(e);)e=e.replace(t,"");return e},getNestedObject:function(e,t){var n=e;return t.length>0&&t.split(".").forEach((function(e){void 0===n[e]&&(n[e]={}),n=n[e]})),n},checkCondition:function(e,n){var r,i,l,o;if(n=n||{},e.item){if(!(r=apex.item(e.item)).node)return t.warn("No such item: ",e.item),!1;i=r.getValue(),n.multiValued&&!f(i)&&""!==i&&(i=i.split(":"))}return void 0!==e.value&&(l=e.value,n.doSubstitution&&l.match(/[#&]/)&&(l=v.applyTemplate(l,n))),void 0!==e.value2&&(o=e.value2,n.doSubstitution&&o.match(/[#&]/)&&(o=v.applyTemplate(o,n))),!!m[e.op](i,l,o)},watchCondition:function(n,r,i){var l,o,a="watchCond"+h;if(h+=1,r=r||{},n.item){if(!(l=apex.item(n.item)).node)return void t.warn("No such item: ",n.item);e(l.node).on("change."+a,(function(){var e=apex.item(n.item).getValue();e!==o&&(o=e,i(v.checkCondition(n,r)))}))}return i(v.checkCondition(n,r)),a},unwatchCondition:function(t,n){var r;if(t.item){if(!(r=apex.item(t.item)).node)return;e(r.node).off("change."+n)}},defineTemplates:function(e){var n;for(n in e)e.hasOwnProperty(n)&&(n.match(/^[_$A-Z0-9]+$/)?d[n]=e[n]:t.warn("defineTemplates template with invalid name ignored: "+n))},listTemplates:function(){return Object.keys(d)},getTemplate:function(e){return d[e]||null},applyTemplate:function(i,a,u){var s,p,h,m,g,w,x,y,b,T,I,A,E,$,P=/#([_$A-Z0-9]+)#|{([iIcClLeEoOwWaA{!]([^/\r\n]|\/(?!}))*)\/}/g,O=/^(!|\w+(?:\s+|$))(.*)?$/,S=/^(.+)_LABEL$/,C=/^[_$A-Z0-9]+$/,k=/^[^"&\r\n]+$/,R=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script\s*>/gi,_=/\$[^$]*$/,M=/^"([^"]+)"\s+([^"&\r\n]+)$/,L=/\n\s*([_$A-Z0-9]+)\s*:=/g,F=apex.model,N=apex.item,V=[],H=[],X=[],q=[],D=[],B=null,W={if:function(e,t){var n=Z(t),r={matched:!1};return j(t)?(H.push(r),n?(r.matched=!0,e):ne(e,{else:1,elseif:1,endif:1},"if","endif")):e},elseif:function(e,n){var r=Z(n),i=H[H.length-1];return!j(n)||Y(H,"elseif","if")?e:(i.hasElse&&t.error("applyTemplate elseif must come before else"),!i.matched&&r?(i.matched=!0,e):ne(e,{else:1,elseif:1,endif:1},"if","endif"))},else:function(e,n){var r=H[H.length-1];return z("else",n),Y(H,"else","if")?e:(r.hasElse&&t.error("applyTemplate if must have only one else"),r.hasElse=!0,r.matched?ne(e,{endif:1},"if","endif"):(r.matched=!0,e))},endif:function(e,t){return z("endif",t),Y(H,"endif","if")||H.pop(),e},case:function(e,n){var r,i={matched:!1};if("text"===(r=V[e]).type&&""===r.text.trim()&&(e+=1),"directive"===(r=V[e]).type&&"when"===r.name){if(!j(n))return e;X.push(i),i.value=ee(n,!1).trim()}else t.error("applyTemplate must have 'when' right after 'case'");return e},when:function(e,n){var r=X[X.length-1];return Y(X,"when","case")?e:(r.hasOtherwise&&t.error("applyTemplate when must come before otherwise"),r.matched?ne(e,{endcase:1},"case","endcase"):r.value===n.trim()?(r.matched=!0,e):ne(e,{when:1,otherwise:1,endcase:1},"case","endcase"))},otherwise:function(e,n){var r=X[X.length-1];return z("otherwise",n),Y(X,"otherwise","case")?e:(r.hasOtherwise&&t.error("applyTemplate case must have only one otherwise"),r.hasOtherwise=!0,r.matched?ne(e,{endcase:1},"case","endcase"):(r.matched=!0,e))},endcase:function(e,t){return z("endcase",t),Y(X,"endcase","case")||X.pop(),e},with:function(e,n){var r,i,l,o,a,u,s,p,c=0,d="",f=ne(e,{apply:1},"with","apply");for(r=e;r<f;r++)d+=V[r].text;if((l=V[e=r])&&"directive"===l.type&&"apply"===l.name)for(B={},i=L.exec(d);i;)a=i.index+i[0].length,0===c&&(o=i[1],u=a),s=(i=L.exec(d))?i.index:d.length,(p=d.substring(a,s)).indexOf("{with")>=0&&(c+=1),p.indexOf("{apply")>=0&&(c-=p.split("{apply").length-1),0===c&&(B[o]=d.substring(u,s).trim());else t.error("applyTemplate missing 'apply' after 'with'");return e},apply:function(n,r){var i,l,o=r;if(o&&d[o]){for(i in l=e.extend({},u),B)B.hasOwnProperty(i)&&(l[i]=v.applyTemplate(B[i],a,u));s+=v.applyTemplate(d[o],a,l),B=null}else t.warn("applyTemplate apply missing or unknown template name");return n},loop:function(e,n){var r,i,l,o,u,s,p,c,d,h=null,m={};if(q.push(m),n?(h=n,i=F.get(h)):(h=null,(i=a.model)||t.error("applyTemplate no model or item to loop over")),i)d=a.extraSubstitutions,m.prevIndex=d.APEX$I,m.prevItem=d.APEX$ID,m.model=i,D.push(m),i.forEach((function(t,n,i){for(l=e,m.record=t,d.APEX$I=""+(n+1),d.APEX$ID=i;!(l>=V.length)&&("directive"!==(r=V[l]).type||"endloop"!==r.name);)l=re(l)})),d.APEX$I=m.prevIndex,d.APEX$ID=m.prevItem,h&&F.release(h),D.pop();else if(n){if(u=M.exec(n))p=u[1],n=u[2];else{let e=N(n);e.node&&(p=e.getSeparator()),p=p||":"}if(p.length>1&&(p=new RegExp(p)),s=ee(n,!0)){for(d=a.extraSubstitutions,m.prevIndex=d.APEX$I,m.prevItem=d.APEX$ITEM,c=f(s)?s:s.split(p),o=0;o<c.length;o++)for(l=e,d.APEX$I=""+(o+1),d.APEX$ITEM=c[o];!(l>=V.length)&&("directive"!==(r=V[l]).type||"endloop"!==r.name);)l=re(l);d.APEX$I=m.prevIndex,d.APEX$ITEM=m.prevItem}}return ne(e,{endloop:1},"loop","endloop")},endloop:function(e,t){return z("endloop",t),Y(q,"endloop","loop")||q.pop(),e},"!":function(e){return p=p.substring(g+y.length+3),e}};function j(e){return!!k.test(e)||(t.error("applyTemplate invalid name for 'if', 'elseif', or 'case'"),!1)}function Z(e){let t,n=null,r=!1;return 0===e.indexOf("!")&&(r=!0,e=e.substr(1).trim()),t=ee(e,!1),t=t.trim(),a.includePageItems&&(n=N(e),n.node||(n=null)),t=!(n&&n.isEmpty()||""===t||a.falseValues.includes(t)),r&&(t=!t),t}function Y(e,n,r){var i=e.length<1;return i&&t.error("applyTemplate '"+n+"' without '"+r+"'"),i}function z(e,n){""!==n&&t.warn("applyTemplate extra text after directive '"+e+"' ignored")}function U(e,t,n,r){var i=e.getOption("fields"),l="";return i.hasOwnProperty(t)&&(l=i[t][n]||""),"tmpl"===r?l=v.applyTemplate(l,a):"bool"===r&&(l=!0===l?"Y":"N"),""+l}var G,Q={label:function(t){var n=e("#"+v.escapeCSS(t.id)+"_CONTAINER");return n.length||(n=e("body")),n.find("[for='"+v.escapeCSS(t.id)+"']").text()},display:function(e){let t=e.displayValueFor(e.getValue());return f(t)&&(t=t.join(", ")),t},valid:function(e){return e.getValidity().valid?"Y":"N"},message:function(e){return e.getValidationMessage()},changed:function(e){return e.isChanged()?"Y":"N"},disabled:function(e){return e.isDisabled()?"Y":"N"}},J={display:function(e,t,n){var r,i,l=t.getOption("fields"),o=t.getValue(n,e);return l.hasOwnProperty(e)&&(r=l[e]),r&&r.cellTemplate?o=v.applyTemplate(r.cellTemplate,a):"object"==typeof o&&o.d?o=o.d:r&&r.elementId&&(i=N(r.elementId)).node&&(o=i.displayValueFor(o)),o},label:function(e,t){var n,r=t.getOption("fields"),i="";return r.hasOwnProperty(e)&&(n=r[e],i=v.stripHTML(n.label||n.heading||"")),i},heading:function(e,t){var n,r=t.getOption("fields"),i="";return r.hasOwnProperty(e)&&(i=(n=r[e]).heading||n.label||""),i},heading_class:function(e,t){return U(t,e,"headingCssClasses")},column_class:function(e,t){return U(t,e,"columnCssClasses")},field_class:function(e,t){return U(t,e,"fieldCssClasses")},field_col_span:function(e,t){return U(t,e,"fieldColSpan")},width:function(e,t){return U(t,e,"width")},required:function(e,t){return U(t,e,"isRequired","bool")},readonly:function(e,t,n,r){var i,l=U(t,e,"readonly","bool");return"Y"!==l&&(r&&r.fields&&r.fields[e]&&(i=r.fields[e]),(i&&i.ck||!t.allowEdit(n))&&(l="Y")),l},link:function(e,t,n,r){var i,l,o="",a=t.getOption("fields");return r&&r.fields&&r.fields[e]&&(l=r.fields[e]),a.hasOwnProperty(e)&&(i=a[e],b=i.heading||i.label||""),(l&&l.url||i.linkTargetColumn)&&(o=i.linkTargetColumn?t.getValue(n,i.linkTargetColumn)||null:l.url),o},link_text:function(e,t,n){return U(t,e,"linkText","tmpl")},link_attrs:function(e,t){return U(t,e,"linkAttributes","tmpl")},hidden:function(e,t){return U(t,e,"hidden","bool")}};function K(e,n,i){var u,s,p,d,h,m,g,w,x,y=a.defaultEscapeFilter,b=null;if((d=r.exec(e))&&(x=e.substring(0,d.index),w=d[1].toLowerCase()),0===e.indexOf("APP_TEXT$")&&(m=e.substr(9),(g=_.exec(m))&&(g[0].length>1&&t.warn("applyTemplate message text substitution "+g[0]+" language ignored."),m=m.replace(_,"")),m&&(b=apex.lang.getMessage(m))),null===b&&a.includePageItems&&((s=N(e)).node?b=s.getValue():x&&Q[w]&&(s=N(x)).node&&(b=Q[w](s))),null===b&&D.length>0){let t,n,r,i,l=D.length-1,o=D[l],a=o.model,c=o.record,f=o.recMeta,m=[];for(;null===b&&c&&a;)null===(b=a.getValue(c,e)||null)?((d=S.exec(e))?(h=d[1],(p=a.getOption("fields")).hasOwnProperty(h)&&(b=p[h].label||p[h].heading||null)):x&&J[w]&&(b=J[w](x,a,c,f)),c=null,null===b&&(t=a.getOption("parentModel"),n=a.getOption("parentRecordId"),t&&n?(a=F.get(t),a&&(m.push(t),c=a.getRecord(n),i=a.getRecordId(c),f=null,i&&(f=a.getRecordMetadata(i)))):l>0&&(l-=1,o=D[l],a=o.model,c=o.record,f=o.recMeta))):(c=null,(p=a.getOption("fields"))[e].hasOwnProperty("escape")&&(y=p[e].escape?"HTML":"RAW"),p[e].hasOwnProperty("elementId")&&(r=p[e].elementId,s=N(r)));for(u=0;u<m.length;u++)F.release(m[u])}if(null===b&&a.includeBuiltinSubstitutions&&(b=c[e]||null),null===b&&a.extraSubstitutions&&(b=a.extraSubstitutions[e]||null),null===b)b="";else{if("object"==typeof b&&b.hasOwnProperty("v")&&(b=b.v),"string"!=typeof b&&(n||!i))if(f(b)){let e=":";s&&(e=s.getSeparator()),b=b.join(e)}else b=""+b;if(!1!==n)if(n||(n=y),"HTML"===n)b=l(b);else if("ATTR"===n)b=o(b);else if("STRIPHTML"===n)b=l(v.stripHTML(b.replace("&nbsp;","")));else if("RAW"!==n&&n)throw new Error("Invalid template filter: "+n)}return b}function ee(e,t){var n=a.placeholders;if(C.test(e)){if(u&&void 0!==u[e])return u[e];if(n&&void 0!==n[e])return n[e]}return K(e,!1,t)}function te(e){return e.replace(n,(e,t,n,r,i,l)=>{var o="";return r&&(n=r),n&&(o=K(n,l)),o})}function ne(e,t,n,r){var i,l,o,a=0;for(i=e;i<V.length;i++){if(o=(l=V[i]).name,"directive"===l.type){if(t[o]&&0===a)break;o===n?a+=1:o===r&&(a-=1)}if(a<0)break}return i}function re(e){var t=V[e];return e+=1,"text"===t.type?"directive"===$&&""===t.text.trim()||(s+=te(t.text),$=t.type):"ph"===t.type?(s+=t.value,$=t.type):"directive"===t.type&&((E=W[t.name])?($=t.type,e=E(e,t.arg)):(s+=te(t.text),$="text")),e}if((a=e.extend({placeholders:null,directives:!0,defaultEscapeFilter:"HTML",includePageItems:!0,model:null,record:null,extraSubstitutions:{},includeBuiltinSubstitutions:!0,falseValues:["F","f","N","n","0"]},a||{})).model&&a.record){let e=null,t=a.model,n=a.record,r=t.getRecordId(n);r&&(e=t.getRecordMetadata(r)),D.push({model:t,record:n,recMeta:e})}if(!c&&a.includeBuiltinSubstitutions&&(c={APP_ID:$v("pFlowId"),APP_PAGE_ID:$v("pFlowStepId"),APP_SESSION:$v("pInstance"),REQUEST:$v("pRequest"),DEBUG:$v("pdebug"),IMAGE_PREFIX:window.apex_img_dir||""}),(u||a.directives)&&null===a.placeholders&&(a.placeholders={}),T=null!==a.placeholders,I=a.directives,T||I){for(p=i,h=P.exec(p),g=h?h.index:-1,w=0;h;)x=h[1],y=h[2],"{{/}"===h[0]?(V.push({type:"text",text:p.substring(w,g)+"{"}),w=g+h[0].length):x&&T?(G=x,void 0!==(b=u&&void 0!==u[G]?u[G]:a.placeholders[x])?(g>w&&V.push({type:"text",text:p.substring(w,g)}),V.push({type:"ph",text:h[0],value:b})):(V.push({type:"text",text:p.substring(w,g+x.length+2)}),P.lastIndex-=1),w=g+h[0].length):y&&I&&(g>w&&V.push({type:"text",text:p.substring(w,g)}),(m=O.exec(y))?V.push({type:"directive",text:h[0],name:m[1].trim().toLowerCase(),arg:(m[2]||"").trim()}):V.push({type:"text",text:h[0]}),w=g+h[0].length),h=P.exec(p),g=h?h.index:-1;p.length>w&&V.push({type:"text",text:p.substring(w)})}else V.push({type:"text",text:i});for(s="",A=0,$=null;A<V.length;)A=re(A);for((H.length>0||X.length>0||q.length>0)&&t.error("applyTemplate missing 'endif', 'endcase', or 'endloop'");R.test(s);)s=s.replace(R,"");return s},extractTemplateDependencies:function(e){var t,r,i=[];for(t=n.exec(e);t;)r=t[2]||t[3],i.push(r),t=n.exec(e);return i}};return v.escapeHTMLContent=a,v.escapeHTMLAttr=o,v}(apex.jQuery,apex.debug);