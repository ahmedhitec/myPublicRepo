apex.session={},function(e,i,s,t,n,o){"use strict";var a,r,m,l,d,c;function f(){o("#apex_session_alert_dlg").remove()}function u(e,s){var t=o.extend({id:"apex_session_alert_dlg",confirm:!0},s);return f(),i.showDialog(e,t)}function _(){m&&(clearTimeout(m),n.info("Idle session warning timer cleared. ID="+m)),l&&(clearTimeout(l),n.info("Idle session expired timer cleared. ID="+l))}function E(e){var i=new Date,s=e.life_time_ms/1e3,t=a<s?a:s;return i.setSeconds(i.getSeconds()+t),i.toLocaleTimeString(void 0,{timeStyle:"medium"})}function x(i){_(),f(),m=setTimeout((function(){e.getTimeouts((function(i){n.info("Is session idle time still valid?",i),i.idle_time_ms-1<1e3*a?(n.info("...Yes, show warning."),u(t.formatMessage("APEX.SESSION.ALERT.IDLE_WARN",E(i)),{okLabelKey:"APEX.SESSION.ALERT.EXTEND",callback:function(i){i&&e.getTimeouts((function(e){n.info("Session extended",e),x(e)}),!0)}})):(n.info("...No, reset idle timers to new values."),x(i))}))}),i.idle_time_ms-1e3*a),l=setTimeout((function(){e.getTimeouts((function(e){n.info("Is session idle expired time still valid?",e),0===e.idle_time_ms?(n.info("...Yes, show expired alert."),d&&(clearTimeout(d),n.info("Max session warning timer cleared. ID="+d)),c&&(clearTimeout(c),n.info("Max session expired timer cleared. ID="+c)),u(t.getMessage("APEX.SESSION.ALERT.EXPIRED"),{okLabelKey:"APEX.SESSION.ALERT.CREATE_NEW",callback:function(e){e&&s.redirect(r)}})):(n.info("...No, reset idle timers to new values."),x(e))}))}),i.idle_time_ms),n.info("Idle session warning timer started for "+(i.idle_time_ms/1e3-a)+" seconds. ID="+m),n.info("Idle session expired timer started for "+i.idle_time_ms/1e3+" seconds. ID="+l)}e.getTimeouts=function(e,i){o.get({url:"apex_session.emit_timeouts?p_app_id="+$v("pFlowId")+"&p_session_id="+$v("pInstance")+"&p_reset_idle="+(i?"Y":"N"),dataType:"json",success:e,error:function(e,i,s){n.error("Error occurred when making session.getTimeouts Ajax call.",e,i,s)}})},e.initTimeouts=function(e,i,o){var m;r=o,(a=e)>0&&(a>i.max_idle_time_ms/1e3?n.warn("Invalid metadata state. Session timeout warning time ("+a+" seconds) cannot be greater than the maximum session idle time ("+i.max_idle_time_ms/1e3+" seconds)."):(x(i),m=i,d=setTimeout((function(){n.info("Session max time about to expire, show warning."),_(),u(t.formatMessage("APEX.SESSION.ALERT.MAX_WARN",E(m)),{confirm:!1})}),m.life_time_ms-1e3*a),c=setTimeout((function(){n.info("Session max time expired, show expired alert."),u(t.getMessage("APEX.SESSION.ALERT.EXPIRED"),{okLabelKey:"APEX.SESSION.ALERT.CREATE_NEW",callback:function(e){e&&s.redirect(r)}})}),m.life_time_ms),n.info("Max session warning timer started for "+(m.life_time_ms/1e3-a)+" seconds. ID="+d),n.info("Max session expired timer started for "+m.life_time_ms/1e3+" seconds. ID="+c)))}}(apex.session,apex.message,apex.navigation,apex.lang,apex.debug,apex.jQuery);