!function(e,t,i,s){"use strict";var n="a-TreeView-node",r="."+n,o="a-TreeView-row",a="."+o,l="a-TreeView-content",d="."+l,h=d+", "+a,c="a-TreeView-toggle",p="is-selected",f="is-disabled",u="is-focused",g="is-expandable",m="is-collapsible",v="a-TreeView-node--leaf",_="aria-expanded",b="aria-selected",w="aria-level",y="true",x=s.ui.keyCode;function C(){return new Error("Unsupported by model")}function I(){return new Error("Parent node required")}function N(e,t){var i,n,r="",o=e.className.split(" ");for(i=0;i<o.length;i++)n=o[i],s.inArray(n,t)>=0&&(r+=" "+n);e.className=r.substr(1)}function S(e){return e.parent().children(":visible").index(e)}function T(e){var t=e.get(0).id;return t.substring(t.lastIndexOf("_")+1)}function k(e,t){return parseInt(e.children(d).find(t).attr(w),10)}function A(e,t){return parseInt(e.find(t).attr(w),10)}var P=function(e,t){e._trigger("selectionChange",t)},D=t.debounce(P,1),O=t.debounce(P,350),E=null;function V(e,t,i,s,n){var r,o,a,l;i.renderNodeContent?i.renderNodeContent(t,e,s,n):(s.nodeSelector>0&&(l="u-selector",1===s.nodeSelector&&(l+=" u-selector--single"),e.markup('<span class="'+l+'"></span>')),i.getIcon&&null!==(r=i.getIcon(t))&&e.markup("<span").attr("class",s.iconType+" "+r).markup("></span>"),(o=s.useLinks&&i.getLink&&i.getLink(t))?(E&&o.match(/^#\S*$/)&&(o=E+o),a="a"):a="span",e.markup("<"+a+" tabIndex='-1' role='treeitem'").attr("class",s.labelClass).optionalAttr("href",o).attr(w,n.level).attr(b,n.selected?y:"false").optionalAttr("aria-disabled",n.disabled?y:null).optionalAttr(_,!1===n.hasChildren?null:n.expanded?y:"false").markup(">").content(i.getLabel(t)).markup("</"+a+">"))}function M(e){e.tabIndex=0,e.focus()}function R(e){var t;return e.hasClass(m)?t=e.children("ul").children("li").first():0===(t=e.next()).length&&(t=e.parent().parents("li").next("li").first()),t}function L(e){var t;return(t=e.prev()).length>0?t.hasClass(m)&&(t=t.find("li").filter(":visible").last()):t=e.parent().parent("li"),t}function F(e,t,i,n,r){var o=e.val(t).width(i).keydown((function(e){var t=e.which;e.shiftKey||e.ctrlKey||e.altKey||(t===x.ENTER?(n(s(this).val(),!0),e.preventDefault()):t===x.ESCAPE&&(setTimeout((function(){r(!0)}),10),e.preventDefault()))})).blur((function(e){n(s(this).val(),!1)}))[0];return M(o),o.select(),o}s("base").length&&(E=window.location.pathname+window.location.search);var K={begin:function(e,t){this.text="<ul>\r\n"},node:function(e,i,s){this.text+="<li>"+t.escapeHTML(s)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};s.widget("apex.treeView",s.ui.mouse,s.extend(!0,{version:"19.1",widgetEventPrefix:"treeview",options:{getNodeAdapter:null,adapterTypesMap:null,showRoot:!0,expandRoot:!0,collapsibleRoot:!0,autoCollapse:!1,useLinks:!0,multiple:!1,nodeSelector:!1,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(e,t){this.text=""},node:function(e,t,i){t>0&&(this.text+="\r\n"),this.text+=i},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(K)}],idPrefix:null,iconType:"a-Icon",labelClass:"a-TreeView-label",doubleClick:!1,clickToRename:!1,keyboardRename:!1,keyboardAdd:!1,keyboardDelete:!1,tooltip:null,navigation:!1,dragAndDrop:!1,dragMultiple:!1,dragReorder:!1,dragAppendTo:"parent",dragContainment:!1,dragCursor:"auto",dragCursorAt:!1,dragHelper:null,dragOpacity:!1,dragAnimate:!1,dragExpandDelay:1200,dragScroll:!0,dragScrollSensitivity:20,dragScrollSpeed:10,dragZIndex:1e3,scope:"default",activate:null,deactivate:null,out:null,over:null,start:null,drag:null,beforeStop:null,stop:null,selectionChange:null,expansionStateChange:null,activateNode:null,beginEdit:null,endEdit:null,added:null,renamed:null,deleted:null,moved:null,copied:null},scrollTimerId:null,delayExpandTimer:null,hasCurrent:!1,tooltipOptions:null,triggerTimerId:null,forwardKey:x.RIGHT,backwardKey:x.LEFT,scrollParent:null,animating:!1,dragging:!1,dragItems:null,currentItem:null,_create:function(){var e=this,t=this.element,i=this.options;if(i.getNodeAdapter||(i.getNodeAdapter=this._parseTreeMarkup(t,i.adapterTypesMap||null)),!i.getNodeAdapter)throw new Error("Missing required option getNodeAdapter");this.nodeAdapter=i.getNodeAdapter(),this.containerCache={},!1===i.collapsibleRoot&&(i.expandRoot=!0),t.addClass("a-TreeView").attr("role","tree"),this.baseId=(i.idPrefix||t[0].id||"tree")+"_",this.labelSelector="."+i.labelClass,this.editMode=!1,i.multiple&&t.attr("aria-multiselectable",y),this.rtlFactor=1,"rtl"===t.css("direction")&&(t.addClass("u-RTL"),this.forwardKey=x.LEFT,this.backwardKey=x.RIGHT,this.rtlFactor=-1),i.disabled&&t.attr("aria-disabled",y),i.tooltip&&this._initTooltips(i.tooltip),this._initContextMenu(d,(function(t){return s(t.target).closest("a").length>0||e.editMode}),(function(t){var i="keydown"===t.type&&e.lastFocused?e.lastFocused:t.target,n=s(i).closest(d);return!!n.length&&(!!n.hasClass(p)||n)}),(function(t){t.selectedNodes=e.getNodes(t.selection),t.treeNodeAdapter=e.nodeAdapter})),this.scrollParent=t.scrollParent(),this.offset=this.element.offset(),this._mouseInit(),this._on(this._eventHandlers),i.allowCopy&&apex.clipboard.addHandler(t[0],(function(t){return!e.editMode&&(e._copy(t),!0)})),this._setOption("disabled",i.disabled),this.refresh()},_eventHandlers:{click:function(e){var t,i,n=this.options,o=s(e.target);if(n.multiple||"A"!==e.target.nodeName||!e.shiftKey&&!e.ctrlKey){if(o.hasClass("u-selector"))t=o.closest(r),e.ctrlKey=!0,e.shiftKey=!1,this._select(t.children(d),e,!0),e.preventDefault();else if(o.hasClass(c))this._toggleNode(o.parent()),this.scrollParent&&(a=this.scrollParent,l=a.scrollTop(),h=a,f=null,a[0]===document&&(h=s(window)),h.on("scroll.treeTemp",(function(){a.scrollTop(l),h.off(".treeTemp"),clearTimeout(f)})),f=setTimeout((function(){h.off(".treeTemp")}),20)),this.lastFocused.focus(),e.preventDefault();else if((t=o.closest(r)).length>0){if(i=t.children(d),this.editMode&&i.hasClass(p))return;n.clickToRename&&i.find(this.labelSelector).attr(b)===y&&!e.ctrlKey&&!e.altKey&&1===this.getSelection().length&&o.closest(this.labelSelector).length?this.renameNodeInPlace(i):(this._select(i,e,!0),n.navigation&&(this.keyboardActivate||"activate"!==n.doubleClick)&&this._activate(e)),e.preventDefault()}var a,l,h,f,u;this.keyboardActivate=!1,u={},window.getSelection?u=window.getSelection():document.selection&&(u=document.selection.createRange()),u.rangeCount?u.removeAllRanges():u.text>""&&document.selection.empty()}else this.keyboardActivate=!1},dblclick:function(e){var t,i=this.options.doubleClick;i&&!this.editMode&&(t=s(e.target).closest(r)).length>0&&("toggle"===i?(this._toggleNode(t),e.preventDefault()):"activate"===i&&this._activate(e))},keydown:function(e){var t,i,n,o,l,h=this,c=this.options,p=this.element,f=e.which;e.altKey||"INPUT"===e.target.nodeName||this.dragging||(f!==x.PAGE_UP&&f!==x.PAGE_DOWN||(this.scrollParent?(n=p.find(a).filter(":visible").first().outerHeight()||24,t=p.find("li").filter(":visible").first(),n+=parseInt(t.css("margin-top"),10)+parseInt(t.css("margin-bottom"),10),o=this.scrollParent[0]===document?s(window).height():this.scrollParent[0].clientHeight,l=Math.floor(o/n)-1):l=10),f===x.HOME?(p.find(d).filter(":visible").first().each((function(){h._select(s(this),e,!0,!0)})),e.preventDefault()):f===x.END?(p.find(d).filter(":visible").last().each((function(){h._select(s(this),e,!0,!0)})),e.preventDefault()):f===x.SPACE?(this.lastFocused&&this._select(s(h.lastFocused).closest(d),e,!0,!0),e.preventDefault()):f===x.DOWN?(this._traverseDown(e,1),e.preventDefault()):f===x.UP?(this._traverseUp(e,1),e.preventDefault(),e.stopPropagation()):f===x.PAGE_DOWN?(this._traverseDown(e,l),e.preventDefault()):f===x.PAGE_UP?(this._traverseUp(e,l),e.preventDefault()):f===this.backwardKey?(this.lastFocused&&((t=s(this.lastFocused).closest(r)).hasClass(m)?this._collapseNode(t):t.parent().prevAll(d).each((function(){h._select(s(this),e,!0,!0)}))),e.preventDefault()):f===this.forwardKey?(this.lastFocused&&((t=s(this.lastFocused).closest(r)).hasClass(g)?this._expandNode(t):t.hasClass(m)&&t.children("ul").children("li").first().children(d).each((function(){h._select(s(this),e,!0,!0)}))),e.preventDefault()):f===x.ENTER?"A"===e.target.nodeName||e.shiftKey||e.ctrlKey?this.keyboardActivate=!0:(this._activate(e),e.preventDefault()):113===f&&c.keyboardRename?(i=this.lastFocused&&s(this.lastFocused).closest(d+".is-selected").length>0?s(this.lastFocused).closest(d):this.getSelection().first()).length>0&&this.renameNodeInPlace(i):45===f&&c.keyboardAdd?(i=this.lastFocused&&s(this.lastFocused).closest(d+".is-selected").length>0?s(this.lastFocused).closest(d):this.getSelection().first()).length>0&&this.addNodeInPlace(i):f===x.DELETE&&c.keyboardDelete&&this.deleteNodes(this.getSelection()))},keypress:function(e){var t,i,n=this;if(!(0===e.which||e.ctrlKey||e.altKey||"INPUT"===e.target.nodeName||this.dragging)){if(t=String.fromCharCode(e.which).toLowerCase(),this.searchTimerId)t!==this.searchString&&(this.searchString+=t),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===t)return;this.searchString=t}this.searchTimerId=setTimeout((function(){n.searchTimerId=null}),500),(i=function(e){var t,i,o,a=e.length;function l(){0===(i=R(i)).length&&(i=n.element.find(r).filter(":visible").first())}for(i=t=s(n.lastFocused).closest(r),1===a&&l();;){if((o=i.children(d).find(n.labelSelector).first()).text().substring(0,a).toLowerCase()===e)return o.closest(d);if(l(),i[0]===t[0])break}return null}(this.searchString))&&this._select(i,e,!0,!0)}},focusin:function(e){var t=s(e.target).closest(this.labelSelector);t.length&&(t.addClass(u).closest(r).children(a).addClass(u),this._setFocusable(t))},focusout:function(e){s(e.target).closest(this.labelSelector).removeClass(u).closest(r).children(a).removeClass(u)},mousemove:function(e){var t;this.dragging||(t=s(e.target).closest(r)).length&&this.lastHover!==t[0]&&(s(this.lastHover).children(h).removeClass("is-hover"),t.children(h).addClass("is-hover"),this.lastHover=t[0])},mouseleave:function(e){this.dragging||this.lastHover&&(s(this.lastHover).children(h).removeClass("is-hover"),this.lastHover=null)}},_setOption:function(e,t){var n,r=this.options;if(this._checkContextMenuOptions(e,t),"disabled"===e)r[e]=t,this.widget().toggleClass(f,!!t),t?(this.element.attr("aria-disabled",y),this.lastFocused&&(this.lastFocused.tabIndex=-1),this.lastFocused=null):(this.element.removeAttr("aria-disabled"),(n=this.getSelection().first().find(this.labelSelector)).length||(n=this.element.find(this.labelSelector).first()),this._setFocusable(n));else{if("allowCopy"===e)throw new Error("TreeView "+e+" cannot be set");if("dragMultiple"===e&&t&&!r.multiple)throw new Error("TreeView dragMultiple cannot be true when the multiple option is false");if("multiple"===e&&!t&&r.dragMultiple)throw new Error("TreeView multiple cannot be false when the dragMultiple option is true");if("collapsibleRoot"===e)throw new Error("TreeView collapsibleRoot option cannot be set");this._super(e,t)}(r=this.options).multiple&&!r.nodeSelector&&apex.userHasTouched()&&(r.nodeSelector=!0),this.renderNodeOptions={iconType:r.iconType,labelClass:r.labelClass,useLinks:r.useLinks,nodeSelector:r.nodeSelector?r.multiple?2:1:0},"showRoot"===e||"useLinks"===e?this.refresh():"getNodeAdapter"===e?(this.nodeAdapter=r.getNodeAdapter(),this.refresh()):"multiple"===e?(this.element.attr("aria-multiselectable",t?y:"false"),!1===t&&this.getSelection().length>0&&this._select(s(this.lastFocused).closest(d),null,!1,!1)):"expandRoot"===e&&!1===t?!1===r.collapsibleRoot&&(r.expandRoot=!0,i.warn("ExpandRoot option cannot be false when collapsibleRoot is false")):"tooltip"===e&&this._initTooltips(t)},_initTooltips:function(e){var t,n=this;s.ui.tooltip?(this.tooltipOptions&&(this.element.tooltip("destroy"),this.tooltipOptions=null),e&&((t=this.tooltipOptions=s.extend(!0,{},e)).items=this.labelSelector,t.content&&s.isFunction(t.content)&&(t._originalContent=t.content,t.content=function(e){var i=n.getNodes(s(this).closest(d))[0];return t._originalContent.call(this,e,i)}),this.element.tooltip(t))):i.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var e=this.element;e.empty().removeClass("a-TreeView u-RTL").removeAttr("role").removeAttr("aria-multiselectable"),apex.clipboard.removeHandler(e[0]),this._destroyContextMenu(),this.options.tooltip&&s.ui.tooltip&&e.tooltip("destroy"),this._mouseDestroy()},refresh:function(e){var i,n,o,a=this,l=this.options,d=this.nodeAdapter,h=null,c=this.element,p=t.htmlBuilder();d.getViewId&&(h=this.getSelectedNodes()),e?e.each((function(){var e=s(this).parent(),t=a.treeMap[T(e)];e.find(r).addBack().each((function(){delete a.treeMap[T(s(this))]})),p.clear(),a._renderNode(t,k(e,a.labelSelector),p),e.replaceWith(p.toString())})):(this.treeMap={},this.nextNodeId=0,d.clearViewId&&d.clearViewId(this.baseId),(i=d.root())?(p.markup("<ul role='group'>"),l.showRoot?this._renderNode(i,1,p):d.hasChildren(i)&&this._renderChildren(i,1,p),p.markup("</ul>"),c.html(p.toString())):(p.markup("<ul role='group'>"),p.markup("</ul>"),c.html(p.toString())),l.expandRoot&&l.showRoot&&(n=this._getRoots()).length>0&&this._expandNode(n)),this.hasCurrent?(o=this.find({depth:-1,match:function(e){return!0===e.current}}),this.hasCurrent=!1,this.setSelection(o)):h&&h.length>0?this.setSelectedNodes(h,!1,!0):(this.selectAnchor=this.lastFocused,this._setFocusable(c.find(this.labelSelector).first()))},getNodeAdapter:function(){return this.nodeAdapter},focus:function(){this.lastFocused&&this.lastFocused.focus()},getTreeNode:function(e){var t,i=this.nodeAdapter;if(!i.getViewId)throw C();return t=i.getViewId(this.baseId,e),s("#"+this.baseId+t).children(d)},getSelection:function(){return this.element.find(d+".is-selected")},getNodes:function(e){var t=this,i=[];return e.each((function(){var e=T(s(this).closest("li"));"new"!==e&&i.push(t.treeMap[e])})),i},getSelectedNodes:function(){return this.getNodes(this.getSelection())},setSelection:function(e,t,i){t=!!t,this.options.multiple||(e=e.first()),this._select(e,null,t,!1,i)},setSelectedNodes:function(e,t,n){var r,o,a,l=[],h=this.nodeAdapter;if(!h.getViewId)throw C();for(t=!!t,this.options.multiple||(e=[e[0]]),r=0;r<e.length;r++)o=h.getViewId(this.baseId,e[r]),(a=s("#"+this.baseId+o).children(d)[0])?l.push(a):i.warn("TreeView: Ignoring bad node in setSelectedNodes");this._select(s(l),null,t,!1,n)},getExpandedNodeIds:function(){var e=this.nodeAdapter;if(!e.getExpandedNodeIds)throw C();return e.getExpandedNodeIds(this.baseId)},getExpandedState:function(){var e=this.nodeAdapter;if(!e.getExpandedState)throw C();return e.getExpandedState(this.baseId)},find:function(e){return s(this._find(e.parentNodeContent$||null,e.match,e.depth||1,e.findAll||!1))},expand:function(e){var t=this;e||(e=this._getRoots().children(d)),e.each((function(){var e=s(this).closest(r);e.hasClass(g)&&t._expandNode(e)}))},expandAll:function(e){var t=this;e||(e=this._getRoots().children(d)),e.each((function(){var e=s(this).closest(r);e.hasClass(g)?t._expandNode(e,(function(){t.expandAll(e.children("ul").children("li").children(d))})):t.expandAll(e.children("ul").children("li").children(d))}))},collapse:function(e){var t=this;e||(e=this._getRoots().children(d)),e.each((function(){var e=s(this).closest(r);e.hasClass(m)&&t._collapseNode(e)}))},collapseAll:function(e){var t=this;e||(e=this._getRoots().children(d)),e.each((function(){var e=s(this).closest(r);t.collapseAll(e.children("ul").children("li").children(d)),e.hasClass(m)&&t._collapseNode(e)}))},addNodeInPlace:function(e,i,r){var a,h,c,f,u=this,g=this.element,m=this.options,_=this.nodeAdapter,x=!1;function I(t){h.remove(),u._makeLeafIfNeeded(e),u._select(e,null,t),u._endEdit({action:"add",status:"cancel"})}function N(s,n){var o;x||(0!==s.length?(x=!0,_.addNode(c,a.children().length-1,s,r,(function(s,r){var l,p;if(!1===s)return x=!1,M(o=h.find(".a-TreeView-input").val(i).get(0)),void o.select();s?(h.remove(),p=t.htmlBuilder(),u._renderNode(s,f,p),r>=a.children("li").length?a.append(p.toString()):a.children("li").eq(r).before(p.toString()),l=a.children("li").eq(r),0===u.getSelection().length&&u._select(l.children(d),null,n),u._endEdit({action:"add",status:"complete"}),u._trigger("added",{},{parentNode:c,parent$:e,index:r,node:s,node$:l.children(d)})):I(n)}))):I(n))}function S(){var e,c,g,x=t.htmlBuilder(),C=u.baseId+"new";x.markup("<li").attr("id",C).attr("class",n+" "+v).markup("><div").attr("class",o+" "+p).markup("></div><div").attr("class",l+" "+p).markup(">"),_.getIcon&&x.markup("<span").attr("class",m.iconType).markup("></span>"),x.markup("<span role='treeitem'").attr("class",m.labelClass).attr(w,f).attr(b,y).markup("><input class='a-TreeView-input' type='text'></span></div></li>"),u._select(s(),null,!1),a.append(x.toString()),c=(h=a.find("#"+C)).children(d),e=1===u.rtlFactor?c.width()-c.find(u.labelSelector)[0].offsetLeft-16:c.find(u.labelSelector)[0].offsetLeft+c.find(u.labelSelector).width()-16,F(g=c.find(".a-TreeView-input"),i,e,N,I),u._beginEdit({action:"add",context:r,input:g[0]})}if(!_.addNode||!_.allowAdd)throw C();if(null===e){if(c=_.root(),!m.showRoot){if(!_.allowAdd(c,"add",r?[r]:void 0))return;return f=1,a=g.find("ul:first"),void S()}e=g.find("ul:first > li")}else c=this.treeMap[T(e.parent())];_.allowAdd(c,"add",r?[r]:void 0)&&(f=A(e,u.labelSelector)+1,u._makeParentIfNeeded(e),this._expandNode(e.parent(),(function(){a=e.next("ul"),S()})))},renameNodeInPlace:function(e){var i,n,r,o,a,l,d=this,h=this.nodeAdapter,c=e.parent(),f=T(c),u=!1,g=t.htmlBuilder();function m(t){l.selected=e.hasClass(p),g.clear(),V(g,i,h,d.renderNodeOptions,l),e.html(g.toString()),l.selected&&d._select(e,null,t),d._endEdit({action:"rename",status:"cancel"})}if(!h.renameNode||!h.allowRename)throw C();i=this.treeMap[f],h.allowRename(i)&&(a=e.find(this.labelSelector),l={level:parseInt(a.attr(w),10),selected:a.attr(b)===y,disabled:a.attr("aria-disabled")===y,hasChildren:void 0!==a.attr(_),expanded:a.attr(_)===y},r=h.getLabel(i),o=1===d.rtlFactor?e.width()-a[0].offsetLeft-16:a[0].offsetLeft+a.width()-16,n=s("<input class='a-TreeView-input' type='text'>"),a.empty().append(n),F(n,r,o,(function(t,s){var n;u||(u=!0,t!==r&&0!==t.length?h.renameNode(i,t,(function(t,i){var o,a,v;if(!1===t)return u=!1,M(n=e.find(".a-TreeView-input").val(r)[0]),void n.select();t?(g.clear(),l.selected=e.hasClass(p),V(g,t,h,d.renderNodeOptions,l),e.html(g.toString()),d.treeMap[f]=t,(o=(v=(a=c.parent()).children("li")).index(c))!==i&&(i>o&&(i+=1),i>=v.length?a.append(c):v.eq(i).before(c)),l.selected&&d._select(e,null,s),d._endEdit({action:"rename",status:"complete"}),d._trigger("renamed",{},{prevLabel:r,index:i,node:t,node$:e}),d._trigger("selectionChange",0)):m(s)})):m(s))}),m),d._beginEdit({action:"rename",node:i,input:n[0]}))},deleteNodes:function(e){var t,i,n,r=this,o=[],a=[],l=[],h=this.nodeAdapter;function c(e){var t=o[e];h.deleteNode(t.node,(function(e){n+=1,e&&(a.push(t.element),l.push({node:t.node,parent$:t.parent$,index:t.index}),h.clearViewId&&h.clearViewId(r.baseId,t.node)),n>=i&&(r.deleteTreeNodes(s(a)),r._trigger("deleted",{},{items:l}))}),e<i-1)}if(!h.deleteNode||!h.allowDelete)throw C();for(e.each((function(){var e=s(this),t=r.treeMap[T(e.parent())];h.allowDelete(t)&&o.push({node:t,element:e[0],parent$:e.parent().parent().parent().children(d),index:S(e.parent())})})),i=o.length,n=0,t=0;t<i;t++)c(t)},deleteTreeNodes:function(e){var t,i=this,s=e.closest("ul").prev(),n=e.parent(),r=e.children(this.labelSelector).filter(this.lastFocused).length>0,o=e.hasClass(p);(o||r)&&(0===(t=L(n.eq(0))).length&&(t=this._getRoots().first()),t.length>0?o?this._select(t.children(d),null,r):this._setFocusable(t.children(d).find(this.labelSelector)):r&&(this.lastFocused=null)),n.remove().each((function(){delete i.treeMap[T(n)]})),this._makeLeafIfNeeded(s)},addNode:function(e,t,i){var s,n,r=this.nodeAdapter;if(!r.addNode||!r.allowAdd)throw C();if(e&&e.length)n=this.treeMap[T(e.parent())];else{if(this.options.showRoot)throw I();n=r.root()}r.allowAdd(n,"add",i?[i]:void 0)&&(s=this.element.find("."+u).length>0,this._add({},e,t,i,s))},moveNodes:function(e,t,i){var s,n,r,o=this.getNodes(i),a=!0,l=this.nodeAdapter;if(!l.moveNodes||!l.allowDelete||!l.allowAdd)throw C();if(e&&e.length)r=this.treeMap[T(e.parent())];else{if(this.options.showRoot)throw I();r=l.root()}for(s=0;s<o.length;s++)if(!l.allowDelete(o[s])){a=!1;break}a&&l.allowAdd(r,"move",o)&&(n=this.element.find("."+u).length>0,this._moveOrCopy({},e,t,i,!1,n))},copyNodes:function(e,t,i){var s,n,r=this.getNodes(i),o=this.nodeAdapter;if(!o.copyNodes||!o.allowAdd)throw C();if(e&&e.length)n=this.treeMap[T(e.parent())];else{if(this.options.showRoot)throw I();n=o.root()}o.allowAdd(n,"copy",r)&&(s=this.element.find("."+u).length>0,this._moveOrCopy({},e,t,i,!0,s))},update:function(e){var i,s,n,r,d,h,c=this.treeMap[T(e.parent())],g=this.nodeAdapter,m=t.htmlBuilder();i=(r=e.find(this.labelSelector))[0]===this.lastFocused,(g.getClasses||g.isDisabled)&&(n=e.prevAll(a),N(e[0],[l,f,u,p,"is-hover"]),N(n[0],[o,f,u,p,"is-hover"]),g.getClasses&&(s=g.getClasses(c))&&(e.addClass(s),n.addClass(s)),g.isDisabled&&g.isDisabled(c)&&(e.addClass(f),n.addClass(f),h=!0)),d={level:parseInt(r.attr(w),10),selected:r.attr(b)===y,disabled:h,hasChildren:void 0!==r.attr(_),expanded:r.attr(_)===y},V(m,c,g,this.renderNodeOptions,d),e.html(m.toString()),i&&this._setFocusable(e.find(this.labelSelector))},_copy:function(e){var t,i,s=this.nodeAdapter,n=this.getSelectedNodes(),r=this.options.dataTransferFormats;if(n.length){for(r.forEach((function(e){e.writer.begin(s,n)})),t=0;t<n.length;t++)i=n[t],r.forEach((function(e){e.writer.node(i,t,s.getLabel(i))}));r.forEach((function(t){t.writer.end(),e.setData(t.format,t.writer.toString())}))}},_parseTreeMarkup:function(e,t){var i,n,r,o=!0,a=this;return r=(n=function e(t){var i=[];return t.children("ul").children("li").each((function(){var t,n,r,l,d,h,c=s(this),p=c.children("a").first(),f=c.children("span").first();t={},p.length>0?(t.label=p.text(),t.link=p.attr("href"),(h=p.attr("target"))&&(t.linkTarget=h)):f.length>0&&(t.label=f.text()),(r=c.attr("data-id"))?t.id=r:o=!1,c.attr("data-current")===y&&(t.current=!0,a.hasCurrent=!0),(l=c.attr("class"))&&(t.classes=l),c.attr("data-disabled")===y&&(t.isDisabled=!0),(n=c.attr("data-icon"))&&(t.icon=n),(d=c.attr("data-type"))&&(t.type=d),c.children("ul").length>0&&(t.children=e(c)),i.push(t)})),i}(e)).length>=1?1===n.length&&this.options.showRoot?n[0]:{children:n}:null,t||(t={default:{operations:{canAdd:!1,canDelete:!1,canRename:!1,canDrag:!1}}}),i=s.apex.treeView.makeDefaultNodeAdapter(r,t,o),function(){return i}},_renderNode:function(e,t,i){var s,r,a,d,h,p,u,_,b=!1,w=this.options,y=this.nodeAdapter;r=this.nextNodeId,this.treeMap[r]=e,y.setViewId&&y.setViewId(this.baseId,e,r),this.nextNodeId+=1,a=n+" ",null===(s=y.hasChildren(e))&&(s=!0),s?(p=!1,y.isExpanded&&(p=y.isExpanded(this.baseId,e)),a+=p?m:g):a+=v,(h=0===r&&w.showRoot&&!w.collapsibleRoot)&&(a+=" a-TreeView--noCollapse"),1===t&&(a+=" a-TreeView-node--topLevel"),d=l,y.isDisabled&&y.isDisabled(e)&&(d+=" "+f,b=!0),u=o,i.markup("<li").attr("id",this.baseId+r).attr("class",a).markup(">"),y.getClasses&&(_=y.getClasses(e))&&(d+=" "+_,u+=" "+_),i.markup("<div").attr("class",u).markup("></div>"),s&&!h&&i.markup("<span class='"+c+"'></span>"),i.markup("<div").attr("class",d).markup(">"),V(i,e,y,this.renderNodeOptions,{level:t,selected:!1,disabled:b,hasChildren:s,expanded:p}),i.markup("</div>"),p&&(i.markup("<ul role='group'>"),this._renderChildren(e,t+1,i),i.markup("</ul>")),i.markup("</li>")},_renderChildren:function(e,i,s,n,r){var o,a=this,l=this.nodeAdapter;function d(){var t;for(t=0;t<o;t++)a._renderNode(l.child(e,t),i,s);n&&n(!0)}null===(o=l.childCount(e))?n&&(t.delayLinger.start(r[0].id,(function(){r.addClass("is-processing")})),l.fetchChildNodes(e,(function(i){if(t.delayLinger.finish(r[0].id,(function(){r.removeClass("is-processing"),0===i&&n(i)})),i){if((o=l.childCount(e))>0)return void d();i=0}!1===i&&n(i)}))):o>0?d():n&&n(0)},_getRoots:function(){return this.element.children("ul").children("li")},_find:function(e,t,i,n){var r,o,a,l=this,h=[];return e?(a=e.parent(),this._addChildrenIfNeeded(a),o=a.children("ul").children("li")):o=this._getRoots(),o.each((function(){if(r=l.treeMap[T(s(this))],t(r)&&(h.push(s(this).children(d)[0]),!n))return!1})),(n||0===h.length)&&(i>1||-1===i)&&o.each((function(){if((h=h.concat(l._find(s(this).children(d),t,-1===i?i:i-1,n))).length>0&&!n)return!1})),h},_makeParentIfNeeded:function(e){e&&0===e.prev(".a-TreeView-toggle").length&&(e.parent().removeClass(v).addClass(g),e.before("<span class='"+c+"'></span>"),e.after("<ul role='group'></ul>"),e.parent().children("ul").hide())},_makeLeafIfNeeded:function(e){var t=this,i=this.nodeAdapter;e.each((function(){var e,n,r=s(this);0===r.next("ul").find("li").length&&((n=r.parent()).hasClass(m)&&i.setExpanded&&(e=t.treeMap[T(n)],i.setExpanded(t.baseId,e,!1)),r.parent().removeClass(g+" "+m).addClass(v),r.find(t.labelSelector).removeAttr(_),r.prev(".a-TreeView-toggle").remove(),r.next("ul").remove())}))},_addChildrenIfNeeded:function(e){var i,s=this.treeMap[T(e)];e.children("ul").length>0||e.hasClass(v)||((i=t.htmlBuilder()).markup("<ul role='group'>"),this._renderChildren(s,k(e,this.labelSelector)+1,i),i.markup("</ul>"),e.append(i.toString()).children("ul").hide())},_toggleNode:function(e){e.hasClass(g)?this._expandNode(e):this._collapseNode(e)},_persistExpansionState:function(e,t,i){var s=this.nodeAdapter;s.setExpanded&&s.setExpanded(this.baseId,e,i),this._trigger("expansionStateChange",{},{node:e,nodeContent$:t.children(d),expanded:i})},_expandNode:function(e,i){var n,r,o=this,a=this.nodeAdapter,l=this.treeMap[T(e)];this.options.autoCollapse&&e.parent().children("."+m).each((function(){o._collapseNode(s(this))})),e.removeClass(g),(n=e.children("ul")).length>0&&null!==a.childCount(l)?(n.show(),e.addClass(m).children(d).find(this.labelSelector).attr(_,y),this._persistExpansionState(l,e,!0),i&&i()):(n.remove(),(r=t.htmlBuilder()).markup("<ul role='group'>"),this._renderChildren(l,k(e,this.labelSelector)+1,r,(function(t){t?(e.addClass(m).children(d).find(o.labelSelector).attr(_,y),r.markup("</ul>"),e.append(r.toString()),o._persistExpansionState(l,e,!0)):0===t?(e.children(".a-TreeView-toggle").remove(),e.addClass(v).children(d).find(o.labelSelector).removeAttr(_)):(e.addClass(g).children(d).find(o.labelSelector).attr(_,"false"),o._persistExpansionState(l,e,!1)),i&&i()}),e))},_collapseNode:function(e){var t=this.options;t.showRoot&&!t.collapsibleRoot&&e.parent().parent().hasClass("a-TreeView")||(e.removeClass(m).addClass(g).children(d).find(this.labelSelector).attr(_,"false"),e.find(".is-selected").length>0&&this._select(e.children(d),null,!0),e.children("ul").hide(),this._persistExpansionState(this.treeMap[T(e)],e,!1))},_traverseDown:function(e,t){var i,n,o;if(this.lastFocused){for(i=s(this.lastFocused).closest(r),o=0;o<t&&0!==(n=R(i)).length;o++)i=n;i.length>0&&this._select(i.children(d),e,!0,!0)}},_traverseUp:function(e,t){var i,n,o;if(this.lastFocused){for(i=s(this.lastFocused).closest(r),o=0;o<t&&0!==(n=L(i)).length;o++)i=n;i.length>0&&this._select(i.children(d),e,!0,!0)}},_activate:function(e){var t,i,s=this.options,n=this.nodeAdapter,r=this.getSelectedNodes();0!==r.length&&(this._trigger("activateNode",e,{nodes:r}),s.navigation&&n.getLink&&!e.isDefaultPrevented()&&(t=n.getLink(r[0]))&&((i=n.getLinkTarget&&n.getLinkTarget(r[0]))?apex.navigation.openInNewWindow(t,i,{favorTabbedBrowsing:!0,noopener:!0}):apex.navigation.redirect(t)))},_select:function(e,i,n,o,l){var h,c,u,m,v,_,w,x,C=e,I="set",N=this,S=this.element,T=S.find(d+".is-selected");if(i&&this.options.multiple&&("click"===i.type?i.ctrlKey||i.metaKey?I="toggle":i.shiftKey&&(I="range"):"keydown"===i.type&&(i.keyCode===s.ui.keyCode.SPACE?I=i.ctrlKey?"toggle":i.shiftKey?"range":"add":i.ctrlKey?I="none":i.shiftKey&&(I="range"))),"range"!==I||this.selectAnchor||(I="set"),"set"!==I&&"range"!==I||(T.prevAll(a).addBack().find(".u-selector").addBack().removeClass(p),T.find(this.labelSelector).attr(b,"false")),c=e.eq(0).find(this.labelSelector),m=(e=e.not(".is-disabled")).hasClass(p),"set"===I||"add"===I||"toggle"===I&&!m)e.prevAll(a).addBack().find(".u-selector").addBack().addClass(p),e.find(this.labelSelector).attr(b,y),e.parent().parents(r).each((function(){(h=s(this)).hasClass(g)&&N._expandNode(h)})),this.selectAnchor=e[0];else if("range"===I){for(u=s("#"+this.selectAnchor.parentNode.id+", #"+C[0].parentNode.id),h=u.first();h.children(d).hasClass(f)||(h.children(d).prevAll(a).addBack().find(".u-selector").addBack().addClass(p),h.children(d).find(this.labelSelector).attr(b,y)),0!==(h=R(h)).length&&1!==u.length&&h[0]!==u[1];);h.length>0&&2===u.length&&!h.children(d).hasClass(f)&&(h.children(d).prevAll(a).addBack().find(".u-selector").addBack().addClass(p),h.children(d).find(this.labelSelector).attr(b,y))}else"toggle"===I&&m&&(e.prevAll(a).addBack().find(".u-selector").addBack().removeClass(p),e.find(this.labelSelector).attr(b,"false"),this.selectAnchor=e[0]);c.length&&(n?M(c[0]):this._setFocusable(c),this.scrollParent&&(v=this.scrollParent[0],(x=c.parent().offset())&&(w=S.offset(),v===document?(_={top:s(document).scrollTop(),left:s(document).scrollLeft()},(x.top<_.top||x.top>_.top+s(window).height())&&s(document).scrollTop(x.top-w.top),(x.left+c.parent()[0].offsetWidth<_.left||x.left>_.left+s(window).width())&&s(document).scrollLeft(x.left-w.left)):(_=this.scrollParent.offset(),w=S.offset(),(x.top<_.top||x.top>_.top+v.offsetHeight)&&(v.scrollTop=x.top-w.top),(x.left+c.parent()[0].offsetWidth<_.left||x.left>_.left+v.offsetWidth)&&(v.scrollLeft=x.left-w.left))))),l||("toggle"===I||"range"===I&&!m||"add"===I&&!m||"set"===I&&!t.arrayEqual(T,e))&&(o?O(N,i):D(N,i))},_setFocusable:function(e){var t=e[0];t&&(this.lastFocused&&this.lastFocused!==t&&(this.lastFocused.tabIndex=-1),t.tabIndex=0,this.lastFocused=t)},_beginEdit:function(e){this.editMode=!0,apex.tooltipManager&&apex.tooltipManager.disableTooltips(),this._trigger("beginEdit",{},e)},_endEdit:function(e){this.editMode=!1,apex.tooltipManager&&apex.tooltipManager.enableTooltips(),this._trigger("endEdit",{},e)},_mouseCapture:function(e,t){var i,n,o,a=!0,l=this.options;if(e.preventDefault(),this.animating||l.disabled||!l.dragAndDrop||s(e.target).hasClass(c))return!1;if(0===(n=s(e.target).closest(r).children(d)).length)return!1;if(l.dragMultiple&&(n.hasClass(p)?n=this.getSelection():e.ctrlKey&&(n=n.add(this.getSelection()))),!0!==t){for(o=this.getNodes(n),i=0;i<o.length;i++)if(!this.nodeAdapter.allowDrag||!this.nodeAdapter.allowDrag(o[i])){a=!1;break}if(!a)return!1}return this.dragItems=n,!0},_mouseStart:function(e,t,i){var n,r,o=null,a=this.options,l=this;return i||(s("body").on("keydown.treeview",(function(e){e.keyCode!==s.ui.keyCode.ESCAPE?l._dragCopyOrMove(e,!0):l._cancel(e)})),s("body").on("keyup.treeview",(function(e){l._dragCopyOrMove(e,!0)})),this._select(this.dragItems,null,!0,!1)),this.helper||(this.helper=this._createHelper(t)),this.margins={left:parseInt(this.dragItems.css("marginLeft"),10)||0,top:parseInt(this.dragItems.css("marginTop"),10)||0},this.offset=this.dragItems.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},s.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset()}),this.helper.css("position","absolute"),this._cacheHelperProportions(),s.ui.ddmanager&&!i&&(this.currentItem=this.dragItems.first(),s.ui.ddmanager.current=this,s.ui.ddmanager.prepareOffsets(this,e)),this.originalPosition=this._generatePosition(t),a.dragCursorAt&&this._adjustOffsetFromHelper(a.dragCursorAt),this.dragItems&&this.dragItems.length>0&&!this.isOver&&((o=this.getNodes(this.dragItems))[0]||(o=null)),this.nodeAdapter.dragOperations?this.dragOperations=this.nodeAdapter.dragOperations(o):this.dragOperations=o?{normal:"move",ctrl:"copy"}:{normal:"add"},this.dragOperation=this.dragOperations.normal,this.dragging=!0,this.lastHover&&(s(this.lastHover).children(h).removeClass("is-hover"),this.lastHover=null),a.dragReorder&&(r=this.dragItems.first().outerHeight(),"move"===this.dragOperation&&this.dragItems.parent().hide(),this._createPlaceholder(r),this.initialPlaceholderPos=null),this._initPositions(),this._refreshPositions(),a.dragContainment&&this._setContainment(),i||a.dragCursor&&"auto"!==a.dragCursor&&(n=this.document.find("body"),this.storedCursor=n.css("cursor"),n.css("cursor",a.dragCursor),this.storedStylesheet=s("<style>*{ cursor: "+a.dragCursor+" !important; }</style>").appendTo(n)),a.dragOpacity&&this.helper.css("opacity",a.dragOpacity),a.dragZIndex&&this.helper.css("zIndex",a.dragZIndex),this.helper.addClass("a-TreeView-dragHelper"),this.scrollParent&&this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset(),this.originalScroll={top:this.scrollParent[0].scrollTop,left:this.scrollParent[0].scrollLeft}),apex.tooltipManager&&apex.tooltipManager.disableTooltips(),this._trigger("start",t,this._uiHashDnD()),this._mouseDrag(t),s.ui.ddmanager&&!i&&s.ui.ddmanager.dragStart(this,t),!0},_mouseDrag:function(e){var t={pageX:e.pageX,pageY:e.pageY};return this.position=this._generatePosition(e),this.positionAbs=this._adjustPositionForScroll(),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.dragEventTarget=e.target,this.options.dragScroll&&(this._scrollCheck(t)?this.scrollTimerId||this._scrollStart(t):this.scrollTimerId&&this._scrollStop()),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",this._dragCopyOrMove(e),this._dragHitCheck(),s.ui.ddmanager&&!this.isOver&&s.ui.ddmanager.drag(this,e),this._trigger("drag",e,this._uiHashDnD()),this.lastPositionAbs=this.positionAbs,!1},_dragHitCheck:function(){var e,t,i,n,r,o,l,h,c,p=this,f=0,u=null,m=this.dropTargetNode?this.dropTargetNode[0].id:null,v=this.options;if(this.scrollParent[0]!==document&&(f=this.scrollParent[0].scrollTop-this.dropPositionsOrigin),(i=this.positionAbs.left+this.offset.click.left)>this.containerCache.left&&i<this.containerCache.left+this.containerCache.width)if(this.placeholder&&s(this.dragEventTarget).closest(".a-TreeView-placeholder").length)null===this.initialPlaceholderPos&&(this.initialPlaceholderPos=i),(h=(i-this.initialPlaceholderPos)*this.rtlFactor)>(this.options.dragScrollSensitivity||10)?(this.initialPlaceholderPos=i,this._movePlaceholder({element:this.placeholder.children(d)},"below")):h<(-this.options.dragScrollSensitivity||-10)&&(this.initialPlaceholderPos=i,this._movePlaceholder({element:this.placeholder.children(d)},"above"));else for(this.initialPlaceholderPos=null,n=this.positionAbs.top+this.offset.click.top+f,e=0;e<this.dropPositions.length;e++)if(n>=(t=this.dropPositions[e]).top&&n<=t.bottom){u=t.nodeId,o=n>t.top+(t.bottom-t.top)/2?"bottom":"top";break}m===u&&o===this.lastLocation||(p.delayExpandTimer&&(clearTimeout(p.delayExpandTimer),p.delayExpandTimer=null),this.element.find(".is-active").removeClass("is-active"),u?(r=s("#"+u),v.dragExpandDelay>=0&&r.hasClass(g)&&(this.delayExpandTimer=setTimeout((function(){p.delayExpandTimer=null,p._expandNode(r,(function(){p._initPositions(r),p._refreshPositions()}))}),v.dragExpandDelay)),t.canAdd?(this.dropTargetNode=r,this.placeholder?(l=0!==(c=p.positionAbs.top-p.lastPositionAbs.top)&&(c>0?"down":"up"),"top"===o&&"up"===l?this._movePlaceholder(t,"before"):"bottom"===o&&"down"===l&&this._movePlaceholder(t,"after")):this.dropTargetNode.children(d+","+a).addClass("is-active")):t.canAddChild&&this.placeholder&&(this.initialPlaceholderPos=i,this._movePlaceholder(t,"after"),this._movePlaceholder({element:this.placeholder.children(d)},"below"))):this.dropTargetNode=null),this.lastLocation=o},_mouseStop:function(e,t){var i,n=this;return this.delayExpandTimer&&(clearTimeout(this.delayExpandTimer),this.delayExpandTimer=null),this._scrollStop(),s.ui.ddmanager&&!t&&s.ui.ddmanager.dragStop(this,e),t||s("body").off(".treeview"),this._deactivate(),this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),s.ui.ddmanager&&!t&&s.ui.ddmanager.drop(this,e)?(this.placeholder&&(this.dragItems.parent().show(),this._removePlaceholder()),this.dragging=!1,this.dragItems=null,this.currentItem=null,this.helper.remove(),this.helper=null,void this._stop(e)):e.target?void(this.options.dragAnimate?(i=this._getAnimation(),this.animating=!0,this.helper.animate(i,parseInt(this.options.dragAnimate,10)||500,(function(){n._finishDrag(e)}))):this._finishDrag(e)):(this.fromOutside=!1,void(this.dragging=!1))},_scrollCheck:function(e,t){var i,n,r,o=0,a=0,l=this.options,d=this.scrollParent[0];return d&&d!==document&&"HTML"!==d.tagName?(this.overflowOffset.top+d.offsetHeight-e.pageY<l.dragScrollSensitivity?o=l.dragScrollSpeed:e.pageY-this.overflowOffset.top<l.dragScrollSensitivity&&(o=-l.dragScrollSpeed),t&&o&&((i=d.scrollTop+o)<0?(d.scrollTop=0,o=0):i>d.scrollHeight-d.clientHeight?(d.scrollTop=d.scrollHeight-d.clientHeight,o=0):d.scrollTop=i),this.overflowOffset.left+d.offsetWidth-e.pageX<l.dragScrollSensitivity?a=l.dragScrollSpeed:e.pageX-this.overflowOffset.left<l.dragScrollSensitivity&&(a=-l.dragScrollSpeed),t&&a&&((n=d.scrollLeft+a)<0?(d.scrollLeft=0,a=0):n>d.scrollWidth-d.clientWidth?(d.scrollLeft=d.scrollWidth-d.clientWidth,a=0):d.scrollLeft=n),r=!(!a&&!o)):(i=s(document).scrollTop(),n=s(document).scrollLeft(),e.pageY-i<l.dragScrollSensitivity?o=-l.dragScrollSpeed:s(window).height()-(e.pageY-i)<l.dragScrollSensitivity&&(o=l.dragScrollSpeed),t&&o&&((i+=o)<0?(s(document).scrollTop(0),o=0):i>s(document).height()-s(window).height()?(s(document).scrollTop(s(document).height()-s(window).height()),o=0):(e.pageY+=o,s(document).scrollTop(i))),e.pageX-n<l.dragScrollSensitivity?a=-l.dragScrollSpeed:s(window).width()-(e.pageX-n)<l.dragScrollSensitivity&&(a=l.dragScrollSpeed),t&&a&&((n+=a)<0?(s(document).scrollLeft(0),a=0):n+this.helper.width()>s(document).width()-s(window).width()?(s(document).scrollLeft(s(document).width()-s(window).width()-this.helper.width()),a=0):(e.pageX+=a,s(document).scrollLeft(n))),(r=!(!a&&!o))&&t&&(this.position=this._generatePosition(e),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",s.ui.ddmanager&&s.ui.ddmanager.prepareOffsets(this,e))),r},_scrollStart:function(e){var t=this,i=0,s=[150,125,100,99,96,91,84,75,64,51,36];this.scrollTimerId&&this._scrollStop(),function n(){t.scrollTimerId=setTimeout((function(){t._scrollCheck(e,!0)?(t._dragHitCheck(),n()):t._scrollStop()}),s[i]),i<s.length-1&&(i+=1)}()},_scrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_getAnimation:function(){var e,t,i={};return this.placeholder||this.dropTargetNode?(e=this.placeholder?(t=this.placeholder).offset():(t=this.dropTargetNode).offset(),i.left=e.left-this.offset.parent.left-this.margins.left,i.top=e.top-this.offset.parent.top-this.margins.top):(t=this.dragItems.eq(0),e=this.originalPosition,i.left=e.left-this.margins.left,i.top=e.top-this.margins.top,this.scrollParent[0]!==document&&(i.left+=this.originalScroll.left-this.scrollParent[0].scrollLeft,i.top+=this.originalScroll.top-this.scrollParent[0].scrollTop)),-1===this.rtlFactor&&(i.left+=t.width()-this.helper.width()),i},_initPositions:function(e){var t,i,n,o,l,d=this,h=[],c=this.options.dragReorder,p=this.nodeAdapter;if(this.dragItems&&this.dragItems.length>0&&(l=this.getNodes(this.dragItems))[0]||(l=[]),e&&this.dropPositions)for(i=[],o=e[0].id,n=0;n<this.dropPositions.length&&o!==this.dropPositions[n].nodeId;n++);else i=this.dropPositions=[],e=this.element;if(e.find(r).each((function(){var e,t,n,o=!1,f=s(this);f.is(":visible")&&!f.is(".a-TreeView-placeholder")&&(e=c?(t=f.parent().closest(r)).length?d.treeMap[T(t)]:d.options.showRoot?null:p.root():d.treeMap[T(f)],c||"move"!==d.dragOperation||!(l.indexOf(e)>=0||h.indexOf(f.parent().closest(r)[0])>=0)?(n=e&&p.allowAdd(e,d.dragOperation,l),c&&(o=p.allowAdd(d.treeMap[T(f)],d.dragOperation,l)),(n||o||f.hasClass(g))&&i.push({canAdd:n,canAddChild:o,element:s(this).children(a),nodeId:this.id,top:0,bottom:0})):h.push(this))})),void 0!==n&&i.length)for(t=0;t<i.length;t++)this.dropPositions.splice(n+t,0,i[t])},_refreshPositions:function(){var e,t,i,s,n;for(e=0;e<this.dropPositions.length;e++)s=(t=this.dropPositions[e]).element.outerHeight(),i=t.element.offset(),t.top=i.top,t.bottom=i.top+s;this.dropPositionsOrigin=0,(n=this.scrollParent)&&n[0]!==document?this.dropPositionsOrigin=n[0].scrollTop:n=this.element,i=n.offset(),this.containerCache.left=i.left,this.containerCache.top=i.top,this.containerCache.width=n.outerWidth(),this.containerCache.height=n.outerHeight()},_makeTempDragItem:function(){var e,i,r,a=t.htmlBuilder();for(a.markup("<li").attr("class",n).markup("><div").attr("class",o).markup("></div><div").attr("class",l).markup(">unseen content</div></li>"),i=s(a.toString()),e=0;e<this.dropPositions.length;e++)if(this.dropPositions[e].canAdd){r=s(this.dropPositions[e].nodeId).parent();break}r||(r=this.element.children("ul")),r.append(i),this.dragItems=i.children(d)},_createPlaceholder:function(e){this.placeholder=s("<li class='"+n+" a-TreeView-placeholder'><div class='"+o+"'></div><div class='"+l+"'>&nbsp;</div></li>"),this.dragItems.first().parent().before(this.placeholder),e&&this.placeholder.height(e)},_movePlaceholder:function(e,t){var i,n,o,a,l,h=this,c=this.placeholder.parent(),p=this.nodeAdapter,f=e.element.parent(),u=f[0];if("after"===t&&f.hasClass(m)&&p.allowAdd(h.treeMap[T(f)],h.dragOperation)&&(u=f.children("ul").children()[0],t="before"),"above"===t){if(f.next(":visible").length)return;if(u=f.parent().parent()[0],l=(n=(f=s(u)).parent().closest(r)).length?h.treeMap[T(n)]:h.options.showRoot?null:p.root(),f.hasClass("a-TreeView")||null===l)return;if(!(o=p.allowAdd(l,h.dragOperation)))return;t="after"}if("below"===t){if(a=!1,(i=f.prevAll(":visible").first()).hasClass(m)&&(i=i.children("ul").children().last(),a=!0),0===i.length)return;if(o=p.allowAdd(h.treeMap[T(i)],h.dragOperation),!a&&i.hasClass(v)&&o&&this._makeParentIfNeeded(i.children(d)),i.hasClass(g))return void this._expandNode(i,(function(){h._initPositions(i),h._refreshPositions(),o&&i.children("ul")[0].appendChild(h.placeholder[0])}));o&&i[0].parentNode.appendChild(this.placeholder[0])}else"after"!==t||u.nextSibling?u.parentNode.insertBefore(this.placeholder[0],"before"===t?u:u.nextSibling):u.parentNode.appendChild(this.placeholder[0]);0===c.children().length&&this._makeLeafIfNeeded(c.parent().find(d)),this._refreshPositions()},_removePlaceholder:function(){var e=this.placeholder.parent();this.placeholder.remove(),this.placeholder=null,0===e.children().length&&this._makeLeafIfNeeded(e.parent().find(d))},_createHelper:function(e){var t,i=this.options;return s.isFunction(i.dragHelper)?t=s(i.dragHelper.apply(this.element[0],[e,this.dragItems])):1===this.dragItems.length?t=this.dragItems.clone().removeAttr("id").removeClass(p):(t=s("<div></div>")).html(this.dragItems.clone().removeClass(p)),t.parents("body").length||t.appendTo("parent"===i.dragAppendTo?this.element[0].parentNode:i.dragAppendTo),/(fixed|absolute)/.test(t.css("position"))||t.css("position","absolute"),t},_adjustOffsetFromHelper:function(e){"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e;return this.offsetParent=this.helper.offsetParent(),e=this.offsetParent[0]===document||this.offsetParent[0]===document.firstElementChild?{left:0,top:0}:this.offsetParent.offset(),this.scrollParent&&this.scrollParent[0]!==document&&s.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&s.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_generatePosition:function(e){var t=e.pageX,i=e.pageY,n=this.scrollParent&&this.scrollParent[0]!==document&&s.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(n[0].tagName);return this.dragging||this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(t=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(i=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(t=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(i=this.containment[3]+this.offset.click.top)),{top:i-this.offset.click.top-this.offset.parent.top+(r?0:n.scrollTop()),left:t-this.offset.click.left-this.offset.parent.left+(r?0:n.scrollLeft())}},_adjustPositionForScroll:function(){var e=this.position,t=this.scrollParent&&this.scrollParent[0]!==document&&s.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(t[0].tagName);return{top:e.top+this.offset.parent.top-(i?0:t.scrollTop()),left:e.left+this.offset.parent.left-(i?0:t.scrollLeft())}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;"parent"===n.dragContainment&&(n.dragContainment=this.helper[0].parentNode),"document"!==n.dragContainment&&"window"!==n.dragContainment||(this.containment=[0-this.offset.parent.left,0-this.offset.parent.top,s("document"===n.dragContainment?document:window).width()-this.helperProportions.width-this.margins.left,(s("document"===n.dragContainment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.dragContainment)||(e=s(n.dragContainment)[0],t=s(n.dragContainment).offset(),i="hidden"!==s(e).css("overflow"),this.containment=[t.left+(parseInt(s(e).css("borderLeftWidth"),10)||0)+(parseInt(s(e).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt(s(e).css("borderTopWidth"),10)||0)+(parseInt(s(e).css("paddingTop"),10)||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(s(e).css("borderLeftWidth"),10)||0)-(parseInt(s(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(s(e).css("borderTopWidth"),10)||0)-(parseInt(s(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_intersectsWith:function(e){var t=this.positionAbs.left,i=this.positionAbs.top,s=e.left,n=s+e.width,r=e.top,o=r+e.height,a=this.offset.click.top,l=this.offset.click.left;return i+a>r&&i+a<o&&(t+l>s&&t+l<n)},_dragCopyOrMove:function(e,t){var i,s;e.ctrlKey?i="ctrl":e.altKey?i="alt":e.shiftKey?i="shift":e.metaKey&&(i="meta"),s=this.dragOperations[i]||this.dragOperations.normal,this.dragOperation!==s&&(this.dragOperation=s,this.placeholder&&this.dragItems.parent().toggle("move"!==s),this._initPositions(),this._refreshPositions(),t&&this._trigger("drag",e,this._uiHashDnD()))},_cancel:function(e,t){var i,n=this;function r(){n.animating=!1,n.helper&&n.helper[0].parentNode&&n.helper.remove(),n.helper=null,n.dragging=!1,n.dragItems=null,n.currentItem=null,n._stop(e)}this.dragging&&(this.positionAbs.top=-99999,this._mouseUp(s.Event("mouseup",{target:null})),this.placeholder&&this.dragItems.parent().show()),this.dropTargetNode=null,this.placeholder&&this._removePlaceholder(),this.options.dragAnimate&&!t?(i=this._getAnimation(),this.animating=!0,this.helper.animate(i,parseInt(this.options.dragAnimate,10)||500,(function(){r()}))):r()},_deactivate:function(){this.element.find(".is-active").removeClass("is-active")},_finishDrag:function(e){var t,s,n,o,a,l=!0,h=this.nodeAdapter;if(this.animating=!1,this.placeholder?(s=this.placeholder.parent().closest(r),this.dragItems.parent().show(),n=S(this.placeholder),"move"===this.dragOperation&&this.dragItems.parent().hide()):(s=this.dropTargetNode,n=0),this.fromOutside){if(this.dragItems.parent().remove(),"add"===this.dragOperation&&h.addNode)try{this.placeholder&&this._removePlaceholder(),this._add(e,s.children(d),n,null,!0)}catch(e){i.error("Error in drop add action.",e)}}else if(("copy"===this.dragOperation||"move"===this.dragOperation)&&h.allowAdd&&h["copy"===this.dragOperation?"copyNodes":"moveNodes"]&&("copy"===this.dragOperation||h.allowDelete))try{if(o=s.length||this.options.showRoot?this.treeMap[T(s)]:h.root(),h.allowAdd(o,this.dragOperation,this.dragItems)&&"move"===this.dragOperation)for(a=this.getNodes(this.dragItems),t=0;t<a.length;t++)if(!h.allowDelete(a[t])){l=!1;break}if(l&&"move"===this.dragOperation)if(this.placeholder){if(this.dragItems.last().closest(r).next()[0]===this.placeholder[0]){for(l=!1,t=0;t<this.dragItems.length-1;t++)if(this.dragItems.eq(t).closest(r).next()[0]!==this.dragItems.eq(t+1).closest(r)[0]){l=!0;break}}else if(this.dragItems.first().closest(r).prev()[0]===this.placeholder[0])for(l=!1,t=1;t<this.dragItems.length;t++)if(this.dragItems.eq(t).closest(r).prev()[0]!==this.dragItems.eq(t-1).closest(r)[0]){l=!0;break}}else for(l=!1,t=0;t<this.dragItems.length;t++)if(this.dragItems.eq(t).closest(r).parent().closest(r)[0]!==s[0]){l=!0;break}l?(this.placeholder&&this._removePlaceholder(),this._moveOrCopy(e,s.children(d),n,this.dragItems,"copy"===this.dragOperation,!0)):this.dragItems.parent().show()}catch(e){this.dragItems.parent().show(),i.error("Error in drop "+this.dragOperation+" action.",e)}this.dragging=!1,this._trigger("beforeStop",e,this._uiHashDnD()),this.dragItems=null,this.currentItem=null,this.placeholder&&this._removePlaceholder(),this.helper.remove(),this.helper=null,this.fromOutside&&this._trigger("deactivate",e,this._uiHashDnD(this)),this._stop(e),this.fromOutside=!1},_stop:function(e){apex.tooltipManager&&apex.tooltipManager.enableTooltips(),this._trigger("stop",e,this._uiHashDnD())},_add:function(e,i,n,r,o){var a,l,h=this,c=this.nodeAdapter;i&&i.length?(a=this.treeMap[T(i.parent())],l=A(i,this.labelSelector)+1):(i=null,a=c.root(),l=1),c.addNode(a,n,null,r,(function(r,c){var p,f,u,g=t.htmlBuilder(),m={parentNode:a,parent$:i,node:r,index:c};function v(){h._select(m.node$,e,o),h._trigger("added",e,m)}if(!(!1===r||null===r||c<0)){if(i){if(h._makeParentIfNeeded(i),0===(f=i.parent().children("ul")).length)return void h._expandNode(i.parent(),(function(){f=i.parent().children("ul"),m.node$=f.children().eq(n).children(d),v()}))}else f=h.element.children("ul");h._renderNode(r,l,g),p=s(g.toString()),m.node$=p.children(d),c>=(u=f.children()).length?f.append(p):u.eq(c).before(p),v()}}))},_moveOrCopy:function(e,i,n,o,a,l){var h,c,p=this,f=this.getNodes(o),u=a?"copyNodes":"moveNodes",g=this.nodeAdapter;i&&i.length?(h=this.treeMap[T(i.parent())],c=A(i,this.labelSelector)+1):(i=null,h=g.root(),c=1),g[u](h,n,f,(function(n){var f,u,m,v,_,b,w,y,x=t.htmlBuilder(),C=[],I=[],N={parentNode:h,parent$:i,items:C};function S(){for(f=0;f<C.length;f++)b=C[f],m=g.child(h,b.toIndex),b.toNode=m,x.clear(),p._renderNode(m,c,x),v=s(x.toString()),b.toNode$=v.children(d),y=w.children(":visible"),b.toIndex>=y.length?w.append(v):y.eq(b.toIndex).before(v),I.push(b.toNode$[0]),a||(_=b.fromNode$.parent().parent().closest(r).children(d),b.fromParent$=_,b.fromIndex=b.fromNode$.parent().parent().children().index(b.fromNode$.parent()),b.fromNode$.parent().remove(),p._makeLeafIfNeeded(_));p._select(s(I),e,l),p._trigger(a?"copied":"moved",e,N)}if(n){for(f=0;f<n.length;f++)(u=n[f])>=0&&C.push({fromNode$:o.eq(f),toIndex:u});if(C.sort((function(e,t){return e.toIndex-t.toIndex})),i)return p._makeParentIfNeeded(i),w=i.parent().children("ul"),void p._expandNode(i.parent(),(function(){S()}));w=p.element.children("ul"),S()}}))},_uiHashDnD:function(e){var t=e||this;return{helper:t.helper,placeholder:t.dropTargetNode||t.placeholder||s([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,items:t.dragItems,operation:t.dragOperation,sender:e?e.element:null}}},apex.widget.contextMenuMixin));var H={root:function(){return this.data},getLabel:function(e){return e.label},getIcon:function(e){var t=this.getType(e),i=null;return e.icon||null===e.icon?i=e.icon:t.icon||null===t.icon?i=t.icon:void 0!==this.types.default.icon&&(i=this.types.default.icon),i},getClasses:function(e){var t=this.getType(e),i=null;return t.classes?i=t.classes:this.types.default.classes&&(i=this.types.default.classes),e.classes&&(i?i+=" "+e.classes:i=e.classes),i},getLink:function(e){return e.link},getLinkTarget:function(e){return e.linkTarget},isDisabled:function(e){var t=this.getType(e),i=!1;return void 0!==e.isDisabled?i=e.isDisabled:void 0!==t.isDisabled?i=t.isDisabled:void 0!==this.types.default.isDisabled&&(i=this.types.default.isDisabled),i},child:function(e,t){if(e.children)return e.children[t]},childCount:function(e){return e.children?e.children.length:0},hasChildren:function(e){return!!e.children&&e.children.length>0},allowAdd:function(e,t,i){var s,n,r=this.getType(e),o=!!e.children&&this.check("canAdd",e,t,i);if(o&&i&&(void 0!==r.validChildren?n=r.validChildren:void 0!==this.types.default.validChildren&&(n=this.types.default.validChildren),!0!==n))for(s=0;s<i.length;s++)if(n.indexOf(i[s].type)<0){o=!1;break}return o},allowRename:function(e){return this.check("canRename",e)},allowDelete:function(e){return e!==this.data&&this.check("canDelete",e)},allowDrag:function(e){return this.check("canDrag",e)},dragOperations:function(e){var t,i,s;if(e){if(e.length>0){for(s=e[0].type||"default",t=1;t<e.length;t++)if(e[t].type!==s){s="default";break}}else s="default";i=this.types[s].operations&&void 0!==this.types[s].operations.drag?this.types[s].operations.drag:this.types.default.operations.drag}else i=this.types.default.operations.externalDrag;return i},addNode:function(e,t,i,n,r){var o,a=s.extend(!0,{},n||this.newNode(e));i&&(a.label=i),this.sortCompare?e.children.push(a):e.children.splice(t,0,a),a._parent=e,void 0!==this._nextId&&(void 0===a.id?a.id=this.nextId():this._nextId+=1),this.sortCompare&&e.children.sort(this.sortCompare),o=e.children.indexOf(a),this.validateAdd(a,o,(function(t){"string"==typeof t||!1===t?(e.children.splice(o,1),r(!1===t&&null)):t&&r(a,o)}))},renameNode:function(e,t,i){var s,n=e.label;e.label=t,e._parent?(this.sortCompare&&e._parent.children.sort(this.sortCompare),s=e._parent.children.indexOf(e)):s=0,this.validateRename(e,s,(function(t){"string"==typeof t||!1===t?(e.label=n,i(!1===t&&null)):t&&i(e,s)}))},deleteNode:function(e,t,i){var s=e._parent,n=e._parent.children.indexOf(e);s.children.splice(n,1),delete e._parent,this.validateDelete(e,i,(function(i){i||(e._parent=s,s.children.splice(n,0,e)),t(i)}))},moveNodes:function(e,t,i,s){var n,r,o,a,l=[];for(n=0;n<i.length;n++)a=(o=(r=i[n])._parent).children.indexOf(r),o.children.splice(a,1),e===o&&a<t&&(t-=1),this.sortCompare?e.children.push(r):(e.children.splice(t,0,r),t+=1),r._parent=e;for(this.sortCompare&&e.children.sort(this.sortCompare),n=0;n<i.length;n++)l[n]=e.children.indexOf(i[n]);this.validateMove(e,i,l,(function(e){s(!!e&&l)}))},copyNodes:function(e,t,i,n){var r,o,a=this,l=[],d=[];function h(e,t){var i,n=s.extend({},e);if(n._parent=t,void 0!==a._nextId&&(n.id=a.nextId()),e.children)for(n.children=[],i=0;i<e.children.length;i++)n.children.push(h(e.children[i],n));return n}for(r=0;r<i.length;r++)o=h(i[r],e),l[r]=o,this.sortCompare?e.children.push(o):(e.children.splice(t,0,o),d[r]=t,t+=1);if(this.sortCompare)for(e.children.sort(this.sortCompare),r=0;r<l.length;r++)d[r]=e.children.indexOf(l[r]);this.validateCopy(e,l,d,(function(e){n(!!e&&d)}))},sortCompare:function(e,t){return e.label>t.label?1:e.label<t.label?-1:0},nextId:function(){var e=this._nextId;return this._nextId+=1,"tn"+e},newNode:function(e){var t,i={},n=!0,r=this.getType(e);return void 0!==this._nextId&&(i.id=this.nextId()),s.isArray(r.validChildren)?(i.type=r.validChildren[0],(t=this.types[i.type])&&t.operations&&void 0!==t.operations.canAdd?n=r.operations.canAdd:void 0!==this.types.default.operations.canAdd&&(n=this.types.default.operations.canAdd),t&&void 0!==t.defaultLabel?i.label=t.defaultLabel:void 0!==this.types.default.defaultLabel&&(i.label=this.types.default.defaultLabel)):void 0!==this.types.default.defaultLabel&&(i.label=this.types.default.defaultLabel),n&&(i.children=[]),i},extraCheck:function(e,t,i,s,n){return e},validateAdd:function(e,t,i){i(!0)},validateRename:function(e,t,i){i(!0)},validateDelete:function(e,t,i){i(!0)},validateMove:function(e,t,i,s){s(!0)},validateCopy:function(e,t,i,s){s(!0)},getType:function(e){var t="default";return e.type&&(t=e.type),this.types[t]||this.types.default},check:function(e,t,i,n){var r=!1,o=this.getType(t);return t.operations&&void 0!==t.operations[e]?r=t.operations[e]:o.operations&&void 0!==o.operations[e]?r=o.operations[e]:void 0!==this.types.default.operations[e]&&(r=this.types.default.operations[e]),s.isFunction(r)&&(r=r.call(this,t,i,n)),this.extraCheck(r,e,t,i,n)}};if(s.apex.treeView.makeDefaultNodeAdapter=function(e,t,i,n){var r=Object.create(H);return s.isArray(i)&&(n=i,i=!0),null==i&&(i=!0),i&&(s.apex.treeView.addViewStateMixin(r,"id",n),r._nextId=1),r.data=e,r.types=s.extend(!0,{},{default:{isDisabled:!1,validChildren:!0,operations:{canAdd:!0,canRename:!0,canDelete:!0,canDrag:!0,drag:{normal:"move",ctrl:"copy"},externalDrag:{normal:"add"}}}},t),r.data&&function e(t,s){var n;if(t._parent=s,i&&(r._nextId+=1),t.children)for(n=0;n<t.children.length;n++)e(t.children[n],t)}(r.data,null),r},s.apex.treeView.makeModelNodeAdapter=function(e,t,i){var n,r;if(!apex.model)throw new Error("Missing module apex.model");return t.shape="tree",n=apex.model.create(e,t,i),r=t.labelField||"label",n._labelKey=n.getFieldKey(r),n._iconKey=n.getFieldKey(t.iconField||"icon"),n._classesKey=n.getFieldKey(t.classesField||"classes"),n._linkKey=n.getFieldKey(t.linkField||"link"),n._linkTargetKey=n.getFieldKey(t.linkTargetField||"linkTarget"),n._disabledKey=n.getFieldKey(t.disabledField||"isDisabled"),t.hasIdentity&&s.apex.treeView.addViewStateMixin(n,(function(e){return n.getRecordId(e)}),t.initialExpandedNodeIds),n.getType=n._getType,n.getLabel=function(e){return e[this._labelKey]},n.getIcon=function(e){var t=this.getType(e),i=this._options,s=null;return this._iconKey&&(e[this._iconKey]||null===e[this._iconKey])?s=e[this._iconKey]:t.icon||null===t.icon?s=t.icon:void 0!==i.types.default.icon&&(s=i.types.default.icon),s},n.getClasses=function(e){var t=this.getType(e),i=this._options,s=null;return t.classes?s=t.classes:i.types.default.classes&&(s=i.types.default.classes),this._classesKey&&e[this._classesKey]&&(s?s+=" "+e[this._classesKey]:s=e[this._classesKey]),s},n.getLink=function(e){return this._linkKey?e[this._linkKey]:null},n.getLinkTarget=function(e){return this._linkTargetKey?e[this._linkTargetKey]:null},n.isDisabled=function(e){var t=this.getType(e),i=this._options,s=!1;return this._disabledKey&&void 0!==e[this._disabledKey]?s=e[this._disabledKey]:void 0!==t.isDisabled?s=t.isDisabled:void 0!==i.types.default.isDisabled&&(s=i.types.default.isDisabled),s},n.allowRename=n.allowEdit,n.addNode=function(e,t,i,s,n){var r,o,a=null,l=this._initRecord(s,null,e);r=e[this._childrenKey],t>=0&&t<r.length&&(a=r[t]),i&&(l[this._labelKey]=i),o=this.insertNewRecord(e,a,l),n(l=this.getRecord(o),r.indexOf(l))},n.renameNode=function(e,t,i){var s;this.setValue(e,r,t),i(e,(s=this.parent(e))?s[this._childrenKey].indexOf(e):0)},n.deleteNode=function(e,t,i){t(1===this.deleteRecords([e]))},n.moveNodes=function(e,t,i,s){var n,r,o,a,l=null;for(o=e[this._childrenKey],(t-=1)>=0&&t<o.length&&(l=o[t]),a=this.moveRecords(i,e,l),n=0;n<a.length;n++)r=this.getRecord(a[n]),(void 0)[n]=o.indexOf(r);s(void 0)},n.copyNodes=function(e,t,i,s){var n,r,o,a,l=null;for(o=e[this._childrenKey],(t-=1)>=0&&t<o.length&&(l=o[t]),a=this.copyRecords(i,e,l),n=0;n<a.length;n++)r=this.getRecord(a[n]),(void 0)[n]=o.indexOf(r);s(void 0)},n},s.apex.treeView.treeModelListener=function(e,t){var i,n=t.data("apex-treeView"),r=n.getNodeAdapter();if((i=n.option("treeModel"))&&(i.unSubscribe(n.option("modelViewId")),n.option("modelName")!==e&&apex.model.release(this.modelName),n.option("treeModel",null),n.option("modelName",null),n.option("modelViewId",null)),e){if(n.option("treeModel",e),i=apex.model.get(e),n.option("modelName",i),!i)throw new Error("TreeView model not found: "+e);n.option("modelViewId",i.subscribe({onChange:function(e,t){var i,o;function a(e){var t,i,o=[];for(t=0;t<e.length;t++)i=r.getViewId(n.baseId,e[t]),o.push(s("#"+n.baseId+i).children(d)[0]);return s(o)}if("refresh"===e)n.refresh();else if("refreshRecords"===e||"revert"===e);else if("move"===e);else if("copy"===e);else if("insert"===e)o=a([r.parent(t.record)]),n.refresh(o);else if("clearChanges"===e);else if("delete"===e){for(o=a(t.records),i=0;i<t.records.length;i++)r.clearViewId(n.baseId,t.records[i]);n.deleteTreeNodes(o)}else"set"!==e&&"metaChange"!==e||(o=a([t.record]),n.update(o))},progressView:this.element})),i.getOption("onlyMarkForDelete")}},s.apex.treeView.addViewStateMixin=function(e,t,i){s.extend(e,{_state:{},isExpanded:function(e,t){return this._getExpandedNodes(e)[this._getIdentity(t)]||!1},setExpanded:function(e,t,i){this._getExpandedNodes(e)[this._getIdentity(t)]=i},getExpandedNodeIds:function(e){var t,i=[],s=this._getExpandedNodes(e);for(t in s)s.hasOwnProperty(t)&&!0===s[t]&&i.push(t);return i},getExpandedState:function(e){var t=this._getExpandedNodes(e);return s.extend({},t)},getViewId:function(e,t){var i=this._state[e]&&this._state[e].nodeMap;return i&&i[this._getIdentity(t)]},setViewId:function(e,t,i){var s=this._state[e]&&this._state[e].nodeMap;s||(s={},this._state[e]||(this._state[e]={}),this._state[e].nodeMap=s),s[this._getIdentity(t)]=i},clearViewId:function(e,t){var i=this._state[e]&&this._state[e].nodeMap,s=this._state[e]&&this._state[e].expandedNodes;i&&(t?(delete i[this._getIdentity(t)],s&&delete s[this._getIdentity(t)]):(this._state[e].nodeMap={},delete this._state[e].expandedNodes))},_getExpandedNodes:function(e){var t,s=this._state[e]&&this._state[e].expandedNodes;if(!s&&(this._state[e]||(this._state[e]={}),s={},this._state[e].expandedNodes=s,i))for(t=0;t<i.length;t++)s[i[t]]=!0;return s}}),e._getIdentity||(e._getIdentity=s.isFunction(t)?t:function(e){return e[t]})},s.ui.draggable&&(s.ui.plugin.add("draggable","connectToTreeView",{start:function(e,t){var n=s(this).data("ui-draggable"),r=n.options,o=s.extend({},t,{item:n.element});s("body").on("keydown.treeviewplug",(function(e){e.keyCode===s.ui.keyCode.ESCAPE&&(n.dropped=!1,n.cancel())})),n.trees=[],s(r.connectToTreeView).each((function(){var t=s.data(this,"apex-treeView");t&&!t.options.disabled&&t.options.dragAndDrop?(n.trees.push({instance:t}),t._initPositions(),t._refreshPositions(),t._trigger("activate",e,o)):i.warn("Draggable connectToTreeView matches an element that is not a treeView, is disabled, or doesn't support drag and drop.")}))},stop:function(e,t){var i=s(this).data("ui-draggable");s("body").off(".treeviewplug"),s.each(i.trees,(function(){this.instance.isOver&&!this.invalid?(this.instance.isOver=!1,i.cancelHelperRemoval=!0,this.instance._mouseStop(e,!0),e.target||(this.instance._trigger("deactivate",e,this.instance._uiHashDnD(this.instance)),this.instance.dragItems.parent().remove(),this.instance._cancel(e,!0))):(this.instance._deactivate(),this.instance._trigger("deactivate",e,this.instance._uiHashDnD(this.instance)),this.instance.dragItems&&(this.instance.dragItems.parent().remove(),this.instance._cancel(e,!0)))}))},drag:function(e,t){var i=s(this).data("ui-draggable");s.each(i.trees,(function(){var s=!1;if(!this.invalid)if(this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0),s){if(!this.instance.isOver){if(this.instance.isOver=!0,this.instance._makeTempDragItem(),this.instance.helper=t.helper,this.instance.helper.css("position","relative"),e.target=this.instance.dragItems.parent().children(a)[0],!this.instance._mouseCapture(e,!0))return this.instance.isOver=!1,void(this.invalid=!0);this.instance._trigger("over",e,this.instance._uiHashDnD(this.instance)),this.instance._mouseStart(e,e,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i}this.instance.dragItems&&this.instance._mouseDrag(e)}else this.instance.isOver&&(this.instance.isOver=!1,this.instance._trigger("out",e,this.instance._uiHashDnD(this.instance)),e.target=null,this.instance._mouseStop(e,!0),this.instance.dragItems.parent().remove(),this.instance.placeholder&&this.instance._removePlaceholder(),i.dropped=!1)}))}}),s.ui.plugin.add("draggable","cursor2",{start:function(){var e=s("body"),t=s(this).data("ui-draggable"),i=t.options;i.cursor2&&"auto"!==i.cursor2&&(t.storedCursor=e.css("cursor"),e.css("cursor",i.cursor2),t.storedStylesheet=s("<style>*{ cursor: "+i.cursor2+" !important; }</style>").appendTo(e))},stop:function(){var e=s(this).data("ui-draggable");e.storedCursor&&(s("body").css("cursor",e.storedCursor),e.storedStylesheet.remove())}})),apex.widget){var $={default:{operations:{canAdd:!1,canDelete:!1,canRename:!1,canDrag:!1}}};apex.widget.tree={init:function(i,n,r,o){var a=s("#"+t.escapeCSS(i),apex.gPageContext$);function l(t,i,s,n){e.plugin(i,{pageItems:s},{dataType:"json",refreshObject:t,loadingIndicator:t,loadingIndicatorPosition:"centered",success:function(e){n(e)}})}function d(e,t,i,n){l(e,i,n,(function(i){var n=i.data||{},r=i.showRoot||!1,o=i.navigation||!1,a=i.hasIdentity||!0,l=s.extend(!0,{},$),d=t.initialSelectedNodeId,c=t.nodeHasTooltip;t.defaultIcon&&(l.default.icon=t.defaultIcon),t=s.extend({getNodeAdapter:function(){return(t.makeNodeAdapter||s.apex.treeView.makeDefaultNodeAdapter)(n,l,a)},tooltip:c?{show:apex.tooltipManager.defaultShowOption(),content:function(e,t){return t?t.tooltip:null}}:null,navigation:o,showRoot:r},t),e.treeView(t),h(e,d)}))}function h(e,t){var i;Array.isArray(t)&&t.length>0?e.treeView("setSelectedNodes",t,!1,!0):(i=e.treeView("find",{depth:-1,findAll:!1,match:function(e){return e.id===t}})).length>0&&e.treeView("setSelection",i)}o.regionStaticId&&o.lazyLoading?setTimeout((function(){!function(e){var t,i,s=!0,n=e&&e.closest("div.apex-tabs-region").length>0;e&&(s=e.is(":visible"));n&&(t=apex.region(e.closest("div.apex-tabs-region").attr("id")).widget())&&(i=t.aTabs("getActive").el$,0===e.parents("#"+i.attr("id")).length&&(s=!1));return s}(a)?apex.widget.util.onVisibilityChange(a[0],(function(e){e&&(d(a,o,o.ajaxIdentifier,o.itemsToSubmit),apex.widget.util.offVisibilityChange(a[0]))})):d(a,o,o.ajaxIdentifier,o.itemsToSubmit)}),0):function(e,t,i,n){var r=s.extend(!0,{},$),o=t.initialSelectedNodeId,a=t.nodeHasTooltip;t.defaultIcon&&(r.default.icon=t.defaultIcon);t=s.extend({getNodeAdapter:function(){return(t.makeNodeAdapter||s.apex.treeView.makeDefaultNodeAdapter)(i,r,n)},tooltip:a?{show:apex.tooltipManager.defaultShowOption(),content:function(e,t){return t?t.tooltip:null}}:null,navigation:!0},t),e.treeView(t),h(e,o)}(a,o,n,r),o.regionStaticId&&apex.region.create(o.regionStaticId,{type:"Tree",widgetName:"treeView",refresh:function(){var e,t,i;e=a,t=o.ajaxIdentifier,i=o.itemsToSubmit,l(e,t,i,(function(t){var i,n=t.data||{},r=t.showRoot||!1,o=t.navigation||!1,a=t.hasIdentity||!0,l=e.treeView("getNodeAdapter"),d=function(e){return e.treeView("getSelectedNodes")}(e);l.getExpandedState?i=e.treeView("getExpandedNodeIds"):s.apex.treeView.addViewStateMixin(l,a,d),l.data=n,e.treeView("getNodeAdapter",(function(){return l})),e.treeView("option","showRoot",r),e.treeView("option","navigation",o),e.treeView("refresh"),function(e,t){var i;if(t)for(var s=0;s<t.length;s++)(i=e.treeView("find",{depth:-1,findAll:!1,match:function(e){return e.id===t[s]}})).length>0&&e.treeView("expand",i)}(e,i),h(e,d)}))},focus:function(){a.treeView("focus")},widget:function(){return a}})},expand_all:function(e){s("#"+t.escapeCSS(e),apex.gPageContext$).treeView("expandAll")},collapse_all:function(e){s("#"+t.escapeCSS(e),apex.gPageContext$).treeView("collapseAll")},reset:function(e){var i=s("#"+t.escapeCSS(e),apex.gPageContext$);i.treeView("collapseAll").treeView("expand",i.children().children("li").first())}}}}(apex.server,apex.util,apex.debug,apex.jQuery);