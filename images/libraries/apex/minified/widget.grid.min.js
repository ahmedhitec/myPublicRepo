!function(e,t,s,a,l,i,o,n){"use strict";var r=".a-GV-table",d=".a-GV-header,.a-GV-headerGroup,.a-GV-cell,.a-GV-controlBreakHeader",h="a-GV-controlBreak",c="a-GV-controlBreakHeader",u="is-selected",f="is-focused",p="is-active",m="aria-multiselectable",g="aria-readonly",C="none",b="label",v="true",_=n.ui.keyCode,w=0,G=e.invokeAfterPaint,H="wheel";"onwheel"in document.body||(H=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll");var I={begin:function(e,t,s){1===s.length&&t.records&&1===t.records.length?this.text="":(this.table=!0,this.text="<table><tbody>")},beginRow:function(){this.table&&(this.text+="<tr>")},cell:function(t,s,a,l){this.table?this.text+="<td>"+e.escapeHTML(l)+"</td>":this.text+=e.escapeHTML(l)},endRow:function(){this.table&&(this.text+="</tr>")},end:function(){this.table&&(this.text+="</tbody></table>")},toString:function(){return this.text}};function x(e,t){var s="";return"start"===e?s=" u-tS":"end"===e?s=" u-tE":"left"===e?s=" u-tL":"right"===e?s=" u-tR":"center"!==e||t||(s=" u-tC"),s}function V(e,t,s){var a;return e.highlight&&((a=t.highlights[e.highlight])&&a.cssClass?s+=" "+a.cssClass:s+=" "+e.highlight),s}function $(e,t,s,a,l){var i="a-GV-row";return e.agg?(i+=" is-aggregate",i+=" a-GV-aggregate--"+e.agg,e.grandTotal&&(i+=" is-grandTotal")):((e.sel||s)&&(i+=" "+u),e.deleted?i+=" is-deleted":(e.inserted?i+=" is-inserted":e.updated&&(i+=" is-updated"),e.error?i+=" is-error":e.warning&&(i+=" is-warning"),i=V(e,t,i),a.allowEdit(l)||(i+=" is-readonly"))),i}function y(e,t,s,a,l,i,o){var n=!1,r="a-GV-cell";return r+=x(e.alignment),e.columnCssClasses&&(r+=" "+e.columnCssClasses),e.cellCssClassesColumn&&(r+=" "+i.getValue(o,e.cellCssClassesColumn)),l&&(l.hasClass(u)&&(r+=" "+u),l.hasClass(f)&&(r+=" "+f),l.hasClass(p)&&(r+=" "+p)),s&&(t.deleted||(s.error?r+=" is-error":s.warning?r+=" is-warning":s.changed?r+=" is-changed":s.stale&&(r+=" is-stale")),r=V(s,a,r),s.disabled&&(r+=" is-disabled"),n=s.ck),(n||e.readonly)&&(r+=" is-readonly"),e.usedAsRowHeader&&!t.agg&&(r+=" a-GV-rowHeader"),r}function F(e){return a.getMessage("APEX.GV."+e)}function k(e){var t=Array.prototype.slice.call(arguments);return t[0]="APEX.GV."+e,a.formatMessage.apply(a,t)}function D(e,t){return e.offset-t.offset}function R(e){return e.parent().children().index(e)}function S(e){var t=n(e.toString());return t.find("a,button,input,select,textarea").prop("tabIndex",-1),t}function z(e){return n(e).closest(d)}function M(e){return n(e).closest(".a-GV-cell,.a-GV-controlBreakHeader")}function T(e){return n(e).closest(".a-GV-cell")}function E(e,t){var s,a,l=e.children();return l.last().hasClass("a-GV-headerGroup")?(a=0,l.each((function(){if((a+=parseInt(n(this).attr("colspan"),10)||1)>t)return s=n(this),!1}))):s=l.eq(t),s}function W(e){var t;return e.hasClass("a-GV-headerGroup")?(t=0,e.parent().children().each((function(){if(this===e[0])return!1;t+=parseInt(n(this).attr("colspan"),10)||1}))):t=R(e),t}function A(e){n("body").on("keydown.gridGlobalEscape",(function(t){t.which===_.ESCAPE&&(n("body").off("keydown.gridGlobalEscape"),e())}))}function P(){n("body").off("keydown.gridGlobalEscape")}function L(e){var t=e.groupName||null;return t&&e.useGroupFor&&e.useGroupFor.indexOf("heading")<0&&(t=null),t}var O=function(e,t,s){e.element.hasClass("a-GV")&&(e._updateStatus(),t&&e._trigger("selectionChange",s))},N=e.debounce(O,1),B=e.debounce(O,350);n.widget("apex.grid",n.apex.tableModelViewBase,n.extend(!0,{version:"20.2",widgetEventPrefix:"grid",options:{showNullAs:"-",stickyTop:!1,columns:null,columnGroups:null,columnSort:!0,columnSortMultiple:!0,resizeColumns:!0,reorderColumns:!0,collapsibleControlBreaks:!0,aggregateLabels:{},aggregateTooltips:{},tabbableCellContent:"a,button,input",allowEditMode:!0,allowDelete:!0,allowInsert:!0,allowCopy:!0,skipReadonlyCells:!1,rowHeader:C,rowHeaderCheckbox:!1,rowHeaderLabelColumn:null,rowHeaderWidth:null,selectCells:!1,multiple:!1,multipleCells:!0,selectAll:!0,allowSelectHidden:!1,persistSelection:!1,tooltip:{tooltipClass:"a-GV-tooltip"},dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(){this.text=""},beginRow:function(e){e>0&&(this.text+="\r\n")},cell:function(e,t,s,a){e>0&&(this.text+="\t"),this.text+=a},endRow:function(){},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(I)}],constrainNavigation:!0,selectionChange:null,activateColumnHeader:null,activateCell:null,cancelColumnHeader:null,sortChange:null,columnReorder:null,columnResize:null,modeChange:null,pageChange:null},_create:function(){var e=this,t=this.options,a=this.element;s.info("Grid '"+a[0].id+"' created. Model: "+t.modelName),a.addClass("a-GV").attr("role","grid"),t.multiple&&a.attr(m,v),t.editable||a.attr(g,v),this.forwardKey=_.RIGHT,this.backwardKey=_.LEFT,"rtl"===a.css("direction")&&(a.addClass("u-RTL"),this.forwardKey=_.LEFT,this.backwardKey=_.RIGHT),this._enforceOptionConstraints(),this._super(),this.origLabelBy=a.attr("aria-labelledby"),this.idPrefix=a[0].id||"agv_"+w++,this.accContextId=this.idPrefix+"_ctx",this.curRowHeaders="",this.tableFrozenHeader$=null,this.tableHeader$=null,this.tableFrozenData$=null,this.tableData$=null,this.lastEditModeCell=null,this.frozenColumnCount=0,this.controlBreaks=[],this.editMode=!1,this.columns=null,this.columnsStale=!0,this.columnGroups=null,this.lastFrozenColIndex=-1,this.lastFocused=null,this.lastRow$=null,this.focusInHeader=!1,this.lastHoverCell=null,this.lastHoverRow=null,this.lastColIndex=null,this.columnControls$=null,this.scrollTimerId=null,this.deactivateDelayTimer=null,this.lastFloatingPos={},this.allSelected=!1,this.gotoCellPending=null,this._initContextMenu("tr",(function(t){return n(t.target).closest("a").length>0||e.editMode}),(function(t){var s;if((s=T("keydown"===t.type?this.lastFocused:t.target)).length){if(e.options.selectCells){if(!s.hasClass(u))return s}else if(!s.parent().hasClass(u))return s;return!0}return!1}),(function(t){e.options.selectCells?t.selectedRange=e.getSelectedRange():t.selectedRecords=e.getRecords(t.selection)})),this._initModel(t.modelName),this._on(this._eventHandlers),t.allowCopy&&i.addHandler(a[0],(function(t){return!e.editMode&&(e._copy(t),!0)})),this._updateHighlights(),this.refresh(),this._setSelectionMode(),t.disabled&&this._setOption("disabled",t.disabled)},_eventHandlers:{resize:function(e){e.target===this.element[0]&&(this.resize(),e.stopPropagation())},click:function(e){var t,s=this.options,a=n(e.target);if(a.closest("a,button,.a-GV-footer").length)(t=a.closest(".a-GV-header,.a-GV-headerGroup")).length?(this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1)):(t=a.closest(".a-GV-cell,.a-GV-controlBreakHeader")).length&&!this.editMode&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(t,"none",!1,!1),a.focus());else if(!(a.closest(".a-GV-floatingItem").length>0)){if((t=a.closest(".a-GV-selHeader.a-GV-header")).length)return this.focusInHeader=!0,this.lastColIndex=null,void(s.rowHeaderCheckbox&&s.multiple&&s.selectAll&&!s.selectCells?(t.find(".u-selector").attr("aria-checked")===v?this.setSelection(n()):this.selectAll(),this._select(t,e,!0,!1),this._setFocusable(t[0])):this._select(t,e,!0,!1));if((t=a.closest(".a-GV-headerGroup")).length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1),void e.preventDefault();if((t=a.closest(".a-GV-header")).length&&0===a.closest("button").length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(t,e,!0,!1),this._activateColumnHeader(e,t),void e.preventDefault();if((t=a.closest(".a-GV-selHeader")).length)return s.rowHeaderCheckbox&&!s.selectCells&&(e.ctrlKey=!0,e.shiftKey=!1),this.focusInHeader=!1,this.lastColIndex=null,this._select(t,e,!0,!1),void e.preventDefault();(t=a.closest(".a-GV-cell")).length&&(this.focusInHeader=!1,this.lastColIndex=null,t.hasClass(p)||(this._checkInteractWithCellItem(e,a,t),this._select(t,e,!0,!1),e.preventDefault())),(t=a.closest(".a-GV-controlBreakHeader")).length&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(t,e,!0,!1),e.preventDefault())}},dblclick:function(e){var t=this.options,s=n(e.target).closest(".a-GV-cell").not(".a-GV-selHeader");s.length&&(t.editable&&t.allowEditMode?this.editMode||this.setEditMode(!0):this._fireActivate(e,s))},mousedown:function(e){var t,s=n(e.target);0!==e.originalEvent.button||s.closest("a,button,.a-GV-footer").length?this.focusInHeader=s.closest(".a-GV-header,.a-GV-headerGroup").length>0:!s.closest(".a-GV-expandCollapse").length&&this.editMode?(t=s.closest(".a-GV-cell"),this.editMode&&t.length&&!t.hasClass(p)&&this._checkInteractWithCellItem(null,s,t)):e.preventDefault()},keydown:function(e){var t,s,a,l,i,o,r,d,h,u=this,f=this.options,p=null,m=e.which,g=n(e.target);function C(){a.hasClass("a-GV-selHeader")?a.find(".u-selector").click():(u._activateColumnHeader(e,a),e.preventDefault())}function v(e,t){var s,a=null;for(s=e+=t;s>=0&&s<u.columns.length;s+=t)if(!u.columns[s].hidden){a=s;break}return a}if(!(g.closest(".a-GV-footer").length>0)){if(m!==_.PAGE_UP&&m!==_.PAGE_DOWN||(o=this.displayPageSize),m===_.HOME)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,p=this.lastRow$.first(),e.preventDefault());else if(m===_.END)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,p=this.lastRow$.last(),e.preventDefault());else if(m===_.PAGE_DOWN)this.focusInHeader||this.editMode&&!z(this.lastFocused).hasClass("a-GV-selHeader")||e.altKey||(!(p=this._getNextCellDown(M(this.lastFocused),o))&&f.pagination.loadMore&&this.element.find(".js-load").focus(),e.preventDefault());else if(m===_.PAGE_UP)this.focusInHeader||this.editMode&&!z(this.lastFocused).hasClass("a-GV-selHeader")||e.altKey||(p=this._getPrevCellUp(M(this.lastFocused),o,!0),e.preventDefault());else if(m===_.DOWN){if(a=z(this.lastFocused),f.columnSort&&e.altKey&&a.hasClass("a-GV-header"))return void u._sortChange(e,a,"desc");(!this.editMode||this.focusInHeader||a.hasClass("a-GV-selHeader")||a.hasClass(c))&&this.lastFocused&&!e.altKey&&(!(p=this._getNextCellDown(a,1))&&f.pagination.loadMore&&this.element.find(".js-load").focus()[0]&&e.preventDefault(),(p||f.constrainNavigation)&&e.preventDefault()),g.closest(".js-menuButton").length&&e.stopPropagation()}else if(m===_.UP){if(a=z(this.lastFocused),f.columnSort&&e.altKey&&a.hasClass("a-GV-header"))return void u._sortChange(e,a,"asc");(!this.editMode||this.focusInHeader||a.hasClass("a-GV-selHeader")||a.hasClass(c))&&this.lastFocused&&!e.altKey&&(g.hasClass("js-load")?(this.focus(),e.preventDefault()):p=this._getPrevCellUp(a,1),(p||f.constrainNavigation)&&e.preventDefault(),e.stopPropagation())}else if(m===this.backwardKey){if(e.altKey)return;if(a=z(this.lastFocused),(e.ctrlKey||e.shiftKey)&&(a.hasClass("a-GV-header")||a.hasClass("a-GV-headerGroup"))&&(!a.hasClass("a-GV-selHeader")||"sequence"===f.rowHeader||f.rowHeader===b)&&(i=parseInt(a.attr("data-idx"),10),!isNaN(i)||e.ctrlKey||"sequence"===f.rowHeader||f.rowHeader===b))if(i>=0&&(l=this.columns[i]),e.shiftKey&&f.reorderColumns){if(e.preventDefault(),a.hasClass("a-GV-headerGroup"))r=R(a.parent()),i>0&&(this.moveColumnGroup(r,i,i-1),a=n(this.lastFocused).closest(".a-GV-headerGroup"));else if(i=v(i,-1))return void this.moveColumn(l,i)}else if(e.ctrlKey&&f.resizeColumns&&!a.hasClass("a-GV-headerGroup"))return void(l?a.outerWidth()>40&&((h=a.outerWidth()-10)<40&&(h=40),this.setColumnWidth(l,h)):u.rowHeaderWidth>40&&((h=u.rowHeaderWidth-10)<40&&(h=40),u.rowHeaderWidth=h,this._calculateColumnWidths(a,!0)));(!this.editMode||this.focusInHeader||a.hasClass(c))&&this.lastFocused&&(this.lastColIndex=null,(s=this.lastRow$.index(a))>0&&(s-=1,p=this.lastRow$.eq(s)),e.preventDefault())}else if(m===this.forwardKey){if(e.altKey)return;if(a=z(this.lastFocused),(e.ctrlKey||e.shiftKey)&&(a.hasClass("a-GV-header")||a.hasClass("a-GV-headerGroup"))&&(!a.hasClass("a-GV-selHeader")||"sequence"===f.rowHeader||f.rowHeader===b)&&(i=parseInt(a.attr("data-idx"),10),!isNaN(i)||e.ctrlKey||"sequence"===f.rowHeader||f.rowHeader===b))if(i>=0&&(l=this.columns[i]),e.shiftKey&&f.reorderColumns){if(e.preventDefault(),a.hasClass("a-GV-headerGroup"))r=R(a.parent()),i<this.columnGroups[r].length-1&&(this.moveColumnGroup(r,i,i+1),a=n(this.lastFocused).closest(".a-GV-headerGroup"));else if(i=v(i,1))return void this.moveColumn(l,i)}else if(e.ctrlKey&&f.resizeColumns&&!a.hasClass("a-GV-headerGroup"))return void(l?this.setColumnWidth(l,a.outerWidth()+10):(u.rowHeaderWidth+=10,this._calculateColumnWidths(a,!0)));(!this.editMode||this.focusInHeader||a.hasClass(c))&&this.lastFocused&&(this.lastColIndex=null,(s=this.lastRow$.index(a))<this.lastRow$.length-1&&(s+=1,p=this.lastRow$.eq(s)),e.preventDefault())}else if(65===m&&e.ctrlKey&&!this.editMode)this.selectAll(null),e.preventDefault();else if(m===_.SPACE){if("BUTTON"===e.target.nodeName)return;if((a=g.filter(".a-GV-selHeader").find(".u-selector")).length)return a.click(),void e.preventDefault();if((a=z(this.lastFocused)).hasClass("a-GV-header"))C();else if(a.hasClass("a-GV-cell")&&(!this.editMode||a.hasClass("a-GV-selHeader"))){let t=this._checkInteractWithCellItem(e,g,a);this._select(a,e,!0,!0),t||e.preventDefault()}}else if(m===_.ENTER){if(!g.hasClass("a-GV-expandCollapse")&&g.closest("a,button,.js-uses-enter").length>0)return;if((a=g.filter(".a-GV-selHeader").find(".u-selector")).length)return void a.click();a=z(this.lastFocused),this.editMode&&(a.hasClass("a-GV-cell")||a.hasClass(c))?e.shiftKey?(p=this._getPrevCellUp(a,1,!0),e.shiftKey=!1):p=this._getNextCellDown(a,1):(e.preventDefault(),f.editable&&f.allowEditMode&&a.hasClass("a-GV-cell")&&!a.hasClass("a-GV-selHeader")?this.setEditMode(!0):a.hasClass("a-GV-header")?C():f.editable&&f.allowEditMode||!a.hasClass("a-GV-cell")||this._fireActivate(e,a))}else if(113===m)(a=T(this.lastFocused)).length&&f.editable&&f.allowEditMode&&!this.editMode&&this.setEditMode(!0);else if(m===_.ESCAPE)f.editable&&f.allowEditMode&&this.editMode&&this._doEscapeKey(e);else if(m===_.DELETE){if(f.editable&&f.allowDelete&&!this.editMode&&!this.focusInHeader){for(d=this.getSelectedRecords(),t=0;t<d.length;t++)this.model.allowDelete(d[t])||(d.splice(t,1),t-=1);d.length>0&&this.model.deleteRecords(d)}}else 45===m?f.editable&&f.allowInsert&&!this.editMode&&!f.selectCells&&this.model.allowAdd()&&((d=this.getSelectedRecords()).length>0?this.model.insertNewRecord(null,d[d.length-1]):this.model.insertNewRecord()):112===m&&e.altKey?this._doHelpKey():m===_.TAB&&this.editMode&&(this.lastKeyTab=!0);p&&(this._select(p,e,!0,!0),e.preventDefault())}},focusin:function(e){var t,s,a=null,l=this,i=n(e.target);i.closest(".a-GV-floatingItem").length?this._clearDeactivate():0!==(t=i.closest(d)).length?(t.addClass(f),this.lastEditModeCell!==t[0]?(this.editMode?(this.focusInHeader=!1,s=n(this.lastEditModeCell),this._clearDeactivate(),s.length&&this._deactivateCell(s),t.hasClass("a-GV-cell")||t.hasClass(c)?!t.hasClass("a-GV-selHeader")&&!t.hasClass(c)||this.lastKeyTab?(i.closest("a,button").length&&(a=e.target),setTimeout((function(){l.editMode&&!t.hasClass(p)&&l._activateCell(t,a)}),0)):(this._clearTabTraps(),this.lastEditModeCell=null,this._setFocusable(e.target),this._setTabTraps(t)):(this.focusInHeader=!0,this.lastEditModeCell=null,this._setFocusable(e.target))):this._setFocusable(e.target),this.lastKeyTab=!1):this._clearDeactivate()):i.hasClass("js-tabTrap")||(this.lastEditModeCell=null)},focusout:function(e){var t=n(e.target).closest(d),s=this._getColumnMetadata(t),a=s&&this.columnItems[s.property];t.removeClass(f),this.editMode&&t.hasClass("a-GV-cell")&&(null===this.lastEditModeCell&&this._clearTabTraps(),a&&a.item.isDisabled()||this._beginDeactivate(t))},mousemove:function(e){var t,s,a,l,i,o=n(e.target),r=this.options,c=o.closest(d);c.length?c[0]!==this.lastHoverCell&&((t=c.parent())[0]!==this.lastHoverRow&&(this._clearHoverStates(),this.lastHoverRow=t[0],!t.hasClass("a-GV-row")&&!t.hasClass(h)||this.columnReordering||this.columnWidthDragging||this._setRowHoverState(t)),this.lastHoverCell=c[0],this.columnControls$.hide(),this.columnHandle$.hide(),"TH"!==c[0].nodeName||c.hasClass("a-GV-cell")||t.hasClass(h)||(l=this.columns[c.attr("data-idx")],!r.columnSort||this.columnReordering||this.columnWidthDragging||c.hasClass("a-GV-selHeader")||c.hasClass("a-GV-headerGroup")||!l.canSort||(c.append(this.columnControls$.show()),this._updateColumnControls(l)),!r.reorderColumns||this.columnReordering||this.columnWidthDragging||c.hasClass("a-GV-selHeader")||(this.columnReorderCell$=c,c.append(this.columnHandle$.show().css("left",""))),!r.resizeColumns||this.columnReordering||this.columnWidthDragging||c.hasClass("a-GV-selHeader")&&"sequence"!==r.rowHeader&&r.rowHeader!==b||(s=c.closest("div")[0],a=c[0].offsetLeft+s.offsetLeft-s.scrollLeft,this.element.hasClass("u-RTL")||(a+=c.outerWidth()),this.columnWidthHandle$.show().css("left",a-this.columnWidthHandle$.width()/2),i=c.attr("data-idx"),this.columnWidthCell$=i?this._columnFromIndex(i):this.element.find(".a-GV-header.a-GV-selHeader")))):null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())},mouseleave:function(){null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())}},_doEscapeKey:function(e){var t=T(this.lastFocused);t.length&&this._setFocusable(t[0]),t.focus(),this.setEditMode(!1),t.length&&this._setFocus(this._getCellFocusable(t)),e.stopPropagation()},_doHelpKey:function(){var e,t=z(this.lastFocused);t.hasClass("a-GV-selHeader")||t.hasClass("a-GV-headerGroup")||t.hasClass(c)||(e=this._getColumnMetadata(t))&&e.helpid&&(this.editMode&&t.focus(),apex.theme.popupFieldHelp(e.helpid,$v("pInstance")))},_initTooltips:function(t){var a,l=this;n.ui.tooltip?(this.tooltipOptions&&(this.element.find(".a-GV-bdy").filter(":data('ui-tooltip')").tooltip("destroy"),this.tooltipOptions=null),t&&((a=this.tooltipOptions=n.extend(!0,{show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip"},t)).items="td,th",a._originalContent=a.content,a.content=function(t){var s,i,o,r=n(this),d=r.parent(),h=null,c=null,u=l._getColumnMetadata(r);if((s=d.attr("data-id"))&&(h=l.model.getRecordMetadata(s)),u&&h&&h.fields&&(c=h.fields[u.property]),h&&!h.deleted){if(c&&(c.error||c.warning))return"<span class='"+(i=c.error?"is-error":"is-warning")+"'>"+e.escapeHTML(c.message)+"</span>";if((h.error||h.warning)&&r.hasClass("a-GV-selHeader"))return"<span class='"+(i=h.error?"is-error":"is-warning")+"'>"+e.escapeHTML(h.message)+"</span>";if(h.agg&&u&&(o=l.options.aggregateTooltips[h.agg+"|"+u.property]))return"<span class='"+i+"'>"+e.escapeHTML(o)+"</span>"}return a._originalContent?a._originalContent.call(this,t,l.model,h,c,u):null},a.open=function(e,t){t.tooltip.find(".is-error").length&&t.tooltip.addClass("is-error"),t.tooltip.find(".is-warning").length&&t.tooltip.addClass("is-warning")},this.element.find(".a-GV-bdy,.a-GV-hdr").tooltip(a))):s.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var e=this.element;this._tableModelViewDestroy(),e.removeClass("a-GV is-disabled u-RTL").removeAttr("role").removeAttr(m).removeAttr(g).attr("aria-labelledby",this.origLabelBy).empty(),i.removeHandler(e[0]),s.info("Grid '"+e[0].id+"' destroyed. Model: "+this.options.modelName),this.tableData$=null,this.tableFrozenData$=null,this._initModel(null),this.gridStyles$&&this.gridStyles$.remove(),this._destroyContextMenu()},_setOption:function(e,t){var a=this.element,l=this.options;if(s.info("Grid '"+a[0].id+"' set option '"+e+"' to: ",t),this._checkContextMenuOptions(e,t),"allowCopy"===e)throw new Error("Grid "+e+" cannot be set");"editable"===e&&!t&&this.editMode?this.setEditMode(!1):"multiple"===e&&this.setSelection(n()),this._super(e,t),this._enforceOptionConstraints(),"disabled"===e?(a.toggleClass("is-disabled",t),this.lastFocused&&(t?this.lastFocused.tabIndex=-1:this._setFocusable(this.lastFocused)),t&&this.resize()):"selectCells"===e?this._setSelectionMode():"multiple"===e?(t?a.attr(m,v):a.removeAttr(m),l.rowHeader!==C&&l.rowHeaderCheckbox&&this.refreshColumns(),this.refresh()):"modelName"===e?(this.editMode&&this.setEditMode(!1),this._initModel(t),this.refresh(!1)):"highlights"===e?this._updateHighlights():"tooltip"===e?this._initTooltips(t):"rowHeader"!==e&&"rowHeaderCheckbox"!==e&&"rowHeaderLabelColumn"!==e&&"columnSort"!==e&&"resizeColumns"!==e&&"reorderColumns"!==e&&"editable"!==e&&"pagination"!==e&&"selectAll"!==e&&"footer"!==e&&"autoAddRecord"!==e||("editable"===e&&(t?a.removeAttr(g):a.attr(g,v)),this._refreshGrid())},_enforceOptionConstraints:function(){var e=this.options;e.rowHeaderCheckbox&&e.rowHeader===C&&(s.warn("Option rowHeaderCheckbox cannot be true when rowHeader is 'none'."),e.rowHeaderCheckbox=!1),!e.multiple||e.rowHeader!==C&&e.rowHeaderCheckbox||!apex.userHasTouched()||(e.rowHeader===C&&(e.rowHeader="plain"),e.rowHeaderCheckbox=!0),e.editable&&e.allowEditMode||(e.autoAddRecord=!1),e.rowHeader!==C&&(e.rowHeaderWidth?this.rowHeaderWidth=e.rowHeaderWidth:(e.rowHeaderCheckbox?this.rowHeaderWidth=34:this.rowHeaderWidth=16,"sequence"!==e.rowHeader&&e.rowHeader!==b||(this.rowHeaderWidth+=38)))},refresh:function(e){var t,a,l,i,o,r,d,h,c=!1,u=null,f=null,p=null,m=this,g=this.options,C=this.element;if(s.info("Grid '"+C[0].id+"' refreshed. Model: "+g.modelName),!0!==e&&(c=this._paginationHasFocus()),void 0===e&&(e=n(document.activeElement).closest(C[0]).length>0),this._refreshCheckIfVisible()){if((u=C.find(".is-active.a-GV-cell")).length&&this._deactivateCell(u),this.focusInHeader?this.columnsStale&&this.columns&&(p=R(n(this.lastFocused).closest("tr")),(a=n(this.lastFocused).closest("th").attr("data-idx"))&&(a=this.columns[a].property),this.lastFocused=null):this.lastFocused=null,this.tableData$&&(!g.persistSelection||g.selectCells))if(g.selectCells)(l=this.getSelection()).length>0&&(u=l[0].first(),i=R(u),this.tableFrozenData$&&0===u.closest(this.tableFrozenData$).length&&(i+=this.tableFrozenData$.find("tr").first().children().length),f={rowIndex:R(u.parent()),colIndex:i});else{for(l=this.getSelection(),f=[],t=0;t<l.length;t++)void 0!==(r=l[t].first().attr("data-id"))&&f.push(r);0===f.length&&(f=null)}this._refreshPagination(C.find(".a-GV-w-scroll")),this.columnsStale||!this.columns?this._initGrid():(this.tableFrozenData$&&this.tableFrozenData$.empty(),this.tableData$.empty(),this._clearChildrenRowCache(),this._updateScrollHandler(C.find(".a-GV-w-scroll"))),this.controlBreaks=[],this._updateStatus(),this.noData||this.resize(),d=C.find(".a-GV-hdr"),null!==p&&a&&((h=g.columns[0][a])&&(a=h.seq-1,d.find("thead").each((function(){if((u=n(this).children().eq(p).find("th[data-idx='"+a+"']")).length)return!1}))),u&&u.length||(u=d.find("thead").first().find("tr").eq(p).children().first()),u&&u.length&&(m._select(u,null,e,!1,!0),e=!1)),this.allSelected=!1,this._addPageOfRecords((function(){var t,s,a,r,h=!1;if(c&&(m._restorePaginationFocus(c),e=!1),C.find(".a-GV-header .u-selector").attr("aria-disabled",m.noData?v:"false").toggleClass("is-disabled",m.noData),m._updateAccLabel(),g.hasSize&&m._calculateColumnWidths(null,!0,!0),m.lastHoverCell=null,m.lastHoverRow=null,m.lastFocused&&n(m.lastFocused).is(":visible")||(m.lastRow$=null,m.lastFocused=m._getCellFocusable(C.children(".a-GV-bdy").find("tbody tr").first().children().first()),m.lastFocused?(m.selectAnchor=m.lastFocused,m.focusInHeader=!1):(m.lastFocused=m._getCellFocusable(d.find("thead").first().find("tr").last().children().first()),m.focusInHeader=!0),m.lastFocused&&!g.disabled&&(m._setFocusable(m.lastFocused),m._setCurrentRow(m.lastFocused))),f){if(g.selectCells)m.tableData$.find(".a-GV-row").length>f.rowIndex&&(i=f.colIndex,o=m.tableData$,m.tableFrozenData$&&(a=m.tableFrozenData$.find("tr").first().children().length,i>a?i-=a:o=m.tableFrozenData$),s=o.find(".a-GV-row").eq(f.rowIndex).children(),i>=s.length&&(i=s.length-1),m.setSelection([s.eq(i)],e),h=!0);else{for(l=[],t=0;t<f.length;t++)(r=m.model.getRecord(f[t]))&&l.push(r);l.length>0&&(h=0!==m.setSelectedRecords(l,e))}h||(m._trigger("selectionChange",{}),e&&m.focus())}else e&&m.focus()}))}},focus:function(){this.lastFocused&&this.lastFocused.focus()},gotoCell:function(e,t){var a,l,i,o,n=this.options,r=!1,d=null,h=null,c=this.element.find("[data-id='"+e+"']");if(this.gotoCellPending=null,this.tableData$){if(t&&((d=n.columns[0][t])?d.hidden&&d.canHide&&(d.hidden=!1,r=!0,this.refreshColumns(),this.gotoCellPending={record:e,column:t}):s.warn("Warning column not found "+t)),!c.length){if(!(a=this.model.getRecord(e)))return void s.warn("Warning record not found "+e);l=this.model.indexOf(a),this.gotoCellPending={record:e,column:t},n.pagination.scroll?(i=this.scrollParent$,o=Math.floor(l/this.displayPageSize)*this.displayPageHeight,i.scrollTop(o)):(this.pageOffset=Math.floor(l/this.pageSize)*this.pageSize,r=!0)}r&&this.refresh(!1),this.gotoCellPending||(t&&d&&(h=this._cellFromColumn(c,t)),h||(h=c.children().first()),this._select(h,null,!0,!1))}},getActiveCellFromColumnItem:function(e){var t,s=this,a=null;return this.activeRecordId&&(t=this.element.find("[data-id='"+this.activeRecordId+"']"),n.each(this.columnItems,(function(l,i){e===i.item.node&&(a=s._cellFromColumn(t,l))}))),a},inEditMode:function(){return this.editMode},setEditMode:function(e){var t,a,l=!1,i=this;function o(){i.columnItemsContainer$.off("change.gridedit"),i.activeRecord=null,i.activeRecordId=null}this.tableData$&&(this.options.editable?(e=!!e,this.lastFloatingPos={},t=e!==this.editMode,this.editMode=e,this.element.toggleClass("a-GV--editMode",e),(a=T(this.lastFocused)).length&&(e?this._activateCell(a):(this.lastEditModeCell=null,this._clearDeactivate(),this._deactivateCell(a),this.activeRecord&&(this._deactivateRow(o),l=!0))),t&&(e?this.columnItemsContainer$.on("change.gridedit",(function(e){var t,s,a;if(i.activeRecord)for(t=0;t<i.columns.length;t++)if((s=i.columns[t]).elementId===e.target.id){a=s.property,i.setActiveRecordValue(a);break}})):l||o(),this._trigger("modeChange",null,{editMode:e}))):e&&s.warn("Grid is not editable."))},getSelection:function(){var e,t,s=[];return this.tableData$&&(this.options.selectCells?(t=this.tableData$.find(".is-selected").parent("tr"),this.tableFrozenData$&&(e=this.tableFrozenData$.find(".is-selected").parent("tr")),e&&e.length?e.each((function(e){s.push(n(this).find(".is-selected").filter("td,th").add(t.eq(e).find(".is-selected").filter("td,th")))})):t.each((function(){s.push(n(this).find(".is-selected").filter("td,th"))}))):(t=this.tableData$.find(".is-selected").filter("tr"),this.tableFrozenData$?(e=this.tableFrozenData$.find(".is-selected").filter("tr")).each((function(e){s.push(n([this,t[e]]))})):t.each((function(){s.push(n(this))})))),s},setSelection:function(e,t,s){var a,l,i=null,o=this.lastFocused,r=this.focusInHeader,d=[];if(this.tableData$){if(this.options.selectCells)n.isArray(e)||(e=[e]),l=e[0].first()[0],d.push(e[e.length-1].last()[0]),l!==d[0]&&(this._select(n(l),null,null,!1,!1),i={type:"click",shiftKey:!0});else if(n.isArray(e))for(a=0;a<e.length;a++)(l=e[a].children("td,th")[0])&&d.push(l);else e.each((function(){(l="TR"===this.nodeName?n(this).children("td,th")[0]:n(this).closest("td,th")[0])&&d.push(l)}));this.focusInHeader=!1,this._select(n(d),i,t,!1,s),t||(this.focusInHeader=r,r&&(this._setFocusable(o),this._setCurrentRow(o)))}},selectAll:function(e,t){var s=[],a=this.options,l=this.tableFrozenData$||this.tableData$;l&&a.multiple&&a.selectAll&&!a.selectCells&&(l.children().each((function(){s.push(n(this).children()[0])})),this.setSelection(n(s),e,t))},getRecords:function(e){var t,s,a,l=[];for(t=0;t<e.length;t++)void 0!==(s=e[t].first().attr("data-id"))&&(a=this.model.getRecord(s))&&l.push(a);return l},getSelectedRange:function(){var e,t,s,a,l,i,o,n=null;if(this.options.selectCells)for(n={columns:[],recordIds:[],values:[]},e=this.getSelection(),t=0;t<e.length;t++){if(l=e[t],0===t)for(s=0;s<l.length;s++)o=this._getColumnMetadata(l.eq(s)),n.columns.push(o?o.property:null);for(i=l.first().parent().attr("data-id"),n.recordIds.push(void 0!==i?i:null),a=[],s=0;s<l.length;s++)a.push(l.eq(s).text());n.values.push(a)}return n},getSelectedRecords:function(){var e=this.options;return e.selectCells?[]:e.persistSelection?this.model.getSelectedRecords():this.getRecords(this.getSelection())},setSelectedRecords:function(e,t,s){var a,l=0,i=[],o={},r=this.tableFrozenData$||this.tableData$;if(!r)return-1;if(this.options.selectCells)return-1;for(a=0;a<e.length;a++)o[this.model.getRecordId(e[a])]=!0;return r.children().each((function(){var e=n(this),t=e.attr("data-id");o[t]&&(i.push(e),l+=1)})),this.setSelection(i,t,s),l},activateRow:function(e,t){var s=!1,a=n(this.lastEditModeCell),l=e.parent().attr("data-id");this.editMode&&l===this.activeRecordId||(this.element.one("apexbeginrecordedit",(function(){t()})),s=!0),this.editMode?(a.length&&(a.removeClass(f),this._deactivateCell(a)),e.addClass(f),this._activateCell(e)):(this.lastFocused=e[0],this.setEditMode(!0)),s||t()},activateCell:function(e){var t=n(this.lastEditModeCell);return!!this.editMode&&(e[0]===this.lastEditModeCell||(t.length&&(t.removeClass(f),this._deactivateCell(t)),e.addClass(f),this._activateCell(e)))},copyDownSelection:function(e,t){return this._setSelectionValues(1,e,t)},fillSelection:function(e,t,s){return this._setSelectionValues(0,t,s,e)},_setSelectionValues:function(e,t,s,a){var l,i,o,r=this,d=this.editMode,h=this.lastFocused,c=0,u=this.options;function p(){for(var e,t,a;;){if(c>=l.length||!i.length){(a=n(r.lastEditModeCell)).removeClass(f),d?a.length&&r._deactivateCell(a):r.setEditMode(!1),r.setSelection(l),n(h).focus(),s&&s();break}if(c>0&&(o=u.selectCells?l[c]:l[c].children()),c+=1,e=o.first().parent().attr("data-id"),r.model.allowEdit(r.model.getRecord(e))){t=o.first(),!u.selectCells&&u.rowHeader!==C&&o.length>=2&&(t=o.eq(1)),r.activateRow(t,m);break}}}function m(){var e,t;for(e=0;e<i.length;e++)t=i[e],r.activateCell(o.eq(t.index))&&t.item.setValue(t.value,t.displayValue);p()}return!((l=this.getSelection()).length<=e)&&(t||(t=[],u.selectCells?this.getSelectedRange().columns.forEach((function(e){e&&t.push(e)})):this.columns.forEach((function(e){var s=e.property;!s||e.hidden||e.virtual||e.noCopy||r.model.isIdentityField(s)||!e.elementId||e.readonly||t.push(s)}))),o=u.selectCells?l[c]:l[c].children(),this.activateRow(o.first(),(function(){i=[],o.each((function(s){var l,o,d,h=n(this),c=r._getColumnMetadata(h);c&&t.indexOf(c.property)>=0&&c.elementId&&(o={index:s,item:l=r.columnItems[c.property].item},1===e?(o.value=l.getValue(),d=l.displayValueFor(o.value),o.value!==d&&(o.displayValue=d)):o.value=a,i.push(o))})),c=e,p()})),!0)},resize:function(){var e,t,s,a,l=this.element,i=this.options,o=l.height(),d=l.width(),h=l.children(".a-GV-hdr"),c=l.children(".a-GV-bdy");null!==l[0].offsetParent&&(c.length&&!this.pendingRefresh?(a=this.tableData$.prev().height(),l.find(".a-GV-bdy "+r).css("margin-top",-(a+parseInt(this.tableHeader$.find("th").first().css("border-bottom-width"),10))),e=d,this.tableFrozenData$&&(s=this.tableFrozenData$.closest(".a-GV-w-frozen").width(),l.find(".a-GV-w-frozen").width(s).toggleClass("a-GV-w-frozen--showLabels",s>200),this.tableData$.parent().parent().find(".a-GV-loadMoreButton").css("visibility",s>200?"hidden":"visible"),e-=s),l.find(".a-GV-w-scroll,.a-GV-w-hdr").width(e),n.apex.stickyWidget&&l.find(".js-stickyWidget-toggle").stickyWidget("refresh"),i.hasSize&&(t=o-h.height()-this._footerHeight(),c.children(".a-GV-w-scroll").addBack().height(t)),this._calculateColumnWidths(null,!0,i.hasSize||this.tableData$.parent().width()>e),this._initPageSize()):this.refresh())},expandControlBreak:function(e){this._expandCollapseControlBreak(e,!0)},collapseControlBreak:function(e){this._expandCollapseControlBreak(e,!1)},getColumns:function(){return this.columns},refreshColumns:function(){this.columnsStale=!0},setColumnWidth:function(e,t){var s=this._updateColumnWidth(e,t,!0);this._trigger("columnResize",null,{header$:s[1],column:s[0],width:t})},hideColumn:function(e){var t=this._columnName(e);this.options.columns[0][t].hidden=!0,this._refreshGrid()},showColumn:function(e){var t=this._columnName(e);this.options.columns[0][t].hidden=!1,this._refreshGrid()},freezeColumn:function(e){var t,s,a=this.columns,l=this._columnName(e);for(t=0;t<a.length&&(s=a[t],t<a.length-1&&(s.frozen=!0),s.property!==l);t++);this._refreshGrid()},unfreezeColumn:function(e){var t,s,a=this._columnName(e);for(t=this.columns.length-1;t>=0&&((s=this.columns[t]).frozen=!1,s.property!==a);t--);this._refreshGrid()},moveColumn:function(e,t){var s=this._moveColumn(e,t);this._refreshGrid(),s.header$=this._columnFromIndex(t),this._trigger("columnReorder",null,s)},moveColumnGroup:function(e,t,s){var a,l,i,o,n,r,d,h=[];if(!(i=this.columnGroups[e]))throw new Error("Invalid column group level: "+e);for(o=-1,a=0;a<i.length;a++)l=i[a],a===t&&(o=l.start,n=l.end),a===s&&(r=-1===o?l.start:l.end);if(s>t)for(a=o;a<=n;a++)(d=this._moveColumn(this.columns[o],r)).newPosition=r-(n-a),d.oldPosition=a,h.push(d),this._updateColumns();else for(a=n;a>=o;a--)(d=this._moveColumn(this.columns[n],r)).newPosition=r+(a-o),d.oldPosition=a,h.push(d),this._updateColumns();for(this._refreshGrid(),a=0;a<h.length;a++)(d=h[a]).header$=this._columnFromIndex(d.newPosition),this._trigger("columnReorder",null,d)},_refreshGrid:function(){var e;(e=this.element.find(".is-active.a-GV-cell")).length&&this._deactivateCell(e),this.refreshColumns(),this.refresh()},_cellFromColumn:function(e,t){var a,l,i=this.columns,o=this.options,n=null,r=0;if(!o.columns[0][t])return s.warn("Warning column not found "+t),null;for(o.rowHeader!==C&&(r=1),a=0;a<i.length;a++)if(!(l=i[a]).hidden){if(l.property===t){n=e.children().eq(r);break}r+=1}return a>=i.length&&s.warn("Warning column is hidden "+t),n},_columnFromIndex:function(e){return this.element.find(".a-GV-header[data-idx='"+e+"']")},_columnName:function(e){var t;if(t="object"==typeof e?e.property:e,!this.options.columns[0].hasOwnProperty(t))throw new Error("Unknown column: "+t);return t},_moveColumn:function(e,t){var s,a,l,i,o=this.columns,n=this._columnName(e);for(l=-1,s=0;s<o.length;s++)if((a=o[s]).property===n){l=s;break}if(i=o[t].seq,l!==t){if(l<t)for(s=t;s>l;s--)o[s].seq=o[s-1].seq;else for(s=t;s<l;s++)o[s].seq=o[s+1].seq;return o[l].frozen=t<=this.lastFrozenColIndex,o[l].seq=i,{column:a,newPosition:t,oldPosition:l}}},_updateColumns:function(){var e,t,s,a,l,i,o,r,d,h,c,u,f,p={},m=this.options,g=m.columns[0];for(a in this.columns=[],this.columnsStale=!1,this.columnGroups=[],this.breakColumns=[],this.fieldToColumnIndex={},g)g.hasOwnProperty(a)&&((s=g[a]).property=a,s.domId=s.elementId?s.elementId+"_HDR":this.idPrefix+"_h_"+s.property,s.seq=s.seq||"0",this.columns.push(s));for(this.columns.sort((function(e,t){return e.seq-t.seq})),this.lastFrozenColIndex=-1,e=0;e<this.columns.length;e++)if(!(s=this.columns[e]).hidden){if(!s.frozen)break;this.lastFrozenColIndex=e}for(c=m.rowHeader!==C?1:0,e=0;e<this.columns.length;e++)(s=this.columns[e]).controlBreakIndex>0&&this.breakColumns.push(s),s.hidden||(this.fieldToColumnIndex[s.property]=c,c+=1);for(this.breakColumns.sort((function(e,t){return e.controlBreakIndex-t.controlBreakIndex})),i=null,r=null,d=null,u=!0,c=0,o=0,t=0,f=[],e=0;e<this.columns.length;e++)if(!(s=this.columns[e]).hidden){if(null===i&&(i=[],this.columnGroups.push(i)),(h=L(s))!==r||e===this.lastFrozenColIndex+1){if(r=h,d&&(d.span=c-o,d.end=t,d.children=f,f=[]),o=c,h){if(!(d=n.extend({},m.columnGroups[h])))throw new Error("Unknown column group name: "+h);d.heading&&(u=!1,p[h]||(d.domId=this.idPrefix+"_g_"+h)),d.property=h,i.push(d)}else d={},i.push(d);d.start=e,e<=this.lastFrozenColIndex&&(d.frozen=!0,p[h]=1)}f.push(s),c+=1,t=e,null===d&&(d={start:e},this.lastFrozenColIndex>=0&&(d.frozen=!0),i.push(d))}for(d&&(d.span=c-o,d.end=t,d.children=f),u&&(this.columnGroups=[],i=null);i;){for(l=i,i=null,r=null,d=null,u=!0,c=0,f=[],e=0;e<l.length;e++){if((h=(s=l[e]).parentGroupName||null)!==r||s.frozen!==(!!d&&d.frozen)){if(r=h,null===i&&(i=[],this.columnGroups.unshift(i),c>0&&(d={},s.frozen&&(d.frozen=!0),i.push(d))),d&&(d.span=c-o,d.children=f,f=[]),o=c,h){if(!(d=n.extend({},m.columnGroups[h])))throw new Error("Unknown column group name: "+h);d.heading&&(u=!1,p[h]||(d.domId=this.idPrefix+"_g_"+h)),d.property=h,i.push(d)}else d={},i.push(d);d.start=s.start,s.frozen&&(d.frozen=!0,p[h]=1)}f.push(s),d.end=s.end,c+=s.span}d&&(d.span=c-o,d.end=s.end,d.children=f),u&&(this.columnGroups.shift(),i=null)}},_initGrid:function(){var t,a,l,i,r,d,c,u,f,p,m,g,b,v,w,I,x,V=0,$=0,y=0,F=0,k=null,D=this,R=this.options,S=this.element;function z(){V!==y&&(t[0].scrollLeft=V=y,a[0].scrollLeft=V,g.css("left",V)),$!==F&&($=F,l[0]&&(l[0].scrollTop=$),a[0].scrollTop=$),k=null}function M(e){var t;if(w){if(t=I*(e-w),I/=1.6,t>-2&&t<2)return void(I=0);l[0].scrollTop=a[0].scrollTop=$=F=l[0].scrollTop-t}w=e,G(M)}function T(){var e=D.element.find(".is-active.a-GV-cell");D.floatingItem$.hasClass("is-expanded")?D._collapseFloatingItem(e):D._expandFloatingItem(e)}s.info("Grid render and initialize."),this._updateColumns(),this.columnItems||this._initColumnItems(this.columns),this._renderGrid(),S.find(".a-GV-hdr :tabbable").prop("tabIndex",-1),R.tooltip&&this._initTooltips(R.tooltip),R.rowHeader!==C&&R.rowHeaderCheckbox&&(this.tableFrozenHeader$.parent().addClass("a-GV-table--checkbox"),this.tableFrozenData$.parent().addClass("a-GV-table--checkbox")),t=S.find(".a-GV-w-hdr"),a=S.find(".a-GV-w-scroll"),l=S.find(".a-GV-w-frozen").last(),f=(i=S.children(".a-GV-bdy")).find("col"),p=i.find("thead").find(".a-GV-header"),x=this.tableData$.parent().width()-e.getScrollbarSize().width,this.tableFrozenData$&&(x-=this.tableFrozenData$.parent().width()),t.add(a).width(x),f.each((function(e){var t=n(this),s=D.columns[t.attr("data-idx")];s&&(s.width?s.curWidth=s.width:s.curWidth=s.defWidth=p.eq(e).width(),s.curWidth<40&&(s.curWidth=40))})),g=this.tableData$.parent().parent().find(".a-GV-loadMoreButton"),a.on("scroll.gvss",(function(){y=this.scrollLeft,F=this.scrollTop,k||(k=G(z))})),t.on("scroll.gvss",(function(){y=this.scrollLeft,k||(k=G(z))})),l.on("scroll.gvss",(function(){F=this.scrollTop,k||(k=G(z))})),R.hasSize&&l.length&&(l.on(H,(function(e){var t=e.originalEvent.deltaY||e.originalEvent.detail||-1/40*e.originalEvent.wheelDelta;void 0!==e.originalEvent.deltaMode&&1!==e.originalEvent.deltaMode||(t*=30),F=this.scrollTop+t,k||(k=G(z)),e.preventDefault()})),apex.userHasTouched()&&((b=new Hammer(l[0])).get("pan").set({direction:Hammer.DIRECTION_VERTICAL}),b.on("panup pandown",(function(e){F=v-e.deltaY,k||(k=G(z)),I=0,e.isFinal&&(e.velocityY>=.1||e.velocityY<=-.1)&&(w=0,I=e.velocityY,G(M))})),b.on("panstart",(function(){v=l[0].scrollTop})))),d=this.element.find(".js-tabTrap"),this.tabTraps$=d,2===d.length?c=0:(3===d.length?(c=1,u=0):(c=4,u=3,d.eq(0).on("focus",(function(){D.lastEditModeCell?D.tableData$.find(":tabbable").first().focus():D._prevCellWithWrap(n(D.lastFocused)).focus()})),d.eq(1).on("focus",(function(){D.tableData$.find(":tabbable").last().focus()})),d.eq(2).on("focus",(function(){D.tableFrozenData$.find(":tabbable").first().focus()}))),d.eq(u).on("focus",(function(){n(this).hasClass("js-autoAdd")?D._autoAddRecord(D.activeRecord):(D.tableFrozenData$?D.tableFrozenData$:D.tableData$).find(":tabbable").last().focus()}))),d.eq(c).on("focus",(function(){var e,t,s=n(D.lastEditModeCell).closest("tbody"),a=s.find(":tabbable").add(D.lastEditModeCell),l=a.index(D.lastEditModeCell);l>0?a.first().focus():D.tableFrozenData$&&0===d.eq(0).prop("tabIndex")?(s=s[0]===D.tableFrozenData$[0]?D.tableData$:D.tableFrozenData$).find(":tabbable").first().focus():(e=n(":tabbable"),t=D.element.find(":tabbable").first(),l=e.index(t),e.eq(l-1).focus())})),d.eq(c+1).on("focus",(function(){var e=n(D.lastEditModeCell).closest("tbody"),t=e.find(":tabbable").add(D.lastEditModeCell),s=t.index(D.lastEditModeCell);n(this).hasClass("js-autoAdd")?D._autoAddRecord(D.activeRecord):s<t.length-1?t.last().focus():D.tableFrozenData$&&(e=e[0]===D.tableFrozenData$[0]?D.tableData$:D.tableFrozenData$).find(":tabbable").last().focus()})),d.prop("tabIndex",-1),R.reorderColumns&&this._initColumnReorder(),this.columnWidthHandle$=n(),R.resizeColumns&&this._initColumnResize(),this.columnControls$.on("click","button",(function(e){var t=n(e.target);D._sortChange(e,t.closest(".a-GV-header"),t.closest("button").hasClass("js-asc")?"asc":"desc")})),this.floatingItem$.draggable({handle:".a-GV-cellMoveHandle",containment:"body",stop:function(e,t){var s=D._getColumnMetadata(D.element.find(".is-active.a-GV-cell")).property;D.lastFloatingPos[s]={left:t.position.left,top:t.position.top}}}).on("keydown",(function(e){var t=e.which;if(e.ctrlKey&&117===t)return T(),!1;112===t&&e.altKey?D._doHelpKey():t===_.ESCAPE&&D._doEscapeKey(e)})).on("mousedown",(function(e){n(e.target).hasClass("a-GV-cellMoveHandle")&&D._clearDeactivate()})).on("focusin",(function(){D._clearDeactivate()})).on("focusout",(function(){D.lastEditModeCell&&D._beginDeactivate(n(D.lastEditModeCell))})).children(".a-GV-expandCollapse").click(T),o.TouchProxy.addTouchListeners(this.floatingItem$[0]),this._initPaginationFooter(a),!R.hasSize&&R.stickyTop&&n.apex.stickyWidget&&(m={stickToEnd:!0,toggleWidth:!0,bottom:function(){return S.offset().top+S.outerHeight()-D._footerHeight()}},n.isFunction(R.stickyTop)&&(m.top=R.stickyTop),S.find(".a-GV-hdr").css("overflow","hidden").stickyWidget(m)),this.breakColumns.length>0&&R.collapsibleControlBreaks&&S.find(".a-GV-bdy").on("click",".js-toggleBreak",(function(){r=n(this).closest("."+h),D._expandCollapseControlBreak([r],!r.hasClass("is-expanded"))}))},_initColumnReorder:function(){var e,t,s,a,l,i,r,d,h,c,u,f,p,m,g=this.element.hasClass("u-RTL"),C=this.element.find(".a-GV-hdr"),b=this;C.append(this.columnMoveMarker$),m=parseInt(b.columnHandle$.css("margin-left"),10),g&&(m=-m),b.columnHandle$.draggable({appendTo:this.element,containment:C,cursor:"move",cursorAt:g?{right:-2*m}:{left:0},axis:"x",delay:100,distance:4,helper:function(){var e=n("<div class='a-GV-header-dragHelper'></div>"),t=b.columnReorderCell$;return e.append(t.find(".a-GV-headerLabel,.a-GV-columnHandle").clone()),e.width(t.outerWidth()),e},start:function(o,m){b.columnControls$.hide(),b._trigger("cancelColumnHeader",o,{}),e=b.columnReorderCell$.parent().offset().top-b.element.offset().top,t=e+b.element[0].offsetTop,i=C.css("position"),d="absolute",r=2,h=-C.offset().left,"relative"!==i&&("fixed"===i&&(h=0,e=t=b.columnReorderCell$.parent()[0].offsetTop+C[0].offsetTop,d="fixed",m.helper.css("margin-left",b.element.offset().left+"px")),r=parseInt(C.css("z-index"),10)+1),c=-b.columnMoveMarker$.width()/2,m.helper.css({top:t+"px",position:d,"z-index":r}),f=m.helper.outerWidth(),b.columnMoveMarker$.show().css({top:e+"px",left:b.columnReorderCell$.offset().left+h+(g?b.columnReorderCell$.width():0)+"px",position:d,"z-index":r}),b.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").hide(),b.columnHandle$.hide(),b.columnWidthHandle$.hide(),A((function(){b.columnReorderCancel=!0})),u=parseInt(b.columnReorderCell$.attr("data-idx"),10),b.hdrScrollParent=b.element.find(".a-GV-w-hdr")[0],p=b.hdrScrollParent.scrollLeft,s=[],l=null,(a=b._getRowForCell(b.columnReorderCell$)).children().each((function(){var e=n(this),t=!0,a=e.offset().left+h;e.parent().parent().parent().parent()[0]===b.hdrScrollParent&&(a+=p,t=!1),s.push({colIdx:parseInt(e.attr("data-idx"),10),start:a,end:a+e.outerWidth(),frozen:t})})),b.columnReordering=!0,b.columnReorderCancel=!1},drag:function(e){var t=b.hdrScrollParent.scrollLeft,a=parseInt(b.columnMoveMarker$.css("left"),10);function i(){var i,o,n,r=!1,d=e.pageX-m+h+b.hdrScrollParent.scrollLeft;for(i=0;i<s.length;i++)if(d>=(o=s[i]).start&&d<o.end){i!==l&&(l=i,n=g?(o.colIdx<u?o.end:o.start)+c:(o.colIdx<u?o.start:o.end)+c,o.frozen||(n-=b.hdrScrollParent.scrollLeft),a=n,t=b.hdrScrollParent.scrollLeft,b.columnMoveMarker$.css("left",n+"px"),r=!0);break}r||t===b.hdrScrollParent.scrollLeft||(n=a-(b.hdrScrollParent.scrollLeft-t),b.columnMoveMarker$.css("left",n+"px"))}b.columnReorderCancel?e.preventDefault():(i(),b._headerScrollCheck(e.pageX-m,f)?b.scrollTimerId||b._headerScrollStart(e.pageX-m,f,i):b.scrollTimerId&&b._headerScrollStop())},stop:function(){var e=null;null!==l&&(e=s[l].colIdx),isNaN(e)&&l+1<s.length&&(e=s[l+1].colIdx),isNaN(e)||(b.columnReordering=!1,b.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").show(),e===u&&(b.columnHandle$.show(),b.columnWidthHandle$.show(),b.columnControls$.show()),b.columnMoveMarker$.hide(),b.lastHoverCell=null,P(),b.scrollTimerId&&b._headerScrollStop(),b.columnReorderCancel||null===e||e===u||(b.columnReorderCell$.hasClass("a-GV-headerGroup")?b.moveColumnGroup(R(a),u,e):b.moveColumn(b.columns[u],e),b.focus()))}}),o.TouchProxy.addTouchListeners(b.columnHandle$[0])},_initColumnResize:function(){var e,t,s,a=this,l=this.element.hasClass("u-RTL")?-1:1,i=this.element.find(".a-GV-hdr"),r=i.find("tr").last();this.columnWidthHandle$=n("<div class='a-GV-columnWidthHandle'></div>").appendTo(i).css("top",r[0].offsetTop).height(r.height()),this.columnWidthHandle$.draggable({axis:"x",containment:i,start:function(l,i){a.columnWidthDragging=!0,a.columnWidthCancel=!1,a.columnWidthStartPos=i.position.left,a.columnWidthStartWidth=a.columnWidthCell$.first().outerWidth(),e=i.helper.outerWidth(),a.hdrScrollParent=a.element.find(".a-GV-w-hdr")[0],s=a.columnWidthCell$.parent().parent().parent().parent()[0]!==a.hdrScrollParent,t=a.hdrScrollParent.scrollLeft,A((function(){a.columnWidthCancel=!0}))},drag:function(i,o){function n(e){var i,n,r=a.columnWidthStartWidth+l*(o.position.left-a.columnWidthStartPos);i=a.hdrScrollParent.scrollWidth,s||(r+=a.hdrScrollParent.scrollLeft-t),r>40&&(a.columnWidthCell$.hasClass("a-GV-selHeader")?(a.rowHeaderWidth=r,a._calculateColumnWidths()):a._updateColumnWidth(a._getColumnMetadata(a.columnWidthCell$.first()),r)),(n=a.hdrScrollParent.scrollWidth-i)<0&&!e&&a.hdrScrollParent.scrollLeft!==t&&(a.hdrScrollParent.scrollLeft+=n,t+=n)}a.columnWidthCancel?i.preventDefault():(n(),a._headerScrollCheck(o.offset.left,e)?a.scrollTimerId||a._headerScrollStart(o.offset.left,e,(function(){n(!0)})):a.scrollTimerId&&a._headerScrollStop())},stop:function(e,i){var o=a.columnWidthStartWidth+l*(i.position.left-a.columnWidthStartPos);s||(o+=a.hdrScrollParent.scrollLeft-t),a.columnWidthDragging=!1,P(),a.scrollTimerId&&a._headerScrollStop(),a.columnWidthCancel&&(o=a.columnWidthStartWidth),o<40&&(o=40),a.columnWidthCell$.hasClass("a-GV-selHeader")?(a.rowHeaderWidth=o,a._calculateColumnWidths(null,!0)):a.setColumnWidth(a._getColumnMetadata(a.columnWidthCell$.first()),o)}}),o.TouchProxy.addTouchListeners(this.columnWidthHandle$[0])},_updateColumnWidth:function(e,t,s){var a,l,i,o=this._columnName(e);return(a=this.options.columns[0][o]).width=t,a.curWidth=t,i=this.columns.indexOf(a),l=this._columnFromIndex(i),this._calculateColumnWidths(l,s),[a,l]},_calculateColumnWidths:function(t,s,a){var l,i,o,r,d,h,c,u,f,p,m,g,C=this.options.hasSize,b=this.element,v=this;function _(e){var t,s;for(t=e+1;t<v.columns.length;t++)if(!(s=v.columns[t]).hidden&&!s.noStretch&&t!==p)return!1;return!0}function w(e,t){var s,a=t.parent().find("col"),l=e.parent().find("col");return s=0,l.each((function(e){var t,l=n(this),i=l.attr("data-idx");t=i?v.columns[i].curWidth:v.rowHeaderWidth,l[0].width=t,a[e].width=t,s+=t})),t.parent().width(s),e.parent().width(s),s}if(a)for(l=0;l<this.columns.length;l++)(i=this.columns[l]).curWidth=i.width||i.defWidth,i.curWidth<40&&(i.curWidth=40);if(s&&this.tableFrozenHeader$&&this.tableData$.prev().add(this.tableFrozenData$.prev()).add(this.tableHeader$).add(this.tableFrozenHeader$).each((function(){n(this).find(".a-GV-header").first().css("height","")})),t&&(h=t.parent().parent()[0],p=parseInt(t.attr("data-idx"),10)),!this.tableFrozenData$||h&&h!==this.tableFrozenHeader$[0]||(w(this.tableFrozenData$,this.tableFrozenHeader$),r=this.tableFrozenData$.parent().outerWidth(),b.find(".a-GV-w-frozen").width(r),o=b.width()-r,b.find(".a-GV-w-scroll,.a-GV-w-hdr").width(o)),o=h&&h!==this.tableHeader$[0]?this.tableData$.parent().width():w(this.tableData$,this.tableHeader$),s){if(d=b.find(".a-GV-w-scroll")[0].clientWidth,C&&0===this.tableData$.children().length&&(d-=e.getScrollbarSize().width),o<d){if((d=d-o-1)>10)for(f=d,l=0;l<this.columns.length;l++)(i=this.columns[l]).hidden||i.frozen||i.noStretch||l===p||(_(l)?i.curWidth+=f:(u=Math.floor(d*(i.curWidth/o)),i.curWidth+=u,f-=u));else for(l=this.columns.length-1;l>0;l--)if(!((i=this.columns[l]).hidden||i.frozen||i.noStretch||l===p)){i.curWidth=i.curWidth+d;break}w(this.tableData$,this.tableHeader$)}this.tableFrozenHeader$&&(g=this.tableFrozenHeader$.find(".a-GV-header").outerHeight())!==(m=this.tableHeader$.find(".a-GV-header").outerHeight())&&(m=Math.max(g,m),this.tableData$.prev().add(this.tableFrozenData$.prev()).add(this.tableHeader$).add(this.tableFrozenHeader$).each((function(){n(this).find(".a-GV-header").first().css("height",m+"px")})))}C&&(c=b.children(".a-GV-bdy"),this._adjustSizeForScrollBars(c.height(),c.find(".a-GV-w-scroll").width()))},_renderGrid:function(){var t,s,a,l,i=this,o=this.element,r=this.options,d=r.hasSize||r.stickyTop,h=e.htmlBuilder(),c="<table role='presentation' class='a-GV-table'>",u="<thead role='rowgroup'>",f="<span class='js-tabTrap u-vh is-focusable' aria-hidden='true' tabindex='-1'></span>";function p(e,t){var s,a;for(t&&r.rowHeader!==C&&e.markup("<col").optionalAttr("width",i.rowHeaderWidth).markup("/>"),s=0;s<i.columns.length;s++)((a=i.columns[s]).frozen||!1)!==t||a.hidden||e.markup("<col").optionalAttr("width",a.width).attr("data-idx",s).markup("/>")}function m(e,t,s){var a,o,n,d,h,c,u,f,p,m=i.columns,g=i.lastFrozenColIndex+1,_=m.length;for(o=0;o<i.columnGroups.length;o++){for(c=i.columnGroups[o],e.markup("<tr class='a-GV-row' role='row'>"),a=0;a<c.length;a++)for(t&&r.rowHeader!==C&&(e.markup("<th role='columnheader' class='a-GV-headerGroup a-GV-selHeader'"),s&&e.markup(" style='visibility: hidden;'"),e.markup(">")),a=0;a<c.length;a++)((n=c[a]).frozen||!1)===t&&(d="a-GV-headerGroup",d+=x(n.headingAlignment||"center",!0),p=s?null:n.domId,e.markup("<th role='columnheader' ").attr("class",d).attr("colspan",n.span).attr("data-idx",a),s&&e.markup(" style='visibility: hidden;'"),e.markup(" tabindex='-1'><span class='a-GV-headerLabel'").optionalAttr("id",p).markup(">"+(n.heading||"")).markup("</span></th>"));e.markup("</tr>")}for(e.markup("<tr class='a-GV-row' role='row'>"),t&&(r.rowHeader!==C&&(f=null,s&&(f="visibility: hidden;"),e.markup("<th role='columnheader' class='a-GV-header a-GV-selHeader'").optionalAttr("style",f).markup("><span class='u-vh a-GV-headerLabel'").optionalAttr("id",s?null:i.idPrefix+"_shh").markup(">").markup(F("ROW_HEADER")).markup("</span>"),r.rowHeaderCheckbox&&r.multiple&&r.selectAll&&e.markup("<span class='u-selector' role='checkbox' aria-checked='false'").attr("title",F("SELECT_ALL")).markup("></span>"),"sequence"===r.rowHeader?e.markup("<span class='a-GV-rownum' aria-hidden='true'></span>"):r.rowHeader===b&&e.markup("<span class='a-GV-rowLabel'></span>"),e.markup("</th>")),g=0,_=i.lastFrozenColIndex+1),a=g;a<_;a++)(n=m[a]).hidden||(d="a-GV-header",d+=x(n.headingAlignment||"center",!0),n.isRequired&&(d+=" is-required"),n.elementId&&!n.readonly||(d+=" is-readonly"),n.headingCssClasses&&(d+=" "+n.headingCssClasses),u=null,1===n.sortIndex&&("asc"===n.sortDirection?u="ascending":"desc"===n.sortDirection&&(u="descending")),f=null,s?(f="visibility: hidden;",p=null):p=n.domId,e.markup("<th role='columnheader' ").attr("class",d).attr("data-idx",a).optionalAttr("style",f).optionalAttr("aria-sort",u).optionalAttr("aria-haspopup",r.activateColumnHeader?v:null).markup(" tabindex='-1'><span class='a-GV-headerLabel'").optionalAttr("id",p).markup(">").markup(n.heading).markup("</span>"),n.sortDirection&&(h=k("asc"===n.sortDirection?"SORTED_ASCENDING":"SORTED_DESCENDING",l>1?n.sortIndex:""),e.markup("<span class='a-GV-header-sort'><span aria-hidden='true'").attr("class","a-Icon "+("asc"===n.sortDirection?"icon-irr-sort-asc":"icon-irr-sort-desc")).attr("title",h).markup("></span><span class='u-vh'>").content(" "+h).markup("</span>"),l>1&&e.markup("<span aria-hidden='true'>").content(n.sortIndex).markup("</span>"),e.markup("</span>")),e.markup("</th>"));e.markup("</tr>")}for(a=this.lastFrozenColIndex>=0||r.rowHeader!==C,l=0,t=0;t<this.columns.length;t++)this.columns[t].sortDirection&&(l+=1);h.markup("<div class='a-GV-hdr"+(d?" a-GV-hdr--fixed":"")+"'>"),a&&(h.markup("<div class='a-GV-w-frozen'>"+c),p(h,!0),h.markup(u),m(h,!0,!1),h.markup("</thead></table></div>")),h.markup("<div class='a-GV-w-hdr'>"+c),p(h,!1),h.markup(u),m(h,!1,!1),h.markup("</thead></table></div></div><div class='a-GV-bdy'>"),this._renderAltDataMessages(h,this.idPrefix),h.markup("<div class='u-vh'").attr("id",this.accContextId).markup("></div>"),a&&(h.markup(f+"<div class='a-GV-w-frozen'>"+c),p(h,!0),h.markup(u),m(h,!0,!0),h.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(h),h.markup("</div>"+f+f)),h.markup("<div class='a-GV-w-scroll' tabindex='-1'>"+c),p(h,!1),h.markup(u),m(h,!1,!0),h.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(h),h.markup("</div>"),(a||r.autoAddRecord&&this.model.allowAdd())&&h.markup(f),h.markup("</div>"),r.editable&&h.markup("<div class='a-GV-floatingItem' tabindex='-1' style='display: none;'>").markup("<div class='a-GV-cellMoveHandle'></div>").markup("<button type='button' class='a-GV-expandCollapse' tabindex='-1'><span aria-hidden='true' class='a-Icon'></span></button>"+f+"<div class='a-GV-floatingItemContent'></div>"+f+"</div>"),this._renderFooter(h,this.idPrefix),r.columnSort&&(h.markup("<div class='a-GV-columnControls' style='display:none'>"),this._renderButton(h,"a-Button js-asc","icon-up-chevron",F("SORT_ASCENDING")),this._renderButton(h,"a-Button js-desc","icon-down-chevron",F("SORT_DESCENDING")),h.markup("</div>")),r.reorderColumns&&h.markup("<div class='a-GV-columnHandle' style='display:none'></div>").markup("<div class='a-GV-colMoveMarker' style='display:none'>").markup("<span class='a-GV-colMoveMarker-x'></span></div>"),this.floatingItem$&&this.floatingItem$.remove(),o.html(h.toString()),this._updateAccLabel(),this.pageKey=null,s=o.find(".a-GV-table>tbody,.a-GV-table>thead"),a?(this.tableFrozenHeader$=s.eq(0),this.frozenColumnCount=this.tableFrozenHeader$.children().last().children().length,this.tableHeader$=s.eq(1),this.tableFrozenData$=s.eq(3),this.tableData$=s.eq(5)):(this.tableFrozenHeader$=null,this.frozenColumnCount=0,this.tableFrozenData$=null,this.tableHeader$=s.eq(0),this.tableData$=s.eq(2)),this._clearChildrenRowCache(),this.accContext$=n("#"+this.accContextId),this.columnControls$=o.find(".a-GV-columnControls"),this.columnControls$.find("button").attr("tabindex",-1),this.columnHandle$=o.find(".a-GV-columnHandle"),this.columnMoveMarker$=o.find(".a-GV-colMoveMarker"),this.floatingItem$=o.find(".a-GV-floatingItem")},_updateAccLabel:function(){var e=this.origLabelBy;this.noData?e+=" "+this.idPrefix+"_msg":this.options.footer&&(e+=" "+this.idPrefix+"_pageRange "+this.idPrefix+"_status"),this.element.attr("aria-labelledby",e)},_calcSpanAllColumns:function(e){var t,s,a,l;for(s=0,e?(a=0,l=this.lastFrozenColIndex+1,this.options.rowHeader!==C&&(s+=1)):(a=this.lastFrozenColIndex+1,l=this.columns.length),t=a;t<l;t++)this.columns[t].hidden||(s+=1);return s},_getHeaderHeight:function(){return this.element.find(".a-GV-hdr").outerHeight()},_getStickyTop:function(){return n.isFunction(this.options.stickyTop)?this.options.stickyTop():0},_selectedCount:function(){var e=0,t=this.options;if(this.tableData$)return t.selectCells?(e=this.tableData$.find(".is-selected").filter("td,th").length,this.tableFrozenData$&&(e+=this.tableFrozenData$.find(".is-selected").filter("td,th").length)):e=t.persistSelection?this.model.getSelectedCount():this.tableData$.find("tr.is-selected").length,e},_selectedStatusMessage:function(){var e=this.options;return a.getMessage(e.selectCells?"APEX.GV.SELECTION_CELL_COUNT":e.selectionStatusMessageKey)},_deletedCount:function(){return this.tableData$.find("tr.is-deleted").length},_hasControlBreaks:function(){return this.breakColumns.length>0},_getRecordHeight:function(){var e,t;return(e=this.tableData$.find("tr").filter(":visible").first()).length?t=e.outerHeight():(e=n("<tr class='a-GV-row'><td class='a-GV-cell'></td></tr>"),t=(e=this.tableData$.append(e)).outerHeight(),this.tableData$.empty()),t},_getDataRenderContext:function(){return{hasFrozenColumns:this.lastFrozenColIndex>=0||this.options.rowHeader!==C,dataOut:e.htmlBuilder(),frozenOut:e.htmlBuilder()}},_getDataContainer:function(){return this.tableFrozenData$?n([this.tableFrozenData$[0],this.tableData$[0]]):this.tableData$},_insertFiller:function(e,t){var s,a;return e.hasFrozenColumns&&(a=n(e.frozenOut.toString()),t?t.first().before(a):this.tableFrozenData$.html(a)),s=n(e.dataOut.toString()),t?t.last().before(s):this.tableData$.html(s),e.hasFrozenColumns&&(s=n([a[0],s[0]])),this._clearChildrenRowCache(),s},_insertData:function(e,t,s,a,l){var i,o,r,d,h,c=this;e.hasFrozenColumns&&(r=S(e.frozenOut)),o=S(e.dataOut),a?(e.hasFrozenColumns&&a.first()[l](r),a.last()[l](o)):(e.hasFrozenColumns&&this.tableFrozenData$.append(r),this.tableData$.append(o)),this._clearChildrenRowCache(),this.allSelected&&this.options.pagination.scroll&&(d=o.map((function(e,t){return n(t).children()[0]})),h=this.focusInHeader,this.focusInHeader=!1,this._select(d,"add",null,!1),this.focusInHeader=h),this.options.hasSize&&(i=this.element.children(".a-GV-bdy"),this._adjustSizeForScrollBars(i.height(),i.find(".a-GV-w-scroll").width())),this.gotoCellPending&&setTimeout((function(){c.gotoCell(c.gotoCellPending.record,c.gotoCellPending.column)}),0),this._trigger("pageChange",null,{offset:t,count:s})},_controlBreakLabel:function(t){var s,a,l,i,o=this.options,n="",r=[];for(s=0;s<this.breakColumns.length;s++)a=this.breakColumns[s],s>0&&(n+=", "),l=this.model.getValue(t,a.property),r[s]=l,null===l&&(l=""),"object"==typeof l&&l.hasOwnProperty("d")?l=l.d:(i=this.columnItems[a.property])&&(l=i.item.displayValueFor(l)),""===l&&o.showNullAs&&(l=o.showNullAs),!1!==a.escape&&(l=e.escapeHTML(l)),(a.label||a.heading)&&(n+="<span class='a-GV-breakLabel'>"+(a.label?e.escapeHTML(a.label):a.heading)+":</span> "),n+="<span class='a-GV-breakValue'> "+l+"</span>";return{label:n,values:r}},_renderBreakRecord:function(e,t,s,a){var l=s.label;e.hasFrozenColumns&&(this._renderBreakRow(e.frozenOut,!0,t,l,a),t=!1),this._renderBreakRow(e.dataOut,!1,t,l,a),this.controlBreakCollapsed=!1,this.controlBreaks.push({offset:a+1,label:l,values:s.values}),this.controlBreaks.sort(D)},_renderFillerRecord:function(e,t){e.hasFrozenColumns&&e.frozenOut.markup("<tr class='"+t+"'><td ").attr("colspan",this._calcSpanAllColumns(!0)).markup("></td></tr>"),e.dataOut.markup("<tr class='"+t+"'><td ").attr("colspan",this._calcSpanAllColumns(!1)).markup("></td></tr>")},_renderRecord:function(e,t,s,a,l){e.hasFrozenColumns&&this._renderRow(e.frozenOut,t,s,a,l,!0),this._renderRow(e.dataOut,t,s,a,l,!1)},_insertRecord:function(t,s,a,l,i){var o,r=this,d=this.lastFrozenColIndex>=0||this.options.rowHeader!==C,c=e.htmlBuilder(),u=[];function f(e){var o;r._renderRow(c,s,null,a,l,e),o=S(c),u.push(o[0]),"after"===i&&t?(e?t.first():t.last()).after(o):(e?r.tableFrozenData$:r.tableData$).prepend(o)}return!t&&r._hasControlBreaks()&&((o=n(this.lastFocused).closest("."+h)).length||(o=this.tableData$.find("."+h).first()),1===o.length&&this.tableFrozenHeader$&&(t=o.add(this._getOtherTable(o)[this._rowIndex(o)])),t&&this._expandCollapseControlBreak([t],!0),i="after"),d&&(f(!0),c.clear()),f(!1),this._clearChildrenRowCache(),n(u)},_afterInsert:function(e,t){var s,a,l=!!this.element.find("."+f).length||n(document.activeElement).hasClass("js-autoAdd"),i=e[0].find(".a-GV-cell").first();for(s=0;s<this.columns.length;s++)if(!(a=this.columns[s]).hidden&&!a.readonly&&this.columnItems[a.property]){i=E(e[0],this.fieldToColumnIndex[a.property]);break}if(this._hasControlBreaks()&&!t&&e[0]){let t,l,i,o=e[0].prev().attr("data-rownum");if(null!=o)for(t=this._getControlBreak(parseInt(o,10)),l=this.model.getRecord(e[0].attr("data-id")),i=t.values,s=0;s<this.breakColumns.length;s++)(a=this.breakColumns[s]).readonly||this.model.setValue(l,a.property,i[s])}setTimeout(()=>{this._select(i,null,l,!1,!1),l&&this.options.editable&&!this.editMode&&this.setEditMode(!0)},0)},_updateRecordField:function(t,s,a,l){var i,o,n,r,d=this.fieldToColumnIndex[a],h=e.htmlBuilder();void 0!==d&&(i=E(t,d),this.editMode&&s===this.activeRecord&&!this.ignoreItemChange&&(o=this.columnItems[a])&&this._setColumnItemValue(o.item,s,a),i.hasClass(p)||(n=this.options.columns[0][a],r=null,l.fields&&(r=l.fields[n.property]),h=e.htmlBuilder(),this._renderFieldDataValue(h,n,s,l,r),i.html(h.toString())))},_updateRecordState:function(e,t,s,a){var l,i,o,n,r,d=this.options,h=!this.tooltipOptions;if(n=$(a,d,e.hasClass(u),this.model,s),e.attr("class",n),h&&(a.message?e.first().find(".a-GV-selHeader").attr("title",a.message):e.first().find(".a-GV-selHeader").removeAttr("title")),a.fields)for(l in a.fields)if(a.fields.hasOwnProperty(l)){if(i=a.fields[l],void 0===(r=this.fieldToColumnIndex[l]))continue;o=E(e,r),n=y(d.columns[0][l],a,i,d,o,this.model,s),o.attr("class",n),h&&(i.message&&!a.deleted?o.attr("title",i.message):o.removeAttr("title"))}},_removeRecord:function(e){e.remove()},_identityChanged:function(e,t){this._elementsFromRecordIds([e])[0].attr("data-id",t),this.activeRecordId===e&&(this.activeRecordId=t)},_replaceRecord:function(t,s,a,l,i){var o,r,d,h,c,p,m,g,b=null,v=null,_=[],w=t.first().children().first().find(".a-GV-rownum").text()||null,G=this.lastFrozenColIndex>=0||this.options.rowHeader!==C,H=e.htmlBuilder();w&&(w=parseInt(w,10)-1),this.activeRecordId===a&&(this.activeRecord=this.activeRecordId=null),r=t.hasClass(u),(d=t.find(this.lastFocused).length)&&(c=z(g=this.lastFocused).hasClass(f)),(h=t.find(this.lastEditModeCell).length&&n(this.lastEditModeCell).hasClass(f))&&(g=this.lastEditModeCell),g&&(b=0,v=R(M(g))),G&&(g&&t.last().find(g).length&&(b=1),this._renderRow(H,s,w,l,i,!0),o=S(H),_.push(o[0]),t.first().replaceWith(o),H.clear()),this._renderRow(H,s,w,l,i,!1),o=S(H),_.push(o[0]),t.last().replaceWith(o),this._clearChildrenRowCache(),o=n(_),r&&o.add(o.find(".a-GV-selHeader .u-selector")).addClass(u).attr("aria-selected",!0),h?this._activateCell(E(o.eq(b),v)):d&&(m=E(o.eq(b),v),p=this._getCellFocusable(m),this._setFocusable(p),this._setCurrentRow(m[0]),c&&this._setFocus(p))},_removeFocus:function(e){var t,s,a;((t=n(this.lastFocused).closest("tr"))[0]===e[0]||e.length>1&&t[0]===e[1])&&(s=T(this.lastFocused),(a=this._getNextCellDown(s,1))||(a=this._getPrevCellUp(s,1)),a&&this._select(a,null,!0,!1))},_elementsFromRecordIds:function(e){var t,s,a=!0,l=[],i={};for(t=0;t<e.length;t++)i[e[t]]=t,l[t]=null;return this.tableFrozenData$||(a=!1),a&&(s=this.tableFrozenData$.children()),this.tableData$.children().each((function(e){var t=n(this),o=t.attr("data-id");void 0!==i[o]&&(l[i[o]]=a?n([s[e],this]):t)})),l},_renderBreakRow:function(e,t,s,a,l){var i;i=this._calcSpanAllColumns(t),e.markup("<tr role='row' class='"+h+" is-expanded'").optionalAttr("data-rownum",null!=l?l+1:null).markup("><th role='rowheader' class='a-GV-controlBreakHeader'").attr("colspan",i).markup(">"),s&&this.options.collapsibleControlBreaks&&this._renderButton(e,"a-Button js-toggleBreak","icon-down-arrow",F("BREAK_COLLAPSE")),e.markup("<span class='a-GV-controlBreakLabel'>").markup(a).markup("</span></th></tr>")},_getControlBreak:function(e){var t,s=null;return this.breakColumns.length>0&&(t=function(e,t,s){for(var a,l,i=0,o=e.length-1;i<=o;)if((l=s(t,e[a=o+i>>1]))>0)i=a+1;else{if(!(l<0))return a;o=a-1}return i}(this.controlBreaks,{offset:e},D),(s=this.controlBreaks[t])&&s.offset===e||(s=this.controlBreaks[t-1])),s},_renderRow:function(e,t,s,a,l,i){var o,n,r,d,c,f,p,m,g=null,_=null,w=null,G=this.options,H=this.columns,I=this.lastFrozenColIndex+1,x=H.length,V=!this.tooltipOptions;for(r=$(l,G,null,this.model,t),l.agg?g=l.grandTotal?G.aggregateLabels[l.agg].overallLabel:G.aggregateLabels[l.agg].label:!l.deleted&&l.message&&V&&(_=l.message),f=void 0!==l.serverOffset?l.serverOffset+1:"",null===this.controlBreakCollapsed&&this._hasControlBreaks()&&(this.controlBreakCollapsed=!1,(m=this._getControlBreak(f))&&(this.tableData$.find("."+h+"[data-rownum='"+m.offset+"']").hasClass("is-expanded")||this._controlBreakLabel(t).label!==m.label||(this.controlBreakCollapsed=!0))),e.markup("<tr role='row'").attr("data-id",a).optionalAttr("data-rownum",f).attr("class",r).optionalAttr("title",g).optionalAttr("aria-selected",l.sel?v:null).optionalAttr("style",this.controlBreakCollapsed&&!l.agg?"display:none;":null).markup(">"),i&&G.rowHeader!==C&&(p=l.agg||G.rowHeader===b,e.markup("<th role='rowheader'").attr("class","a-GV-cell a-GV-selHeader"+(p?" a-GV-rowHeader":"")).optionalAttr("title",_).markup(">"),l.agg||(G.rowHeaderCheckbox&&(d=G.multiple?"u-selector":"u-selector u-selector--single",l.sel&&(d+=" "+u),e.markup("<span class='"+d+"'").attr("title",F("SELECT_ROW")).markup("></span>")),"sequence"===G.rowHeader&&e.markup("<span class='a-GV-rownum' aria-hidden='true'>").content(f).markup("</span>")),p&&(e.markup("<span class='a-GV-rowLabel'>"),l.agg?e.content(G.aggregateLabels[l.agg][l.grandTotal?"overallLabel":"label"]):G.rowHeaderLabelColumn&&e.markup(this.model.getValue(t,G.rowHeaderLabelColumn)),e.markup("</span>")),e.markup("</th>")),i&&(I=0,x=this.lastFrozenColIndex+1),o=I;o<x;o++)n=H[o],c=null,l.fields&&(c=l.fields[n.property]),n.hidden||(r=y(n,l,c,G,null,this.model,t),w=null,V&&(c&&c.message?w=c.message:l.agg&&(w=G.aggregateTooltips[l.agg+"|"+n.property])),e.markup("<td role='gridcell' tabindex='-1'").attr("class",r).optionalAttr("title",w).markup(">"),this._renderFieldDataValue(e,n,t,l,c),e.markup("</td>"));e.markup("</tr>")},_getColumnMetadata:function(e){var t,s;if(e.hasClass("a-GV-cell"))t=R(e),s=(e.closest(".a-GV-w-frozen").length?this.tableFrozenHeader$:this.tableHeader$).children().last().children().eq(t);else{if(!e.hasClass("a-GV-header"))return null;s=e}return t=parseInt(s.attr("data-idx"),10),isNaN(t)?null:this.columns[t]},_activateColumnHeader:function(e,t){var s=this._getColumnMetadata(t);s.noHeaderActivate||this._trigger("activateColumnHeader",e,{header$:t,column:s})},_activateRow:function(e){var t,s,a,l,i,o,n,r=e.parent(),d=r.attr("data-id"),h=this;for(l=this.model.getRecord(d),i=this.model.getRecordId(l),n=this.model.allowEdit(l),o=this.model.getRecordMetadata(i),r.addClass(p),this._beginSetColumnItems(),t=0;t<this.columns.length;t++)a=this.columns[t].property,(s=this.columnItems[a])&&this._setColumnItemValue(s.item,l,a,n?o:null);this.activeRecord=l,this.activeRecordId=i,this._endSetColumnItems(),setTimeout((function(){h._triggerBeginEditing(h.activeRecord,h.activeRecordId)}),0)},_deactivateRow:function(e){var t,s,a,l,i,o,n=this.element.find(".a-GV-row.is-active");if(this.activeLockCount>0)this.activeUnlockCallback=e;else{if(n.removeClass(p),(l=this.model.getRecordMetadata(this.activeRecordId))&&!l.deleted&&this.model.allowEdit(this.activeRecord))for(t=0;t<this.columns.length;t++)a=this.columns[t].property,(s=this.columnItems[a])&&((o=s.item.isDisabled())?this.model.setValidity("valid",this.activeRecordId,a):s.item.getValidity().valid||this.model.setValidity("error",this.activeRecordId,a,s.item.getValidationMessage()),((i=l.fields?l.fields[a]:null)&&i.hasOwnProperty("disabled")||o)&&(i||(l.fields||(l.fields={}),i={},l.fields[a]=i),i.disabled=o));this._triggerEndEditing(this.activeRecord,this.activeRecordId),this.activeRecord=null,this.activeRecordId=null,e()}},_beginDeactivate:function(e,t){var s=this;this.deactivateDelayTimer||(this.deactivateDelayTimer=setTimeout((function(){s.lastEditModeCell=null,s._deactivateCell(e),t&&(s.dontFocusEditableItem=!0,e.focus()),s.deactivateDelayTimer=null}),10))},_clearDeactivate:function(){this.deactivateDelayTimer&&(clearTimeout(this.deactivateDelayTimer),this.deactivateDelayTimer=null)},_setTabTraps:function(e){var t,s,a,l,i,o=this.options.autoAddRecord&&this.model.allowAdd(),n=this.tabTraps$;e.attr("tabindex",-1),t=this._nextCellWithWrap(e).attr("tabindex",0),s=this._prevCellWithWrap(e).attr("tabindex",0),l=null,this.tableFrozenData$?(l=3,a=5,n.eq(0).prop("tabIndex",s.length?0:-1),i=1===e.parent().children().length,n.eq(1).prop("tabIndex",i?0:-1),n.eq(2).prop("tabIndex",i?0:-1)):o?(l=0,a=2):a=1,null!==l&&(o&&this.onLastPage&&0===t.length?n.eq(l).prop("tabIndex",0).addClass("js-autoAdd"):n.eq(l).prop("tabIndex",t.length?0:-1).removeClass("js-autoAdd")),o&&this.onLastPage&&0===t.length?n.eq(a).prop("tabIndex",0).toggleClass("js-last",!t.length).addClass("js-autoAdd"):n.eq(a).prop("tabIndex",t.length?0:-1).toggleClass("js-last",!t.length).removeClass("js-autoAdd")},_clearTabTraps:function(){this.element.find(".a-GV-cell[tabindex='0'],.a-GV-controlBreakHeader[tabindex='0']").attr("tabindex",-1),this.tabTraps$.prop("tabIndex",-1)},_activateCell:function(e,t){var s,a,l=this,i=!1,o=null,r=null,d=e.hasClass(c);function h(e){(t=t||l._getCellFocusable(e))!==e[0]&&t.focus()}function f(){(s=l._getColumnMetadata(e))&&(o=l.columnItems[s.property]),o&&l.model.allowEdit(l.activeRecord)&&!s.readonly&&!e.hasClass("is-readonly")?(e.addClass(p),(a=o.item.getPopupSelector())&&n(document.body).on("focusin.gridpopup",(function(e){n(e.target).closest(a).length&&l._clearDeactivate()})).on("focusout.gridpopup",(function(e){var t;n(e.target).closest(a).length&&(t=n(l.lastEditModeCell),l._beginDeactivate(t,!0))})),r=o.element$.height(),o.element$=o.element$.detach(),r>e.height()?(e.empty(),l.floatingItem$.children(".a-GV-floatingItemContent").append(o.element$),l._expandFloatingItem(e)):e.empty().append(o.element$),l._activateColumnItem(o,s.domId),l.dontFocusEditableItem||o.item.isDisabled()||o.item.setFocus(),l.dontFocusEditableItem=!1,i=!0,l._savedActivationtarget&&(l._interactWithCellItem(n.Event("activate",{target:l._savedActivationtarget}),e,s,o.item),l._savedActivationtarget=null)):h(e)}if(this.lastEditModeCell=e[0],e.parent().hasClass(u)?this.lastRow$&&this.lastRow$.index(e)>=0||this._setCurrentRow(e[0]):this._select(e,null,!1,!1),this._setFocusable(e[0]),this._setTabTraps(e),!this.activeRecord||this.activeRecordId!==e.parent().attr("data-id")){if(this.activeRecord)return void this._deactivateRow((function(){d?h(e):(l._activateRow(e),f())}));d?h(e):this._activateRow(e)}return d?h(e):f(),i},_checkInteractWithCellItem:function(e,t,s){var a,l=!1,i=this._getColumnMetadata(s),o=i&&this.columnItems[i.property];return o&&(o=o.item)&&o.getInteractionSelector&&(a=o.getInteractionSelector(),t.closest(a).length&&(e?(this._interactWithCellItem(e,s,i,o),l=!0):this._savedActivationtarget=t[0])),l},_interactWithCellItem:function(e,t,s,a){var l=t.parent().attr("data-id"),i=this.model.getRecord(l);"activate"===e.type?a.onInteraction(e):!this.model.allowEdit(i)||s.readonly||t.hasClass("is-readonly")||a.onInteraction(e,this.model,i,s.property)},_expandFloatingItem:function(e){var t,s,a,l=this.element.hasClass("u-RTL")?"right top":"left top",i=e.outerWidth(),o=this._getColumnMetadata(e).property;this.floatingItem$.css("position","").css("min-width",i+"px").appendTo("body").show().addClass("is-expanded").draggable("enable").attr("data-owning-region",this.element[0].id).find(".a-GV-expandCollapse span").removeClass("icon-ig-expand").addClass("icon-ig-restore"),this.floatingItem$.children(".a-GV-floatingItemContent").show().css({width:"",height:""}),(a=this.lastFloatingPos[o])?this.floatingItem$.css({left:a.left,top:a.top}):this.floatingItem$.position({my:l,at:l,of:e,collision:"fit fit"}),this.floatingItem$.find(".js-tabTrap").not(".js-last").attr("tabindex",0),(t=this._getColumnMetadata(e))&&((s=this.columnItems[t.property]).item.isDisabled()||s.item.setFocus())},_collapseFloatingItem:function(e){var t=e.innerWidth(),s=e.innerHeight();this.floatingItem$.css({position:"relative",left:"",top:""}).appendTo(e).draggable("disable").removeClass("is-expanded ui-state-disabled").removeAttr("data-owning-region").find(".a-GV-expandCollapse span").removeClass("icon-ig-restore").addClass("icon-ig-expand"),this.floatingItem$.children(".a-GV-floatingItemContent").hide().width(t).height(s),this.floatingItem$.find(".a-GV-expandCollapse").focus(),this.floatingItem$.find(".js-tabTrap").not(".js-last").attr("tabindex",-1)},_deactivateCell:function(t){var s,a,l,i,o=null;t.length<=0||(this._clearTabTraps(),this._setFocusable(t[0]),(s=this._getColumnMetadata(t))&&(o=this.columnItems[s.property]),o&&t.hasClass(p)&&(n(document.body).off(".gridpopup"),this._setModelValue(t,o.item,this.activeRecord,s.property),i=null,(l=this.model.getRecordMetadata(this.activeRecordId)).fields&&(i=l.fields[s.property]),this.debugDontDeactivateCell?t.addClass(f+" "+p):(this.floatingItem$.appendTo("body"),this.floatingItem$.hide(),this._deactivateColumnItem(o),a=e.htmlBuilder(),this._renderFieldDataValue(a,s,this.activeRecord,l,i),t.html(a.toString())),this._updateRecordState(this.lastRow$.parent(),this.activeRecordId,this.activeRecord,l)))},_finishEditing:function(e){var t,s=n(this.lastEditModeCell);s.length&&(t=s.hasClass(f),this._clearDeactivate(),this._deactivateCell(s),t&&this._activateCell(s)),e.resolve()},_setFocus:function(e){e.tabIndex=0,e.focus()},_setFocusable:function(t){var s,a,l,i,o,d,u,f,p,m,g,C,b,v=this,_=this.options.tabbableCellContent,w=z(t);function G(e){var t,s,a,l;for(t=0;t<v.columnGroups.length;t++)for(a=v.columnGroups[t],s=0;s<a.length;s++)if((l=a[s]).property===e)return l;return null}if(this.lastFocused&&(n(this.lastFocused).removeAttr("aria-labelledby").closest("td,th").removeAttr("id"),a=z(this.lastFocused),w[0]!==a[0]&&a.add(a.find(_).not(":disabled,.js-asc,.js-desc")).prop("tabIndex",-1)),f=(C=w.closest("tr")).attr("data-rownum"),p=null,(w.hasClass(c)||w.hasClass("a-GV-headerGroup"))&&(p=this.lastColIndex),null===p&&(p=W(w)),this.tableFrozenHeader$&&!w.closest("tr").closest(r).parent().hasClass("a-GV-w-frozen")&&(p+=this.frozenColumnCount),p+=1,C.hasClass(h)?(f+="b",m=F("BREAK_CONTEXT")):C.hasClass("is-aggregate")?m=F("AGG_CONTEXT"):w.hasClass("a-GV-header")?m=F("HEADER_CONTEXT"):w.hasClass("a-GV-headerGroup")?m=F("GROUP_CONTEXT"):(f!==this.curRowNum&&p!==this.curColNum?m=k("ROW_COLUMN_CONTEXT",f,p):f!==this.curRowNum?m=k("ROW_CONTEXT",f):p!==this.curColNum&&(m=k("COLUMN_CONTEXT",p)),(b=this._getControlBreak(parseInt(f,10)))&&b.offset!==this.curControlBreak&&(m=F("BREAK_CONTEXT")+" "+e.stripHTML(b.label)+"."+m)),m&&this.accContext$.text(m+" "),l=0,w.children(".a-GV-columnItem")[0]||(l=w.find(_).not(":disabled,.js-asc,.js-desc").prop("tabIndex",0).length),l||w.prop("tabIndex",0),this.lastFocused=t,i="",f!==this.curRowNum&&(this.curRowHeaders&&n(this.curRowHeaders).removeAttr("id"),this.curRowHeaders="",(C=this._getRowForCell(w)).find(".a-GV-rowHeader").not(w).each((function(e){var t=v.idPrefix+"_rh_"+e;n(this).attr("id",t),i+=t+" ",v.curRowHeaders&&(v.curRowHeaders+=","),v.curRowHeaders+="#"+t}))),p!==this.curColNum&&!this.focusInHeader)if((s=this._getColumnMetadata(w))&&s.domId){for(o="",d=L(s);d;)(u=G(d))&&u.domId&&(o=u.domId+" "+o),d=u.parentGroupName;o+=s.domId,i+=o+" "}else w.hasClass("a-GV-selHeader")&&(i+=this.idPrefix+"_shh ");g=this.idPrefix+"_cur",i+=g,i=this.accContextId+" "+i,n(t).attr("aria-labelledby",i).closest("td,th").attr("id",g),this.curRowNum=f,this.curColNum=p,this.curControlBreak=b?b.offset:null},_getCellFocusable:function(e){var t=e.find(this.options.tabbableCellContent).not(":disabled,.js-asc,.js-desc");return t.length?t[0]:e[0]},_getPrevCellUp:function(e,t,s){var a,l=null,i=null;return(e.hasClass(c)||e.hasClass("a-GV-headerGroup"))&&(i=this.lastColIndex),null===i&&(i=W(e),this.lastColIndex=i),e.closest("tr").prevAll(":visible").each((function(e){var s=n(this);return!s.hasClass("a-GV-scrollFiller")&&(a=s,e<t-1)})),this.focusInHeader||s||a||(this.focusInHeader=!0,a=e.closest("tr").closest(r).parent().hasClass("a-GV-w-frozen")?this.tableFrozenHeader$.children().last():this.tableHeader$.children().last()),a&&(l=a.hasClass(h)?a.children().first():E(a,i)),l},_getNextCellDown:function(e,t){var s,a=null,l=null;return(e.hasClass(c)||e.hasClass("a-GV-headerGroup"))&&(l=this.lastColIndex),null===l&&(l=W(e),this.lastColIndex=l),e.closest("tr").nextAll(":visible").each((function(e){var a=n(this);return!a.hasClass("a-GV-scrollFiller")&&(s=a,e<t-1)})),this.focusInHeader&&!s&&(this.focusInHeader=!1,s=e.closest("tr").closest(r).parent().hasClass("a-GV-w-frozen")?this.tableFrozenData$.children().first():this.tableData$.children().first()),s&&(a=s.hasClass(h)?s.children().first():E(s,l)),a},_copy:function(e){var t,s,a,l,i,o,n,r,d,h,c=this.model,u=this.options,f=u.dataTransferFormats;if(u.selectCells){if(r=[],!(a=this.getSelectedRange())||!a.values.length)return;for(r=a.columns.map((function(e){return e?u.columns[0][e]:null})),f.forEach((function(e){e.writer.begin(c,a,r)})),t=0;t<a.values.length;t++){for(d=a.recordIds[t],n=null!==d?c.getRecord(d):null,f.forEach((function(e){e.writer.beginRow(t,n,d)})),o=a.values[t],s=0;s<o.length;s++)h=n&&r[s]?c.getValue(n,r[s].property):"",f.forEach((function(e){e.writer.cell(s,r[s],h,o[s])}));f.forEach((function(e){e.writer.endRow()}))}}else{if(!(a=this.getSelection()).length)return;for(r=[],"NONE"!==u.rowHeader&&r.push(null),this.getColumns().forEach((function(e){e.hidden||r.push(e)})),f.forEach((function(e){e.writer.begin(c,a,r)})),t=0;t<a.length;t++){for(l=a[t],d=l.first().attr("data-id"),n=null!==d?c.getRecord(d):null,f.forEach((function(e){e.writer.beginRow(t,n,d)})),i=l.children(),s=0;s<i.length;s++)h=n&&r[s]?c.getValue(n,r[s].property):"",f.forEach((function(e){e.writer.cell(s,r[s],h,i.eq(s).text())}));f.forEach((function(e){e.writer.endRow()}))}f.forEach((function(e){e.writer.end()}))}f.forEach((function(t){t.writer.end(),e.setData(t.format,t.writer.toString())}))},_setSelectionMode:function(){var e=this.options,t=this.element.children(".a-GV-bdy").find(".is-selected");this.element.toggleClass("a-GV--selectCells",e.selectCells),t.removeClass(u).removeAttr("aria-selected"),e.persistSelection&&this.model.clearSelection(),this.allSelected=!1,this.lastFocused&&t[0]&&this._select(n(this.lastFocused),null,!1)},_select:function(t,s,a,l,i){var o,r,d,h,c,f,p,m,g,C,b,w,G,H,I,x,V,$,y,F,k,D,S,z=!1,M=this.options,T="set",E=this;function W(e,t){var s;M.persistSelection&&(s=e.length,E.tableFrozenHeader$&&(s/=2),e.each((function(e){var a;if(e>=s)return!1;a=n(this).attr("data-id"),t&&!1===I[a]?delete I[a]:I[a]=t})))}function A(e,t){var s=n(t);if(e>d)return!1;e>=r&&s.hasClass("a-GV-row")&&!s.hasClass("is-aggregate")&&(M.allowSelectHidden||s.is(":visible"))&&s.children().slice(F,k).addClass(u).attr("aria-selected",!0)}function P(e,t){var s=n(t);s.hasClass("a-GV-row")&&!s.hasClass("is-aggregate")&&(M.allowSelectHidden||s.is(":visible"))&&G.push(t)}if(M.persistSelection&&(I={}),"unset"===s||M.allowSelectHidden||(t=t.filter(":visible")),m=t.parent("tr"),x=this.lastRow$&&this.lastRow$.index(t.first())>=0,this.tableFrozenHeader$&&(G=[],w=E._getOtherTable(m.first()),m.each((function(){G.push(w[E._rowIndex(n(this))])})),m=m.add(n(G))),s&&(M.selectCells&&M.multipleCells||!M.selectCells&&M.multiple)&&("string"==typeof s?T=s:"click"===s.type?s.ctrlKey||s.metaKey?T="toggle":s.shiftKey&&(T="range"):"keydown"===s.type&&(s.which===_.SPACE?T=s.ctrlKey?"toggle":s.shiftKey?"range":"add":s.ctrlKey?T="none":s.shiftKey&&(T="range")),M.selectCells&&"range"!==T&&(T="set"),s.target||(s=null)),"range"!==T||this.selectAnchor&&!this.focusInHeader||(T="set"),!this.focusInHeader)if("set"!==T&&"range"!==T||(D=this.element.children(".a-GV-bdy").find(M.selectCells?"td.is-selected,th.is-selected":"tr.is-selected"),M.rowHeaderCheckbox&&D.find(".u-selector").removeClass(u),D.removeClass(u).removeAttr("aria-selected"),M.persistSelection&&this.model.clearSelection()),M.selectCells)"range"===T?(V=n(this.selectAnchor),r=R(V.parent()),d=R(t.last().parent()),r>d&&(f=d,d=r,r=f),h=R(V),$=this.tableFrozenData$&&V.closest(this.tableFrozenData$).length>0,c=R(t.last()),($===(y=this.tableFrozenData$&&t.last().closest(this.tableFrozenData$).length>0)&&h>c||$!==y&&!$)&&(f=c,c=h,h=f,f=y,y=$,$=f),this.tableData$&&!y&&(F=h,k=c+1,$!==y&&(F=0),this.tableData$.children().each(A)),$&&this.tableFrozenData$&&(F=h,k=c+1,$!==y&&(k=void 0),this.tableFrozenData$.children().each(A))):(t.addClass(u).attr("aria-selected",!0),this.selectAnchor=t[0]);else if(o=m.hasClass(u),g=m.filter(".a-GV-row").not(".is-aggregate"),"set"===T||"add"===T||"toggle"===T&&!o?(g.addClass(u).attr("aria-selected",!0),this.selectAnchor=g[0],z=!0):"range"===T?(r=this._rowIndex(n(this.selectAnchor)),d=this._rowIndex(m.last()),r>d&&(f=d,d=r,r=f),d+=1,G=[],this.tableDataChildren$.slice(r,d).each(P),this.tableFrozenData$&&this.tableFrozenDataChildren$.slice(r,d).each(P),(g=n(G)).addClass(u).attr("aria-selected",!0),z=!0):("toggle"===T&&o||"unset"===T)&&(g.removeClass(u).removeAttr("aria-selected"),this.selectAnchor=g[0],M.rowHeaderCheckbox&&g.find(".u-selector").removeClass(u),W(g,!1)),z&&(M.rowHeaderCheckbox&&g.find(".u-selector").addClass(u),W(g,!0)),M.multiple&&M.selectAll&&(C=(this.tableFrozenData$||this.tableData$).children(".a-GV-row").not(".is-aggregate"),M.allowSelectHidden||(C=C.filter(":visible")),this.allSelected=b=C.length>0&&C.length===C.filter(".is-selected").length,M.rowHeaderCheckbox&&this.tableFrozenHeader$.find(".u-selector").first().toggleClass(u,b).attr("aria-checked",b?v:"false").closest(".a-GV-selHeader").toggleClass(u,b)),M.persistSelection)for(H in I)I.hasOwnProperty(H)&&this.model.setSelectionState(H,I[H]);t.length>0&&null!==a&&(p=this._getCellFocusable(t.first()),a?this._setFocus(p):this._setFocusable(p),x||this._setCurrentRow(t[0])),this.focusInHeader||"toggle"!==T&&"unset"!==T&&("range"!==T||!M.selectCells&&o)&&("add"!==T||o)&&("set"!==T||!M.selectCells&&e.arrayEqual(D,g))||(S=!(i||M.navigation&&s&&"click"===s.type),l?B(this,S,s):N(this,S,s))},_clearChildrenRowCache:function(){this.tableFrozenDataChildren$=this.tableDataChildren$=null},_getOtherTable:function(e){var t,s=e.closest(r).parent().hasClass("a-GV-w-frozen");return e.parents(".a-GV-bdy").length?s?(this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),t=this.tableDataChildren$):(this.tableFrozenDataChildren$||(this.tableFrozenDataChildren$=this.tableFrozenData$.children()),t=this.tableFrozenDataChildren$):t=(s?this.tableHeader$:this.tableFrozenHeader$).children(),t},_rowIndex:function(e){var t=e.closest(r).parent().hasClass("a-GV-w-frozen");return e.parents(".a-GV-bdy").length?(this.tableFrozenData$&&!this.tableFrozenDataChildren$&&(this.tableFrozenDataChildren$=this.tableFrozenData$.children()),this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),(t?this.tableFrozenDataChildren$:this.tableDataChildren$).index(e)):R(e)},_getRowForCell:function(e){var t=e.closest("tr");return this.tableFrozenHeader$&&(t=t.add(this._getOtherTable(t).eq(this._rowIndex(t)))),t},_setCurrentRow:function(e){this.lastRow$=this._getRowForCell(n(e)).children()},_fireActivate:function(e,t){var s=this._getRowForCell(t);this._trigger("activateCell",e,{cell$:t,row$:s})},_nextCellWithWrap:function(e){var t,s=this.options.skipReadonlyCells,a=this;function l(e){for(;s&&e.hasClass("is-aggregate")||e.not(":visible").length;)e=e.next();return e.children().first()}function i(e){var t,s,i,o=e.next();return o.length||(t=e.closest("tr"),a.tableFrozenHeader$?(s=a._getOtherTable(t),i=a._rowIndex(t),o=t.closest(r).parent().hasClass("a-GV-w-frozen")?s.eq(i).children().first():l(t=s.eq(i+1))):o=l(t=t.next())),o}if(t=i(e),s)for(;t.hasClass("is-readonly");)t=i(t);return t},_prevCellWithWrap:function(e){var t,s=this.options.skipReadonlyCells,a=this;function l(e){for(;s&&e.hasClass("is-aggregate")||e.not(":visible").length;)e=e.prev();return e.children().last()}function i(e){var t,s,i,o=e.prev();return o.length||(t=e.closest("tr"),a.tableFrozenHeader$?(s=a._getOtherTable(t),i=a._rowIndex(t),t.closest(r).parent().hasClass("a-GV-w-frozen")?(i-=1)>=0&&(o=l(t=s.eq(i))):o=s.eq(i).children().last()):o=l(t=t.prev())),o}if(t=i(e),s)for(;t.hasClass("is-readonly");)t=i(t);return t},_clearHoverStates:function(){this.element.find(".is-hover").removeClass("is-hover"),this.columnControls$.hide(),this.columnHandle$.hide()},_setRowHoverState:function(e){this.element.find(".is-hover").removeClass("is-hover"),(e=this._getRowForCell(e.children().eq(0))).addClass("is-hover")},_sortChange:function(e,t,s){var a,l="set",i=this._getColumnMetadata(t);i.canSort&&(a=s===i.sortDirection,this.options.columnSortMultiple&&e.shiftKey?(l="add",l=a?"remove":i.sortDirection?"change":"add"):a&&(l="clear"),this._trigger("sortChange",e,{header$:t,column:i,direction:s,action:l}))},_updateColumnControls:function(e){var t,s,a=!1,l=!1;"asc"===e.sortDirection?(t=F("SORT_OFF"),s=F("SORT_DESCENDING"),a=!0):"desc"===e.sortDirection?(t=F("SORT_ASCENDING"),s=F("SORT_OFF"),l=!0):(t=F("SORT_ASCENDING"),s=F("SORT_DESCENDING")),this.columnControls$.find(".js-asc").attr("title",t).attr("aria-label",t).toggleClass(p,a),this.columnControls$.find(".js-desc").attr("title",s).attr("aria-label",s).toggleClass(p,l)},_adjustSizeForScrollBars:function(t,s,a){var l=this.element.children(),i=l.filter(".a-GV-bdy").children(".a-GV-w-frozen"),o=l.filter(".a-GV-hdr").children(".a-GV-w-hdr"),n=function(e,t){var s=e.parent()[0],a={h:!1,v:!1};return e.outerHeight()+(t||parseInt(e.css("margin-top"),10))>s.clientHeight&&(a.v=!0),e.outerWidth()>s.clientWidth&&(a.h=!0),a}(this.tableData$.parent(),a);n.h&&(t-=e.getScrollbarSize().height),i.height(t),n.v&&(s-=e.getScrollbarSize().width),o.width(s)},_headerScrollCheck:function(e,t,s){var a,l,i,o=0,r=this.hdrScrollParent;return r&&(i=n(this.hdrScrollParent).offset().left,this.element.hasClass("u-RTL")?(e-t-i<10?o=-10:i+r.offsetWidth-e<10&&i+r.offsetWidth-e>0&&(o=10),s&&o&&((a=r.scrollLeft+o)>0?(r.scrollLeft=0,o=0):a>r.scrollWidth-r.clientWidth?(r.scrollLeft=r.scrollWidth-r.clientWidth,o=0):r.scrollLeft=a)):(i+r.offsetWidth-(e+t)<10?o=10:e-i<10&&e-i>0&&(o=-10),s&&o&&((a=r.scrollLeft+o)<0?(r.scrollLeft=0,o=0):a>r.scrollWidth-r.clientWidth?(r.scrollLeft=r.scrollWidth-r.clientWidth,o=0):r.scrollLeft=a)),l=!!o),l},_headerScrollStart:function(e,t,s){var a=this,l=0,i=[151,134,119,106,95,86,79,74,71];this.scrollTimerId&&this._headerScrollStop(),function o(){a.scrollTimerId=setTimeout((function(){a._headerScrollCheck(e,t,!0)?(s(),o()):a._headerScrollStop()}),i[l]),l<i.length-1&&(l+=1)}()},_headerScrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_expandCollapseControlBreak:function(e,t){var s,a,l,i,o,r,d,c=[],f=!this.options.allowSelectHidden;function p(e,s){var a=n(s);if(a.hasClass("a-GV-row")&&!a.hasClass("is-aggregate"))!t&&f&&a.hasClass(u)&&c.push(a.children("td,th")[0]),a[t?"show":"hide"]();else{if(a.hasClass(h))return r=!0,!1;if(a.hasClass("a-GV-scrollFiller"))return d=parseInt(a.attr("data-start"),10),!1}}for(n.isArray(e)||(e=[e]),s=0;s<e.length;s++)if((a=e[s]).hasClass(h))if(2!==a.length&&this.tableFrozenHeader$&&(l=this._getOtherTable(a),a=n([a[0],l[this._rowIndex(a)]])),r=!1,a.first().nextAll().each(p),f=!1,2===a.length&&a.last().nextAll().each(p),t)i=F("BREAK_COLLAPSE"),a.addClass("is-expanded").find(".js-toggleBreak").attr("aria-expanded",v).attr("title",i).attr("aria-label",i).children(".a-Icon").removeClass("icon-right-arrow").addClass("icon-down-arrow");else{let t=this.model.getOption("hasTotalRecords");i=F("BREAK_EXPAND"),a.removeClass("is-expanded").find(".js-toggleBreak").attr("aria-expanded","false").attr("title",i).attr("aria-label",i).children(".a-Icon").removeClass("icon-down-arrow").addClass("icon-right-arrow"),s===e.length-1&&this.scrollPaging&&(r?!t&&this.tableData$.height()<this.scrollParent$.height()&&this._addNextPage():t?d>=0&&(this.pageOffset=d,this._addPageOfRecords()):this._addNextPage())}c.length&&(o=this.focusInHeader,this.focusInHeader=!1,this._select(n(c),"unset",n(document.activeElement).closest(this.element[0]).length>0,null),this.focusInHeader=o)},debugCellEdit:function(e){this.debugDontDeactivateCell=!!e}},apex.widget.contextMenuMixin)),n.ui.dialog&&n.widget("ui.dialog",n.ui.dialog,{_allowInteraction:function(e){return n(e.target).closest(".a-GV-floatingItem").length>0||this._super(e)}})}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.clipboard,apex.widget.util,apex.jQuery);